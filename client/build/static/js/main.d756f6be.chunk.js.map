{"version":3,"sources":["logo.svg","config.js","ContextProvider.js","ImagePlugin.js","BoldPlugin.js","EmojiPlugin.js","MentionPlugin.js","LinkPlugin.js","DeleteBlogPlugin.js","BackColorPlugin.js","DraftEditor.js","CommentContent.js","Content.js","App.js","reportWebVitals.js","index.js"],"names":["url","avatarUrl","axios","interceptors","request","use","defaults","headers","common","localStorage","getItem","Context","createContext","breakpoints","createBreakpoints","breakpointsAttribute","xs","sm","md","lg","xl","args","forEach","item","only","ContextProvider","props","sizeArr","iconSizeArr","useState","isLight","setIsLight","theme","useMemo","muiTheme","createTheme","backgourndImageArr","backgroundImage","color","palette","primary","primaryColor","type","typography","fontSize","button","textTransform","body2","overrides","MuiPaper","root","backgroundColor","MuiAvatar","MuiSvgIcon","MuiChip","borderRadius","marginLeft","marginRight","objectFit","textAlign","label","mentionBackColor","light","useMediaQuery","deviceSize","jwtDecode","userName","token","setToken","EditorState","createWithContent","ContentState","createFromText","editorContent","setEditorContent","picArr","setPicArr","postArr","setPostArr","postPicArr","setPostPicArr","deleteSinglePost","useCallback","postID","get","then","response","postIndex","findIndex","pre","filter","index","data","useEffect","post","setItem","Provider","value","lgSizeObj","smSizeObj","getSinglePost","postingTime","Math","min","map","Date","now","length","Promise","resolve","changeOwnerName","newName","ThemeProvider","children","createImagePlugin","externalES","externalSetEditorState","removeImageBlog","contentState","getCurrentContent","selectionBefore","getSelectionBefore","selectionAfter","getSelectionAfter","imageBlog","getBlocksAsArray","find","newContentBlockArr","imageBLogKey","getKey","createEmpty","setTimeout","getBlockForKey","createFromBlockArray","merge","hasImageBlock","selection","getSelection","getEndKey","getBlockMap","toArray","text","ImageBlog","block","editor","useTheme","picNum","imgArr","commonStyle0","position","width","height","paddingBottom","backgroundPositionX","backgroundPositionY","divider","overflow","opacity","commonStyle","backgroundRepeat","backgroundSize","style","onClick","localUrl","left","top","transform","ImageButton","inputRef","useRef","Button","action","disabled","secondary","main","e","current","click","AddPhotoAlternateOutlined","ref","display","currentTarget","onChange","files","name","trim","match","file","URL","createObjectURL","console","log","focus","currentKey","currentIndex","key","splice","ContentBlock","genKey","push","insertImageBlock","TopImageButton","sort","itemA","itemB","topImage","Image","imagePlugin","editorState","setEditorState","result","characters","charactersLength","i","charAt","floor","random","createBoldPlugin","makeBold","styleType","setOn","isCollapsed","anchorKey","anchorOffset","focusKey","focusOffset","styleObj","getCurrentInlineStyle","toObject","newContent","Modifier","replaceText","newSelection","isBackward","hasFocus","Object","keys","applyInlineStyle","acceptSelection","RichUtils","toggleInlineStyle","makeLarge","insertText","removeInlineStyle","LARGE","SMALL","boldPlugin","BoldButton","ItalicButton","UnderlineButton","LargeButton","isLargeOn","setIsLargeOn","contrastText","TextFieldsOutlined","SmallButton","isSmallOn","setIsSmallOn","FormatSize","isBoldOn","setIsBoldOn","FormatBold","isItalicOn","setIsItalicOn","FormatItalic","isUnderlineOn","setIsUnderlineOn","FormatUnderlined","emojiUrl","emoji","insertEmoji","anchorStartKey","anchorStartOffset","icon","emojiPlugin","oldSelection","blockKey","blockText","itemEntityKey","getEntity","getType","applyEntity","emojiKey","matchArr","regx","RegExp","array","exec","start","offset","entityKey","createEntity","symbol","getLastCreatedEntityKey","taggingEmoji","decorators","strategy","contentBlock","callback","findEntityRanges","character","component","offsetKey","end","decoratedText","iconRef","className","backgroundPosition","isMobile","clipPath","EmojiButton","EmojiIconButton","EmojiPanel","isEmojiPanelOn","setIsEmojiPanelOn","InsertEmoticon","Paper","elevation","IconButton","size","background","paper","marginBottom","maxWidth","marginTop","maxHeight","transitionProperty","transitionDuration","spacing","variant","Avatar","src","replace","useStyles","makeStyles","mentionHeadAvatar","mentionHeadRoot","borderTopRightRadius","borderBottomRightRadius","mentionBodyRoot","borderTopLeftRadius","borderBottomLeftRadius","mentionBodyRoot2","boxShadow","shadows","mentionHeadLabel","paddingLeft","paddingRight","borderStyle","mentionHeadLabel2","mentionBodyLabel","createMentionPlugin","friendsList","friendObj","friendName","responseType","onDownloadProgress","progressEvent","base64","btoa","Uint8Array","reduce","byte","String","fromCharCode","tabIndex","Panel","inMentionPanel","setOpacity","mentionHeadKey","mentionBodyKey","contentEditable","suppressContentEditableWarning","zIndex","flexDirection","Chip","classes","disabledBackground","cursor","avatar","alt","onMouseDown","insertMention","Typography","mentionBodyText","getData","person","hasOnAtTag","isAtOn","getCharacterList","tagKey","mentionType","indexOf","mentionPlugin","handleBeforeInput","chars","evenTimeStamp","anchorFocusOffset","isFirefox","handleReturn","newState","insertSoftNewline","keyBindingFn","getEditorState","keyCode","handleKeyCommand","command","hasfocus","anchorFocusKey","contentLenth","contentFocusAt","shortMentionOff","longMentionOnAt","longMentionOnOther","longMentionOff","createTag","tagName","mergeEntityData","substring","imgurl","taggingMention","MentionButton","isMentionPanelOn","setIsMentionPanelOn","AlternateEmailSharp","MentionPanel","createLlinkPlugin","linkPlugin","getText","entityType","getStyle","includes","linkAddress","linkHost","linkOff","linkType","taggingLink","Link","createDeleteBlogPlugin","addTopLine","isTopLine","currentBlock","centerBlock","pos","currentType","setBlockType","DeleteBlogButton","deleteBlock","DeleteOutlineOutlined","AddTopLineButton","HorizontalSplitOutlined","AddBottomLineButton","AlignCenterButton","isCenterOn","setIsCenterOn","FormatAlignCenter","AlignRightButton","isRightOn","setIsRightOn","FormatAlignRight","AddBackColorButton","addBackColor","PaletteOutlined","BackColorPanel","deleteBlogPlugin","createBackColorPlugin","isBackColorPanelOn","setIsBackColorPanelOn","backImageArr","setBackImageArr","backImageIndex","setBackImageIndex","Box","justifyContent","flexWrap","img","imgUrl","textColor","setBlockData","backColorPlugin","blockStyleFn","createEmojiPlugin","createLinkPlugin","obj","element","editorPaperCss","borderWidth","borderColor","isEditorFocusOn","wordBreak","whiteSpace","lineBreak","unstyledBlockCss","imageBlockCss","margin","padding","centerBlockCss","rightBlockCss","colorBlockCss","alignItems","className1","initialState","entityMap","blocks","DraftEditor","useContext","setIsEditorFocusOn","restCss","convertFromRaw","enablePost","setEnablePost","toPreHtml","preHtml","stateToHTML","defaultBlockTag","inlineStyles","attributes","colorblock","backimage","toJS","textcolor","blockRenderers","imageBlock","escape","entityStyleFn","entity","mutablity","moveFocusToEnd","Container","disableGutters","gap","ButtonGroup","Brightness5","Brightness4","minHeight","editorState_","moveSelectionToEnd","forceSelection","BOLD","ITALIC","UNDERLINE","getFocusKey","Boolean","plugins","preserveSelectionOnBlur","customStyleMap","Immutable","Map","customStyleFn","styleNames","CENTER","blockRenderMap","blockRendererFn","editable","stripPastedStyles","handlePastedText","html","ownerName","content","FormData","picName","pic","picID","append","JSON","stringify","multiavatar","labelShrinkCss","textFieldCss","CommentContent","toHtml","setCommentCount","commentCount","avatarPic","showComment","commentArr","setCommentArr","commentObjList","replyNum","setReplyNum","createCommentEditorHeader","isSubCommentEditor","commentID","lineHeight","fontWeight","subCommentID","subCommentHead","comment","subCommentCount","updateSubCommentArr","Number","Send","createCommentEditor","Divider","Collapse","in","listIndex","verticalAlign","clearSubComments","loadSubComments","deleteIcon","Cancel","Reply","onDelete","formatDistanceToNow","float","DeleteOutline","disableElevation","fullWidth","ExpandMore","SubComments","context","setState","arr","subCommentArr","showingCount","open","state","this","subComment","subListIndex","reponse","max","default","Component","Content","setAvatarPic","isFull","setIsFull","draftStyles","mentionStyles","fullVisible","setFullVisible","inView","isComment","ReactHtmlParser","transformFn","node","attribs","viewbox","preserveaspectratio","viewBox","preserveAspectRatio","xmlns","child","convertNodeToElement","ImgTag","id","lastIndexOf","personName","arr2","BackColorTag","LinkTag","breakpointColumnsObj","values","useInView","threshold","triggerOnce","initialInView","rootMargin","entry","setOpen","setNewName","showOk","setShowOk","fixed","window","innerWidth","Dialog","onClose","DialogTitle","accept","DialogContent","TextField","InputLabelProps","animated","InputProps","input","target","DialogActions","oldName","filename","uploadTime","alert","breakpointCols","columnClassName","PaperContent","CircularProgress","setHeight","setDisplay","panelRef","setShowComment","shrinkBar","setShrinkBar","fullScreen","setFullScreen","getComputedStyle","scroll","justifySelf","TextsmsOutlined","CloseOutlined","dividers","DialogContentText","paddingTop","FullscreenOutlined","message","bottom","ExpandLess","split","photoIndex","setPhotoIndex","isOpen","setIsOpen","images","Array","lightBox","mainSrc","nextSrc","prevSrc","onCloseRequest","onMovePrevRequest","onMoveNextRequest","host","linkhost","address","linkaddress","substr","setContent","stopPropagation","href","rel","isOverFlow","setIsOverFlow","backImageUrl","overFlow","App","screen","CssBaseline","Grid","container","direction","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.d756f6be.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/logo.6ce24c58.svg\";","import axios from 'axios'\n\n\n\nlet url = \"\";\nlet avatarUrl =\"\"\n\nif (process.env.NODE_ENV === \"development\") {\n\n    // url=\"http://localhost/api\"\n    url = \"http://192.168.0.100/api\";\n    avatarUrl = \"http://192.168.0.100/api/avatar\";\n}\nelse {\n    url = \"/api\"\n    avatarUrl=\"/api/avatar\"\n}\n\naxios.interceptors.request.use(\n    function fn1(request) {\n\n        \n        axios.defaults.headers.common['x-auth-token'] = localStorage.getItem(\"token\")\n      //  console.log(request)\n        return request\n    }\n\n)\n\n\n// if (getToken()) { axios.defaults.headers.common['x-auth-token'] = getToken() }\n\n\n// function getToken() {\n\n//     return localStorage.getItem(\"token\")\n// }\n\n\n\n\n\nexport { axios,avatarUrl };\nexport default url;","import React, { createContext, useEffect, useState, useReducer, useRef, useMemo, useCallback, useLayoutEffect } from 'react';\r\n\r\nimport { createTheme, ThemeProvider, responsiveFontSizes, } from \"@material-ui/core\";\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\r\nimport primaryColor from '@material-ui/core/colors/indigo';\r\n\r\nimport { EditorState, ContentState, ContentBlock, CharacterMetadata, SelectionState, convertToRaw, convertFromRaw, RichUtils, Modifier, convertFromHTML, AtomicBlockUtils } from 'draft-js';\r\n\r\n\r\nimport { makeStyles, styled, useTheme, } from '@material-ui/core/styles';\r\nimport createBreakpoints from '@material-ui/core/styles/createBreakpoints';\r\nimport {\r\n  isMobile,\r\n  isFirefox,\r\n  isChrome,\r\n  browserName,\r\n  engineName,\r\n  BrowserTypes,\r\n  deviceDetect\r\n} from \"react-device-detect\";\r\n\r\n//import axios from 'axios';\r\nimport url, { axios } from './config';\r\nimport jwtDecode from 'jwt-decode';\r\n\r\nimport yellow from '@material-ui/core/colors/yellow';\r\nimport { PhoneMissed } from '@material-ui/icons';\r\n\r\n\r\n\r\n\r\n\r\nexport const Context = createContext();\r\nconst breakpoints = createBreakpoints({})\r\n\r\nfunction breakpointsAttribute(...args) {\r\n\r\n  let xs = {}\r\n  let sm = {}\r\n  let md = {}\r\n  let lg = {}\r\n  let xl = {}\r\n\r\n  args.forEach(item => {\r\n    xs = { ...xs, [item[0]]: item[1] }\r\n    sm = { ...sm, [item[0]]: item[2] || item[1] }\r\n    md = { ...md, [item[0]]: item[3] || item[2] || item[1] }\r\n    lg = { ...lg, [item[0]]: item[4] || item[3] || item[2] || item[1] }\r\n    xl = { ...xl, [item[0]]: item[5] || item[4] || item[3] || item[2] || item[1] }\r\n  })\r\n\r\n\r\n  return {\r\n    [breakpoints.only('xs')]: { ...xs },\r\n    [breakpoints.only('sm')]: { ...sm },\r\n    [breakpoints.only('md')]: { ...md },\r\n    [breakpoints.only('lg')]: { ...lg },\r\n    [breakpoints.only('xl')]: { ...xl },\r\n  }\r\n}\r\n\r\n\r\n\r\nexport default function ContextProvider(props) {\r\n\r\n\r\n\r\n  const sizeArr = [\"1.1rem\", \"1.1rem\", \"1.1rem\", \"1.1rem\", \"1.1rem\"]\r\n  const iconSizeArr = [\"1.8rem\", \"1.8rem\", \"1.8rem\", \"1.8rem\", \"1.8rem\"]\r\n  //const iconSizeArr = [\"1.5rem\", \"1.5rem\", \"1.5rem\", \"1.5rem\", \"1.5rem\"]\r\n\r\n  const [isLight, setIsLight] = useState(true)\r\n\r\n\r\n\r\n  const theme = useMemo(function () {\r\n\r\n    let muiTheme = createTheme({\r\n\r\n      backgourndImageArr: [\r\n\r\n        { backgroundImage: `url(${url}/picture/downloadbackpicture/60b7028076fa440017fb5779)`, color: \"darkgray\" },\r\n        { backgroundImage: `url(${url}/picture/downloadbackpicture/60b6f77fae1acf0017a96c4b)`, color: \"orange\" },\r\n        { backgroundImage: `url(${url}/picture/downloadbackpicture/60b701a9dc07780017dcfd38)`, color: \"white\" },\r\n        { backgroundImage: \"url(https://picsum.photos/1024/576)\", color: \"white\" },\r\n        { backgroundImage: \"url(https://picsum.photos/512/288)\", color: \"white\" },\r\n        { backgroundImage: \"url(https://picsum.photos/800/450)\", color: \"white\" },\r\n        { backgroundImage: \"url(https://picsum.photos/640/360)\", color: \"white\" },\r\n        { backgroundImage: \"url(https://picsum.photos/600/337)\", color: \"white\" },\r\n        { backgroundImage: \"url(https://picsum.photos/640/361)\", color: \"white\" },\r\n        { backgroundImage: \"url(https://picsum.photos/600/338)\", color: \"white\" },\r\n        { backgroundImage: \"url(https://picsum.photos/800/451)\", color: \"white\" },\r\n\r\n      ],\r\n      palette: {\r\n        primary: primaryColor,\r\n        type: isLight ? 'light' : \"dark\",\r\n        // mentionBackColor: isLight ? \"#b7e1fc\" : muiTheme.palette.primary.light,\r\n      },\r\n      typography: {\r\n        fontSize: 14,\r\n        button: { textTransform: 'none' },\r\n        body2: breakpointsAttribute([\"fontSize\", ...sizeArr])\r\n      },\r\n\r\n\r\n      overrides: {\r\n        //     MuiInputLabel: {\r\n        //       root: {\r\n        //         fontSize: \"3rem\",\r\n\r\n        //       },\r\n        //       animated: {\r\n        //         fontSize: \"3rem\",\r\n        //       },\r\n        //       shrink:{\r\n        //         transform: \"translate(0, 1.5px) scale(0.5)\"\r\n        // //        fontSize:\"3rem\",\r\n        //       },\r\n        //     },\r\n\r\n        MuiPaper: {\r\n          root: {\r\n            backgroundColor: isLight ? \"rgba(255,255,255,0.85)\" : \"rgba(66, 66, 66,0.85)\",\r\n            //     position:\"relative\",\r\n            //     zIndex:100,\r\n\r\n            \"&.MuiDialog-paper\": {\r\n              backgroundColor: isLight ? \"rgba(255,255,255,1)\" : \"rgba(66, 66, 66,1)\",\r\n\r\n            }\r\n\r\n          }\r\n        },\r\n\r\n        MuiAvatar: {\r\n          root: {\r\n            ...breakpointsAttribute([\"width\", ...iconSizeArr], [\"height\", ...iconSizeArr]),\r\n          }\r\n        },\r\n\r\n        MuiSvgIcon: {\r\n          root: {\r\n            ...breakpointsAttribute([\"fontSize\", ...iconSizeArr]),\r\n          }\r\n        },\r\n        MuiChip: {\r\n          root: {\r\n\r\n            borderRadius: 0,\r\n            backgroundColor: \"transparent\",\r\n            \"& .MuiChip-avatar\": {\r\n              color: \"#616161\",\r\n              marginLeft: \"5px\",\r\n              marginRight: \"-6px\",\r\n              objectFit: \"cover\",\r\n              textAlign: \"center\",\r\n              //   ...breakpointsAttribute([\"width\", ...sizeArr], [\"height\", ...sizeArr]),\r\n              ...breakpointsAttribute([\"width\", \"1.8rem\", \"1.8rem\"], [\"height\", \"1.8rem\", \"1.8rem\",]),  // chip avatar size\r\n            },\r\n            //  backgroundColor:\"transparent\",\r\n          },\r\n          label: {\r\n            \"& > .MuiTypography-root.MuiTypography-body2\": {\r\n              ...breakpointsAttribute([\"fontSize\", \"1.2rem\", \"1.2rem\"]),\r\n\r\n            }\r\n          }\r\n        },\r\n\r\n\r\n      },\r\n    })\r\n    muiTheme.palette.mentionBackColor = isLight ? \"#b7e1fc\" : muiTheme.palette.primary.light;\r\n    return muiTheme\r\n  }, [isLight])\r\n\r\n\r\n  const xs = useMediaQuery(theme.breakpoints.only('xs'));\r\n  const sm = useMediaQuery(theme.breakpoints.only('sm'));\r\n  const md = useMediaQuery(theme.breakpoints.only('md'));\r\n  const lg = useMediaQuery(theme.breakpoints.only('lg'));\r\n  const xl = useMediaQuery(theme.breakpoints.only('xl'));\r\n\r\n  const deviceSize = xs ? \"xs\" : sm ? \"sm\" : md ? \"md\" : lg ? \"lg\" : \"xl\"\r\n\r\n  const lgSizeObj = { xs: \"1.5rem\", sm: \"1.5rem\", md: \"1.5rem\", lg: \"1.5rem\", xl: \"1.5rem\" }\r\n  const smSizeObj = { xs: \"0.8rem\", sm: \"0.8rem\", md: \"0.8rem\", lg: \"0.8rem\", xl: \"0.8rem\" }\r\n\r\n\r\n\r\n\r\n  const [token, setToken] = useState(\r\n    localStorage.getItem(\"token\")\r\n      ? jwtDecode(localStorage.getItem(\"token\"))\r\n      : { userName: \"__temp__\" }\r\n  );\r\n\r\n\r\n  const [editorContent, setEditorContent] = useState(\r\n    EditorState.createWithContent(ContentState.createFromText(''))\r\n  );\r\n\r\n  const [picArr, setPicArr] = useState([])\r\n  const [postArr, setPostArr] = useState([])\r\n  const [postPicArr, setPostPicArr] = useState([])\r\n\r\n  const changeOwnerName = function (newName) {\r\n\r\n    return axios.post(`${url}/article/changeownername`, { newName }).then(response => {\r\n\r\n\r\n\r\n      if (!response.data) {\r\n        return response.data\r\n      }\r\n      else {\r\n        localStorage.setItem(\"token\", response.headers[\"x-auth-token\"])\r\n        setToken(jwtDecode(response.headers[\"x-auth-token\"]));\r\n        return token\r\n      }\r\n\r\n\r\n\r\n\r\n\r\n\r\n    })\r\n\r\n  }\r\n\r\n  const getSinglePost = function () {\r\n    const postingTime = Math.min(...postArr.map(item => item.postingTime), Date.now())\r\n    //   console.log(...postArr.map(item => item.postingTime))\r\n\r\n\r\n\r\n    return axios.get(`${url}/article/singlepost2/${postingTime}`).then(response => {\r\n\r\n      //  console.log(response.data)\r\n      if (response.data.length === 0) {\r\n\r\n\r\n\r\n\r\n        return Promise.resolve(response.data)\r\n      }\r\n\r\n\r\n      // alert(JSON.stringify(Object.keys(response.data[0])))\r\n\r\n      setPostArr(pre => { return [...pre, ...response.data.map(item => item),] })\r\n      setPostPicArr(pre => [...pre, \"\"])\r\n\r\n      return response.data\r\n    })\r\n\r\n\r\n  }\r\n\r\n  const deleteSinglePost = useCallback(function (postID) {\r\n    return axios.get(`${url}/article/deletesinglepost/${postID}`).then(response => {\r\n      const postIndex = postArr.findIndex(item => { return item.postID === postID })\r\n\r\n      setPostArr(pre => { return pre.filter(item => item.postID !== postID) })\r\n      setPostPicArr(pre => {\r\n        return pre.filter((item, index) => { return index !== postIndex })\r\n\r\n      })\r\n\r\n      return response.data\r\n    })\r\n\r\n\r\n  })\r\n\r\n\r\n\r\n  // theme.typography.body2 = {\r\n  //   ...breakpointsFontSize([\"fontSize\", \"2.5rem\", \"1.5rem\"])\r\n  // };\r\n  //theme = responsiveFontSizes(theme);\r\n\r\n\r\n  useEffect(function () {\r\n\r\n    if (token.userName === \"__temp__\") {\r\n\r\n      axios.post(`${url}/user/register`, token).then(response => {\r\n        localStorage.setItem(\"token\", response.headers[\"x-auth-token\"])\r\n        setToken(jwtDecode(response.headers[\"x-auth-token\"]));\r\n      })\r\n    }\r\n  }, [])\r\n\r\n\r\n\r\n  return (\r\n    <Context.Provider value={{\r\n      token, setToken,\r\n      isLight, setIsLight, theme, breakpointsAttribute, editorContent,\r\n      setEditorContent, lgSizeObj, smSizeObj, deviceSize,\r\n      picArr, setPicArr,\r\n      postArr, setPostArr,\r\n      postPicArr, setPostPicArr,\r\n      getSinglePost, deleteSinglePost,\r\n      changeOwnerName,\r\n\r\n      // backImageArr, setBackImageArr,\r\n      // backImageIndex, setBackImageIndex,\r\n\r\n    }}>\r\n      <ThemeProvider theme={theme}>\r\n        {props.children}\r\n      </ThemeProvider>\r\n    </Context.Provider>\r\n  )\r\n\r\n\r\n}","import React, { useState, useRef, useEffect } from 'react';\n\nimport Immutable from 'immutable'\nimport axios from \"axios\"\n\nimport { Typography, Button, ButtonGroup, Container, Grid } from \"@material-ui/core\";\nimport { CropOriginal, Image, Brightness4, Brightness5, FormatBold, FormatItalic, AddPhotoAlternateOutlined } from \"@material-ui/icons\";\nimport { makeStyles, styled, useTheme } from '@material-ui/core/styles';\n\nimport {\n  EditorState, ContentBlock,\n  CharacterMetadata, SelectionState, convertToRaw,\n  convertFromRaw, RichUtils, Modifier, convertFromHTML,\n  AtomicBlockUtils, ContentState\n}\n  from 'draft-js';\nimport {\n  isMobile,\n  isFirefox,\n  isChrome,\n  browserName,\n  engineName,\n} from \"react-device-detect\";\n\n\n\nexport default function createImagePlugin() {\n  let externalES = null;\n  let externalSetEditorState = null;\n\n\n\n  function insertImageBlock0(url, id, imgdata) {\n\n\n\n    // const contentState = externalES.getCurrentContent();\n    // const contentStateWithEntity = contentState.createEntity(\"imageBlock\", 'IMMUTABLE', { url, id, imgdata });\n\n    // const entityKey = contentStateWithEntity.getLastCreatedEntityKey();\n\n\n    // externalES = EditorState.set(\n    //   externalES,\n    //   { currentContent: contentStateWithEntity },\n    // );\n    externalES = AtomicBlockUtils.insertAtomicBlock(externalES, null, 'imageBlockText')\n    externalSetEditorState(externalES)\n\n  }\n\n\n  function insertImageBlock1(url, id = \"\", imgdata = \"\") {\n\n    //   if ((picArr.length===0) && hasImageBlock()) {\n    //  //   alert(\"aaa\")\n    //     removeImageBlog()\n    //   }\n\n\n    const selection = externalES.getSelection();\n\n    let contentState = externalES.getCurrentContent();\n\n\n\n    const currentBlock = contentState.getBlockForKey(selection.getEndKey());\n    const blockMap = contentState.getBlockMap()\n\n\n\n    const blocksBefore = blockMap.toSeq().takeUntil(function (v) { return v === currentBlock })\n    const blocksAfter = blockMap.toSeq().skipUntil(function (v) { return v === currentBlock }).rest()\n\n\n    const newBlockKey = id + genKey()\n\n    const newBlockKey2 = id + genKey()\n\n\n\n\n    let newBlocks =\n      [\n        [currentBlock.getKey(), currentBlock],\n        [newBlockKey, new ContentBlock({\n          key: newBlockKey,\n          type: \"imageBlock\",\n          text: '',\n          data: Immutable.fromJS({ imgUrl: url, imgId: id, imgData: imgdata }),\n        })],\n        [newBlockKey2, new ContentBlock({\n          key: newBlockKey2,\n          type: \"unstyled\",\n          text: '',\n\n        })],\n      ];\n\n\n    const newBlockMap = blocksBefore.concat(newBlocks, blocksAfter).toOrderedMap()\n    contentState = contentState.merge({\n      blockMap: newBlockMap,\n\n      selectionBefore: selection,//.merge({ hasFocus: true,}),\n      selectionAfter: selection.merge({\n        anchorKey: newBlockKey2,\n        anchorOffset: 0,\n        focusKey: newBlockKey2,\n        focusOffset: 0,\n        isBackward: false,\n        hasFocus: true,\n      }),\n    })\n\n\n    externalES = EditorState.push(externalES, contentState, 'insert-fragment');\n    externalSetEditorState(externalES)\n\n\n  };\n\n  function insertImageBlock(editor) {\n\n\n    let contentState = externalES.getCurrentContent();\n    const selection = externalES.getSelection()\n\n    const currentKey = selection.getEndKey()\n    const currentBlock = contentState.getBlockForKey(selection.getEndKey());\n\n\n    let newContentBlockArr = contentState.getBlocksAsArray()\n    const selectionBefore = contentState.getSelectionBefore()\n    const selectionAfter = contentState.getSelectionAfter()\n\n    let currentIndex = newContentBlockArr.findIndex(item => { return item.key === currentKey })\n    currentIndex = currentIndex >= 0 ? currentIndex : newContentBlockArr.length - 1\n    console.log(currentIndex)\n\n    newContentBlockArr.splice(currentIndex + 1, 0,\n      new ContentBlock({\n        key: genKey(),\n        type: \"imageBlock\",\n        text: '',\n      })\n    )\n\n    contentState = ContentState.createFromBlockArray(newContentBlockArr)\n    contentState = contentState.merge({\n      selectionAfter, //newBlockMap,\n      selectionBefore,\n    })\n\n\n    // externalES = EditorState.createWithContent(contentState)\n    externalES = EditorState.push(externalES, contentState, 'insert-fragment');\n    externalSetEditorState(externalES)\n  }\n\n\n\n\n  function removeImageBlog0() {\n\n    const selection = externalES.getSelection();\n    let contentState = externalES.getCurrentContent();\n    const blockMap = contentState.getBlockMap();\n\n    const imageBlog = contentState.getBlocksAsArray().find(item => { return item.type === \"imageBlock\" || item.type === \"atomic\" })\n    const blockNum = contentState.getBlocksAsArray().length\n\n\n    if (Boolean(imageBlog) && (blockNum === 1)) {\n      let externalES_ = EditorState.createEmpty()\n      contentState = externalES_.getCurrentContent()\n      externalES = EditorState.push(externalES_, contentState, 'insert-fragment');\n      setTimeout(() => {\n        externalSetEditorState(externalES_)\n      }, 0);\n      return null\n    }\n\n    if (imageBlog) {\n      const atomicBlock = imageBlog\n\n      contentState = Modifier.removeRange(\n        contentState,\n        new SelectionState({\n          anchorKey: atomicBlock.getKey(),\n          anchorOffset: 0,\n          focusKey: atomicBlock.getKey(),\n          focusOffset: atomicBlock.getLength(),\n        }),\n        'backward',\n      );\n\n      const blockMap = contentState.getBlockMap().delete(atomicBlock.getKey());\n      contentState = contentState.merge({\n        blockMap,\n        // selectionAfter: selection,\n      });\n\n\n      externalES = EditorState.push(externalES, contentState, 'remove-range');\n      externalSetEditorState(externalES)\n\n    }\n\n\n  }\n\n  function removeImageBlog1() {\n\n    const selection = externalES.getSelection();\n    let contentState = externalES.getCurrentContent();\n    const blockMap = contentState.getBlockMap();\n\n    const imageBlog = contentState.getBlocksAsArray().find(item => { return item.type === \"imageBlock\" || item.type === \"atomic\" })\n    const blockNum = contentState.getBlocksAsArray().length\n\n\n    if (Boolean(imageBlog) && (blockNum === 1)) {\n      let externalES_ = EditorState.createEmpty()\n      contentState = externalES_.getCurrentContent()\n      externalES = EditorState.push(externalES_, contentState, 'insert-fragment');\n      setTimeout(() => {\n        externalSetEditorState(externalES_)\n      }, 0);\n      return null\n    }\n\n    else if (imageBlog) {\n\n      const imageBlogKey = imageBlog.getKey()\n      const blocksBefore = blockMap.toSeq().takeUntil(function (v) { return v.getKey() === imageBlogKey })\n      const blocksAfter = blockMap.toSeq().skipUntil(function (v) { return v.getKey() === imageBlogKey }).rest()\n\n      // console.log(imageBlogKey, blocksBefore.count(), blocksAfter.count())\n\n\n      //  console.log(blocksBefore.toOrderedMap().toArray().pop().getText())\n\n      const newBlockMap = Boolean(blocksBefore)\n        ? Boolean(blocksAfter) ? blocksBefore.concat(blocksAfter).toOrderedMap() : blocksBefore.toOrderedMap()\n        : Boolean(blocksAfter) ? blocksAfter.toOrderedMap() : null\n\n      const key = (blocksBefore && blocksBefore.toOrderedMap().toArray().pop().getKey())\n        || (blocksAfter && blocksAfter.toOrderedMap().toArray().pop().getKey())\n\n      const key1 = (blocksBefore && blocksBefore.toOrderedMap().toArray().pop().getKey())\n      const key2 = (blocksAfter && blocksAfter.toOrderedMap().toArray().pop().getKey())\n      console.log(key1, key2)\n\n\n\n      //  const key =\"1111\"\n      contentState = contentState.merge({\n        blockMap: newBlockMap,\n\n        // selectionBefore: SelectionState.createEmpty().merge({\n        //   anchorKey: key,\n        //   focusKey: key,\n        //   anchorOffset: 0,\n        //   focusOffset: 0,\n        //   isBackward: false,\n        //   hasFocus: false,\n        // }),\n        // selectionBefore: SelectionState.createEmpty().merge({\n        //   anchorKey: key,\n        //   focusKey: key,\n        //   anchorOffset: 0,\n        //   focusOffset: 0,\n        //   isBackward: false,\n        //   hasFocus: false,\n        // }),\n\n\n\n      })\n      externalES = EditorState.push(externalES, contentState, 'insert-fragment');\n      //   setTimeout(() => {\n      externalSetEditorState(externalES)\n      //   }, 0)\n\n      return externalES\n    }\n\n\n  }\n\n  function removeImageBlog() {\n\n    let contentState = externalES.getCurrentContent();\n    const selectionBefore = contentState.getSelectionBefore()\n    const selectionAfter = contentState.getSelectionAfter()\n\n\n    let imageBlog = contentState.getBlocksAsArray().find(item => { return item.type === \"imageBlock\" || item.type === \"atomic\" })\n\n\n    let newContentBlockArr = contentState.getBlocksAsArray().filter(function (item) {\n\n\n      return !((item.type === \"imageBlock\" || item.type === \"atomic\"))\n\n    })\n\n\n    const imageBLogKey = imageBlog && imageBlog.getKey()\n\n    if (!imageBLogKey) { return }\n    if ((imageBLogKey) && (contentState.getBlocksAsArray().length <= 1)) {\n      externalES = EditorState.createEmpty()\n      setTimeout(() => {\n        externalSetEditorState(externalES)\n      }, 0);\n      return null\n    }\n\n    imageBlog = contentState.getBlockForKey(imageBLogKey);\n    contentState = ContentState.createFromBlockArray(newContentBlockArr)\n    contentState = contentState.merge({\n      selectionAfter, //newBlockMap,\n      selectionBefore,\n    })\n\n\n    externalES = EditorState.createWithContent(contentState)\n\n    //externalES = EditorState.push(externalES, contentState, 'insert-fragment');\n    externalSetEditorState(externalES)\n\n  }\n\n\n  function hasImageBlock() {\n    const selection = externalES.getSelection();\n\n    let contentState = externalES.getCurrentContent();\n    const currentBlock = contentState.getBlockForKey(selection.getEndKey());\n    const blockMap = contentState.getBlockMap()\n    return blockMap.toArray().findIndex((item) => {\n\n      const result = (item.type === \"atomic\" && item.text === \"imageBlockText\") || item.type === \"imageBlock\"\n      return result\n    }) >= 0\n\n\n  }\n\n  function topImage(editor) {\n\n\n    const selection = externalES.getSelection();\n\n\n    let contentState = externalES.getCurrentContent();\n    const selectionBefore = contentState.getSelectionBefore()\n    const selectionAfter = contentState.getSelectionAfter()\n\n\n    let imageBlog = contentState.getBlocksAsArray().find(item => { return item.type === \"imageBlock\" || item.type === \"atomic\" })\n\n\n    let newContentBlockArr = contentState.getBlocksAsArray().sort(function (itemA, itemB) {\n      if (itemA.type === \"imageBlock\" || itemA.type === \"atomic\") {\n        return -1\n      }\n      else {\n        return 0\n      }\n    })\n\n\n    const imageBLogKey = imageBlog && imageBlog.getKey()\n\n    if (!imageBLogKey) { return }\n\n    imageBlog = contentState.getBlockForKey(imageBLogKey);\n\n    console.log(contentState.getBlocksAsArray().length)\n\n    contentState = ContentState.createFromBlockArray(newContentBlockArr)\n    contentState = contentState.merge({\n      selectionAfter, //newBlockMap,\n      selectionBefore,\n    })\n\n\n    // externalES = EditorState.createWithContent(contentState)\n\n    externalES = EditorState.push(externalES, contentState, 'insert-fragment');\n    externalSetEditorState(externalES)\n\n\n\n\n\n\n\n\n\n\n  }\n\n\n  function ImageBlog({ block, editor, contentState, picArr, setPicArr, ...props }) {\n    //   const text = block.getText()\n    //   let { imgArr, imgUrl } = block.getData().toObject()\n    //  const type = block.getType()\n    const theme = useTheme()\n\n    const picNum = picArr.length\n    const imgArr = picArr\n\n\n    const commonStyle0 = {\n      position: \"relative\",\n      width: \"100%\",\n      height: 0,\n      paddingBottom: \"56.25%\",\n      backgroundPositionX: \"center\",\n      backgroundPositionY: \"center\",\n      backgroundColor: theme.palette.divider,   //\"skyblue\",\n      overflow: \"hidden\",\n      opacity:1,\n    }\n\n    const commonStyle = {\n      position: \"absolute\",\n      backgroundRepeat: \"no-repeat\",\n      overflow: \"hidden\",\n      backgroundPositionX: \"center\",\n      backgroundPositionY: \"center\",\n      backgroundSize: \"cover\",\n      backgroundColor: \"wheat\",\n      opacity:1,\n    }\n\n\n\n\n    if (picNum === 0) {\n\n      //  setTimeout(() => {\n      //    removeImageBlog()\n      //  }, 0);\n\n      return (\n        <div style={{\n          ...commonStyle0\n        }}\n        >\n          <button\n            onClick={function () {\n              //  alert(\"xx\")\n              //removeImageBlog()\n              //setPicArr([])\n            }}\n          >delete</button>\n          {/* <AddPhotoAlternateOutlined style={{ transform: \"translateX(59%)\" }} /> */}\n          {/* <ImageButton color=\"primary\" fontSize=\"small\" picArr={picArr} setPicArr={setPicArr} editor={editor} /> */}\n        </div>\n\n\n      )\n    }\n    else if (picNum === 1) {\n      return <div style={{\n\n        ...commonStyle0,\n\n        backgroundRepeat: \"no-repeat\",\n        backgroundSize: \"cover\",\n        backgroundImage: \"url(\" + imgArr[0].localUrl + \")\",\n\n\n      }}\n\n        onClick={function () {\n\n          setPicArr(pre => {\n            setTimeout(() => { removeImageBlog() }, 0);\n            return []\n          })\n\n        }}\n\n      />\n\n    }\n    else if (picNum === 2) {\n      return (\n        <div style={{\n          ...commonStyle0,\n        }}>\n          <div style={{\n            ...commonStyle,\n            width: \"50%\",\n            height: \"100%\",\n            left: \"0%\",\n            top: \"0%\",\n            backgroundImage: \"url(\" + imgArr[0].localUrl + \")\",\n            transform: \"translateX(-1px) translateY(0px)\",\n\n          }}\n            onClick={function () {\n              setPicArr(pre => [pre[1]])\n            }}\n\n          />\n          <div style={{\n            ...commonStyle,\n            width: \"50%\",\n            height: \"100%\",\n            left: \"50%\",\n            top: \"0%\",\n            backgroundImage: \"url(\" + imgArr[1].localUrl + \")\",\n            transform: \"translateX(1px) translateY(0px)\",\n\n          }}\n            onClick={function () {\n              setPicArr(pre => [pre[0]])\n            }}\n          />\n\n        </div>\n      )\n    }\n\n\n    else if (picNum === 3) {\n      return (\n        <div style={{\n          ...commonStyle0,\n        }}>\n\n\n          <div style={{\n            ...commonStyle,\n            width: \"50%\",\n            height: \"100%\",\n            left: \"0%\",\n            top: \"0%\",\n            backgroundImage: \"url(\" + imgArr[0].localUrl + \")\",\n            transform: \"translateX(-1px) translateY(0px)\",\n\n          }}\n            onClick={function () {\n              setPicArr(pre => [pre[1], pre[2]])\n            }}\n\n          />\n          <div style={{\n            ...commonStyle,\n            width: \"50%\",\n            height: \"50%\",\n            left: \"50%\",\n            top: \"0%\",\n            backgroundImage: \"url(\" + imgArr[1].localUrl + \")\",\n            transform: \"translateX(1px) translateY(-1px)\",\n\n\n          }} onClick={\n            function () {\n              setPicArr(pre => [pre[0], pre[2]])\n            }} />\n\n          <div style={{\n            ...commonStyle,\n            width: \"50%\",\n            height: \"50%\",\n            left: \"50%\",\n            top: \"50%\",\n            backgroundImage: \"url(\" + imgArr[2].localUrl + \")\",\n            transform: \"translateX(1px) translateY(1px)\",\n\n          }} onClick={\n            function () {\n              setPicArr(pre => [pre[0], pre[1]])\n            }} />\n\n        </div>\n      )\n    }\n\n\n    else {\n      return (\n        <div style={{\n          ...commonStyle0,\n        }}>\n\n\n          <div style={{\n            ...commonStyle,\n            width: \"50%\",\n            height: \"50%\",\n            top: \"0%\",\n            left: \"0%\",\n            backgroundImage: \"url(\" + imgArr[0].localUrl + \")\",\n            transform: \"translateX(-1px) translateY(-1px)\",\n\n          }} onClick={function () {\n            setPicArr(pre => [pre[1], pre[2], pre[3]])\n          }} />\n\n          <div style={{\n            ...commonStyle,\n            width: \"50%\",\n            height: \"50%\",\n            top: \"0%\",\n            left: \"50%\",\n            backgroundImage: \"url(\" + imgArr[1].localUrl + \")\",\n            transform: \"translateX(1px) translateY(-1px)\",\n\n          }} onClick={function () {\n            setPicArr(pre => [pre[0], pre[2], pre[3]])\n          }} />\n\n          <div style={{\n            ...commonStyle,\n            width: \"50%\",\n            height: \"50%\",\n            top: \"50%\",\n            left: \"0%\",\n            backgroundImage: \"url(\" + imgArr[2].localUrl + \")\",\n            transform: \"translateX(-1px) translateY(1px)\",\n          }}\n            onClick={\n              function () {\n                setPicArr(pre => [pre[0], pre[1], pre[3]])\n              }}\n          />\n\n          <div style={{\n            ...commonStyle,\n            width: \"50%\",\n            height: \"50%\",\n            top: \"50%\",\n            left: \"50%\",\n            backgroundImage: \"url(\" + imgArr[3].localUrl + \")\",\n            transform: \"translateX(1px) translateY(1px)\",\n\n          }} onClick={\n            function () {\n              setPicArr(pre => [pre[1], pre[2], pre[3]])\n            }} />\n\n        </div>\n\n      )\n    }\n  }\n\n\n  function ImageButton({ children, picArr, setPicArr, editor, ...props }) {\n\n\n    const inputRef = useRef()\n    const theme = useTheme()\n\n\n    return (\n      <>\n\n        <Button\n          {...props}\n\n          style={{\n            color: theme.palette.type === \"dark\"\n\n              ? picArr.length >= 4 && hasImageBlock() ? theme.palette.action.disabled : theme.palette.text.secondary\n              : picArr.length >= 4 && hasImageBlock() ? theme.palette.action.disabled : theme.palette.primary.main\n\n          }}\n          disabled={picArr.length >= 4 && hasImageBlock()}\n          onClick={function (e) {\n            //insertImageBlock(\"https://picsum.photos/332\")\n\n            //   if ((picArr.length===0) && hasImageBlock()) {\n            //  //   alert(\"aaa\")\n            //     removeImageBlog()\n            //   }\n\n            // if (picArr.length > 0 && !hasImageBlock()) {\n            //   insertImageBlock(\"\")\n            // }\n            // else {\n            inputRef.current.click()\n            //}\n\n\n\n          }}\n        >\n          <AddPhotoAlternateOutlined />\n          {/* {children} */}\n        </Button>\n\n        <input ref={inputRef} type=\"file\" style={{ display: \"none\" }}\n          onClick={function (e) { e.currentTarget.value = null; }}\n          onChange={function (e) {\n            if (e.currentTarget.files[0].name.trim().match(/\\.(gif|jpe?g|tiff|png|webp|bmp)$/i)) {\n\n\n              //  if (picArr.length >= 4) { return };\n              const file = e.currentTarget.files[0]\n              file.localUrl = URL.createObjectURL(e.currentTarget.files[0])\n              //     const obj = URL.createObjectURL(e.currentTarget.files[0])\n              console.log(e.currentTarget.files[0])\n              setPicArr(pre => {\n\n                // pre.push(obj);\n                return [...pre, file]\n              })\n\n\n\n\n              if (!hasImageBlock()) { insertImageBlock(URL.createObjectURL(e.currentTarget.files[0])) }\n              else {\n\n                editor.current.focus()\n\n\n\n\n              }\n            }\n          }}\n\n\n\n        />\n      </>\n    )\n\n\n  }\n\n  function TopImageButton({ editor, ...props }) {\n\n    const theme = useTheme()\n    return (\n\n      <Button {...props}\n\n        style={{\n\n          color: theme.palette.type === \"light\"\n            ? theme.palette.primary.main\n            : theme.palette.text.secondary\n        }}\n        onClick={function () {\n          //      deleteBlock(editor)\n          topImage(editor)\n        }}\n\n      >\n        <Image />\n      </Button>\n\n    )\n  }\n\n\n\n  return {\n\n    ImageBlog,\n\n    ImageButton,\n    TopImageButton,\n    removeImageBlog,\n    hasImageBlock,\n\n    imagePlugin: {\n\n      onChange: function (editorState, { setEditorState }) {\n\n        externalES = editorState\n        externalSetEditorState = setEditorState\n\n        return externalES\n      },\n    },\n  }\n}\n\n\n\n\n\nfunction genKey(length = 4) {\n\n  var result = '';\n  var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  var charactersLength = characters.length;\n  for (var i = 0; i < length; i++) {\n    result += characters.charAt(Math.floor(Math.random() * charactersLength));\n  }\n  return result;\n}","import React, { useState, useRef, useEffect } from 'react';\n\nimport Immutable from 'immutable'\nimport axios from \"axios\"\n\n\nimport { Typography, Button, ButtonGroup, Container, IconButton } from \"@material-ui/core\";\nimport { CropOriginal, Image, Brightness4, Brightness5, FormatBold, FormatItalic, FormatUnderlined, FormatSize, TextFieldsOutlined,FormatAlignCenter } from \"@material-ui/icons\";\nimport { makeStyles, styled, useTheme } from '@material-ui/core/styles';\n\n\nimport {\n  EditorState, ContentBlock,\n  CharacterMetadata, SelectionState, convertToRaw,\n  convertFromRaw, RichUtils, Modifier, convertFromHTML,\n  AtomicBlockUtils,\n\n}\n  from 'draft-js';\nimport { set } from 'immutable';\n\nexport default function createBoldPlugin() {\n  let externalES = null;\n  let externalSetEditorState = null;\n\n  function makeBold(styleType, setOn) {\n\n    const isCollapsed = externalES.getSelection().isCollapsed()\n\n    if (!isCollapsed) {\n\n      externalES = RichUtils.toggleInlineStyle(externalES, styleType)\n      let selection = externalES.getSelection()\n      const [anchorKey, anchorOffset, focusKey, focusOffset, isBackward, hasfocus] = selection.toArray()\n\n\n\n\n\n      // selection = selection.merge({\n\n      //   anchorKey: anchorKey,\n      //   anchorOffset: focusOffset,// + text.length,\n      //   focusKey: focusKey,\n      //   focusOffset: focusOffset,// + text.length,\n      //   isBackward: false,\n      //   hasFocus: true,\n      // })\n\n      // externalES = EditorState.push(externalES, externalES.getCurrentContent(), \"change-inline-style\");\n      // externalES = EditorState.acceptSelection(externalES, selection)\n\n\n\n      externalSetEditorState(externalES)\n\n    }\n\n    else {\n\n      const selection = externalES.getSelection()\n      const [anchorKey, anchorOffset, focusKey, focusOffset, isBackward, hasfocus] = selection.toArray()\n      const styleObj = externalES.getCurrentInlineStyle().toObject()\n\n\n      const text = \" \"\n      let newContent = Modifier.replaceText(\n        externalES.getCurrentContent(),\n        selection,\n        text,\n      )\n\n      let newSelection = selection.merge({\n\n        anchorKey: anchorKey,\n        anchorOffset: anchorOffset,// + text.length,\n        focusKey: focusKey,\n        focusOffset: focusOffset + text.length,\n        isBackward: false,\n        hasFocus: true,\n      })\n\n      Object.keys(styleObj).forEach(item => {\n        if (item === styleType) { return }\n        newContent = Modifier.applyInlineStyle(newContent, newSelection, styleObj[item])\n      })\n\n      newContent = Modifier.applyInlineStyle(newContent, newSelection, styleObj[styleType] ? [] : styleType)\n      externalES = EditorState.push(externalES, newContent, \"insert-characters\");\n      externalES = EditorState.acceptSelection(externalES, newSelection)\n\n      externalSetEditorState(externalES)\n\n      //   console.log(endKey, endOffset)\n      // console.log(Date.now(), \"===\")\n      // externalES = RichUtils.toggleInlineStyle(externalES, styleType)\n      // externalSetEditorState(externalES)\n\n    }\n\n  }\n\n  function makeLarge(styleType = \"LARGE\") {\n\n    const isCollapsed = externalES.getSelection().isCollapsed()\n\n    if (!isCollapsed) {\n      let selection = externalES.getSelection()\n      const [anchorKey, anchorOffset, focusKey, focusOffset, isBackward, hasfocus] = selection.toArray()\n      const styleObj = externalES.getCurrentInlineStyle().toObject()\n      let newContent = externalES.getCurrentContent()\n\n      console.log(styleObj)\n      if (styleType === \"LARGE\") {\n        newContent = Modifier.removeInlineStyle(newContent, selection, \"SMALL\")\n        newContent = Modifier.removeInlineStyle(newContent, selection, \"LARGE\")\n        if (!styleObj.LARGE) {\n          newContent = Modifier.applyInlineStyle(newContent, selection, \"LARGE\")\n        }\n      }\n      else if (styleType === \"SMALL\") {\n        newContent = Modifier.removeInlineStyle(newContent, selection, \"SMALL\")\n        newContent = Modifier.removeInlineStyle(newContent, selection, \"LARGE\")\n        if (!styleObj.SMALL) {\n          newContent = Modifier.applyInlineStyle(newContent, selection, \"SMALL\")\n        }\n      }\n\n      //   if (Math.abs(focusOffset - anchorOffset) !== 1) {\n      // selection = selection.merge({\n\n      //   anchorKey: anchorKey,\n      //   anchorOffset: focusOffset,// + text.length,\n      //   focusKey: focusKey,\n      //   focusOffset: focusOffset,// + text.length,\n      //   isBackward: false,\n      //   hasFocus: true,\n      // })\n\n\n      // }\n\n      externalES = EditorState.push(externalES, newContent, \"change-inline-style\");\n      externalES = EditorState.acceptSelection(externalES, selection)\n      externalSetEditorState(externalES)\n\n\n\n    }\n\n    else if (isCollapsed) {\n      const selection = externalES.getSelection()\n      const [anchorKey, anchorOffset, focusKey, focusOffset, isBackward, hasfocus] = selection.toArray()\n      const styleObj = externalES.getCurrentInlineStyle().toObject()\n\n      const text = \" \"\n      let newContent = Modifier.insertText(\n        externalES.getCurrentContent(),\n        selection,\n        text,\n      )\n\n      let newSelection = selection.merge({\n\n        anchorKey: anchorKey,\n        anchorOffset: anchorOffset,// + text.length,\n        focusKey: focusKey,\n        focusOffset: focusOffset + text.length,\n        isBackward: false,\n        hasFocus: true,\n      })\n\n      Object.keys(styleObj).forEach(item => {\n        if (item === styleType || item === \"LARGE\" || item === \"SMALL\") {\n          return\n        }\n        newContent = Modifier.applyInlineStyle(newContent, newSelection, styleObj[item])\n      })\n\n      newContent = Modifier.applyInlineStyle(newContent, newSelection, styleObj[styleType] ? [] : styleType)\n      externalES = EditorState.push(externalES, newContent, \"insert-characters\");\n      externalES = EditorState.acceptSelection(externalES, newSelection)\n\n      externalSetEditorState(externalES)\n    }\n\n\n  }\n  function makeSmall() {\n    externalES.getSelection().isCollapsed()\n\n  }\n\n  function LargeButton({ editor, isLargeOn, setIsLargeOn, ...props }) {\n    const theme = useTheme()\n    return (\n      <Button {...props}\n        style={{\n          backgroundColor: isLargeOn ? theme.palette.primary.main : \"\",// theme.palette.background.default,\n          color: theme.palette.type === \"light\"\n            ? isLargeOn\n              ? theme.palette.primary.contrastText\n              : theme.palette.primary.main\n            : isLargeOn\n              ? theme.palette.primary.contrastText\n              : theme.palette.text.secondary\n        }}\n        onClick={function (e) {\n\n          editor.current.focus()\n          makeLarge(\"LARGE\", setIsLargeOn)\n        }}\n      >\n        <TextFieldsOutlined />\n      </Button>\n    )\n  }\n\n  function SmallButton({ editor, isSmallOn, setIsSmallOn, ...props }) {\n    const theme = useTheme()\n    return (\n      <Button {...props}\n        style={{\n          backgroundColor: isSmallOn ? theme.palette.primary.main : \"\",// theme.palette.background.default,\n          color: theme.palette.type === \"light\"\n            ? isSmallOn\n              ? theme.palette.primary.contrastText\n              : theme.palette.primary.main\n            : isSmallOn\n              ? theme.palette.primary.contrastText\n              : theme.palette.text.secondary\n        }}\n        onClick={function (e) {\n\n          editor.current.focus()\n          makeLarge(\"SMALL\", setIsSmallOn)\n        }}\n      >\n        <FormatSize />\n      </Button>\n    )\n  }\n\n  function CenterButton({ editor, isCenterOn, setIsCenterOn, ...props }) {\n\n    const theme = useTheme()\n    return <Button {...props}\n      style={{\n        backgroundColor: isCenterOn ? theme.palette.primary.main : \"\",// theme.palette.background.default,\n        color: theme.palette.type === \"light\"\n          ? isCenterOn\n            ? theme.palette.primary.contrastText\n            : theme.palette.primary.main\n          : isCenterOn\n            ? theme.palette.primary.contrastText\n            : theme.palette.text.secondary\n      }}\n      onClick={function (e) {\n\n        editor.current.focus()\n           makeBold(\"CENTER\", setIsCenterOn)\n      }}\n    >\n      <FormatAlignCenter />\n    </Button>\n\n\n  }\n\n  return {\n\n\n    boldPlugin: {\n\n      onChange: function (editorState, { setEditorState }) {\n        externalES = editorState\n        externalSetEditorState = setEditorState\n        return externalES\n\n      },\n\n    },\n\n\n    BoldButton: function (props) { return <BoldButton makeBold={makeBold}  {...props} /> },\n    ItalicButton: function (props) { return <ItalicButton makeBold={makeBold}  {...props} /> },\n    UnderlineButton: function (props) { return <UnderlineButton makeBold={makeBold}  {...props} /> },\n    LargeButton,\n    SmallButton,\n   // CenterButton,\n  }\n}\n\nfunction BoldButton({ children, makeBold,\n  isBoldOn, setIsBoldOn,\n\n  styleType, editor, ...props }) {\n\n  const theme = useTheme()\n\n\n  return (\n\n    <Button   {...props}\n\n      style={{\n\n        backgroundColor: isBoldOn ? theme.palette.primary.main : \"\",// theme.palette.background.default,\n\n\n        color: theme.palette.type === \"light\"\n          ? isBoldOn\n            ? theme.palette.primary.contrastText\n            : theme.palette.primary.main\n          : isBoldOn\n            ? theme.palette.primary.contrastText\n            : theme.palette.text.secondary\n\n      }}\n\n\n      onClick={function (e) {\n        //  setIsBoldOn(pre => !pre)\n\n        editor.current.focus()\n        // setIsBoldOn(pre => {\n\n        //   return !pre\n        // })\n        //  \n\n        makeBold(\"BOLD\", setIsBoldOn)\n\n      }}\n    >\n      <FormatBold />\n      {/* {children} */}\n    </Button>\n  )\n}\n\nfunction ItalicButton({ children, makeBold,\n\n  isItalicOn, setIsItalicOn,\n\n  styleType, editor, ...props }) {\n  const theme = useTheme()\n  return (\n    <Button   {...props}\n\n      style={{\n\n        backgroundColor: isItalicOn ? theme.palette.primary.main : \"\",//theme.palette.background.default,\n\n\n        color: theme.palette.type === \"light\"\n          ? isItalicOn\n            ? theme.palette.primary.contrastText\n            : theme.palette.primary.main\n          : isItalicOn\n            ? theme.palette.primary.contrastText\n            : theme.palette.text.secondary\n\n      }}\n\n\n      onClick={function (e) {\n        editor.current.focus()\n        //  setIsItalicOn(pre => !pre)\n\n        makeBold(\"ITALIC\", setIsItalicOn)\n\n      }}\n    >\n      <FormatItalic />\n      {/* {children} */}\n    </Button>\n\n  )\n}\n\nfunction UnderlineButton({ children, makeBold,\n\n  isUnderlineOn, setIsUnderlineOn,\n\n  styleType, editor, ...props }) {\n  const theme = useTheme()\n  return (\n    <Button   {...props}\n\n\n      style={{\n\n        backgroundColor: isUnderlineOn ? theme.palette.primary.main : \"\",// theme.palette.background.default,\n\n\n        color: theme.palette.type === \"light\"\n          ? isUnderlineOn\n            ? theme.palette.primary.contrastText\n            : theme.palette.primary.main\n          : isUnderlineOn\n            ? theme.palette.primary.contrastText\n            : theme.palette.text.secondary\n\n      }}\n\n\n      onClick={function (e) {\n        //    setIsUnderlineOn(pre => !pre)\n        editor.current.focus()\n        makeBold(\"UNDERLINE\", setIsUnderlineOn)\n\n      }}\n    >\n      < FormatUnderlined />\n      {/* {children} */}\n    </Button>\n\n  )\n\n\n\n}","import React, { useState, useRef, useEffect } from 'react';\n\nimport { EditorState, KeyBindingUtil, convertToRaw, convertFromRaw, RichUtils, Modifier, convertFromHTML, SelectionState, CharacterMetadata } from 'draft-js';\nimport Immutable from 'immutable'\n\nimport axios from \"axios\"\nimport url from \"./config\"\n\nimport { makeStyles, styled, useTheme } from '@material-ui/core/styles';\nimport { Typography, Button, ButtonGroup, Container, Paper, Avatar, IconButton } from \"@material-ui/core\";\nimport { InsertEmoticon } from \"@material-ui/icons\";\nimport { height } from '@material-ui/system';\n\nimport {\n  isMobile,\n  isFirefox,\n  isChrome,\n  browserName,\n  engineName,\n} from \"react-device-detect\";\n\n\n\nexport default function createImagePlugin() {\n  //  const url = \"http://szwb1.herokuapp.com/api\"\n  let externalES = null;\n  let externalSetEditorState = null;\n\n  let emojiArr = [\n    '\\u2620',\n    '\\u2764',\n    '\\uD83D\\uDC69\\u200D\\u2764\\uFE0F\\u200D\\uD83D\\uDC8B\\u200D\\uD83D\\uDC69',\n    '\\uD83D\\uDC7F',\n    '\\uD83D\\uDC80',\n    '\\uD83D\\uDCA9',\n    '\\uD83D\\uDE01',\n    '\\uD83D\\uDE02',\n    '\\uD83D\\uDE03',\n    '\\uD83D\\uDE04',\n    '\\uD83D\\uDE05',\n    '\\uD83D\\uDE06',\n    '\\uD83D\\uDE07',\n    '\\uD83D\\uDE08',\n    '\\uD83D\\uDE09',\n    '\\uD83D\\uDE0A',\n    '\\uD83D\\uDE0B',\n    '\\uD83D\\uDE0C',\n    '\\uD83D\\uDE0D',\n    '\\uD83D\\uDE0E',\n    '\\uD83D\\uDE0F',\n    '\\uD83D\\uDE10',\n    '\\uD83D\\uDE12',\n    '\\uD83D\\uDE13',\n    '\\uD83D\\uDE14',\n    '\\uD83D\\uDE16',\n    '\\uD83D\\uDE18',\n    '\\uD83D\\uDE1A',\n    '\\uD83D\\uDE1C',\n    '\\uD83D\\uDE1D',\n    '\\uD83D\\uDE1E',\n    '\\uD83D\\uDE20',\n    '\\uD83D\\uDE21',\n    '\\uD83D\\uDE22',\n    '\\uD83D\\uDE23',\n    '\\uD83D\\uDE24',\n    '\\uD83D\\uDE25',\n    '\\uD83D\\uDE28',\n    '\\uD83D\\uDE29',\n    '\\uD83D\\uDE2A',\n    '\\uD83D\\uDE2B',\n    '\\uD83D\\uDE2D',\n    '\\uD83D\\uDE30',\n    '\\uD83D\\uDE31',\n    '\\uD83D\\uDE32',\n    '\\uD83D\\uDE33',\n    '\\uD83D\\uDE35',\n    '\\uD83D\\uDE36',\n    '\\uD83D\\uDE37',\n    '\\uD83D\\uDE47\\u200D\\u2640\\uFE0F',\n    '\\uD83E\\uDD24',\n    '\\uD83E\\uDD71'\n  ]\n  const emojiUrl = `url(${url}/picture/downloademoji/`\n  let emoji = {}\n\n  emojiArr.forEach(icon => {\n\n    emoji[icon] = emojiUrl + icon + \".png\"\n  })\n\n\n  function insertEmoji(text) {\n\n    const [anchorKey, anchorOffset, focusKey, focusOffset, isBackward, hasfocus] = externalES.getSelection().toArray()\n    const [anchorStartKey, anchorStartOffset, anchorFocusKey, anchorFocusOffset, isAnchorBackward, isAnchorFocused]\n      = [!isBackward ? anchorKey : focusKey, !isBackward ? anchorOffset : focusOffset, isBackward ? anchorKey : focusKey, isBackward ? anchorOffset : focusOffset,]\n\n\n    let newContent = Modifier.replaceText(\n      externalES.getCurrentContent(),\n      externalES.getSelection(),\n      text,\n    )\n\n    let newSelection = externalES.getSelection().merge({\n\n      anchorKey: anchorStartKey,\n      anchorOffset: anchorStartOffset + text.length,\n      focusKey: anchorStartKey,\n      focusOffset: anchorStartOffset + text.length,\n      isBackward: false,\n      hasFocus: true,\n    })\n\n    externalES = EditorState.push(externalES, newContent, \"insert-characters\");\n    externalES = EditorState.acceptSelection(externalES, newSelection)\n\n    externalSetEditorState(externalES)\n  }\n\n  function taggingEmoji() {\n\n    const [anchorKey, anchorOffset, focusKey, focusOffset, isBackward, hasfocus] = externalES.getSelection().toArray()\n    const [anchorStartKey, anchorStartOffset, anchorFocusKey, anchorFocusOffset, isAnchorBackward, isAnchorFocused]\n      = [!isBackward ? anchorKey : focusKey, !isBackward ? anchorOffset : focusOffset, isBackward ? anchorKey : focusKey, isBackward ? anchorOffset : focusOffset,]\n\n\n    const oldSelection = externalES.getSelection();\n    let newContent = externalES.getCurrentContent();\n    let newSelection = externalES.getSelection();\n\n    externalES.getCurrentContent().getBlocksAsArray().forEach(function (block) {\n\n      const [blockKey, , blockText, metaArr] = block.toArray()\n\n      metaArr.forEach(function (item, index) {\n        const itemEntityKey = item.getEntity()\n        if (itemEntityKey) {\n          const entityType = newContent.getEntity(itemEntityKey).getType()\n          if (entityType === \"EMOJI\") {\n\n            newSelection = newSelection.merge({\n              anchorKey: blockKey,\n              anchorOffset: index,\n              focusKey: blockKey,\n              focusOffset: index + 1,\n              isBackward: false,\n              hasFocus: false,\n            })\n            newContent = Modifier.applyEntity(newContent, newSelection, null)\n          }\n        }\n      })\n\n\n      Object.keys(emoji).forEach(function (emojiKey) {\n\n        const regx = new RegExp(`${emojiKey}`, \"g\")\n        // const array = [...blockText.matchAll(regx)].map(a => a.index);\n        const array = []\n        let matchArr;\n        while ((matchArr = regx.exec(blockText)) !== null) {\n\n          const start = matchArr.index;\n          const end = matchArr.index + matchArr[0].length;\n\n          array.push(start)\n        }\n\n\n        array.forEach(function (offset) {\n\n          newContent = newContent.createEntity(\"EMOJI\", \"IMMUTABLE\", { url: emoji[emojiKey], symbol: emojiKey });\n          const entityKey = newContent.getLastCreatedEntityKey();\n\n          newSelection = newSelection.merge({\n            anchorKey: blockKey,\n            anchorOffset: offset,\n            focusKey: blockKey,\n            focusOffset: offset + emojiKey.length,\n            isBackward: false,\n            hasFocus: false,\n\n          })\n          newContent = Modifier.applyEntity(newContent, newSelection, entityKey)\n\n        })\n\n      })\n\n    })\n    externalES = EditorState.push(externalES, newContent, \"insert-characters\");\n    externalES = EditorState.acceptSelection(externalES, oldSelection);\n    return externalES\n  }\n\n  function emojiStrategy(contentBlock, callback, contentState) {\n\n\n    contentBlock.findEntityRanges(\n      function (character) {\n        const entityKey = character.getEntity();\n        return (\n          entityKey !== null &&\n          contentState.getEntity(entityKey).getType() === \"EMOJI\"\n\n        );\n      },\n      callback\n    );\n  };\n\n  function Emoji(props) {\n    const { contentState, entityKey, blockKey, offsetKey, start, end, decoratedText } = props;\n\n    // const { fontSize2 } = useContext(ThemeContext)\n    // const isComputer = !useMediaQuery({ query: '(hover: none)' });\n\n    const iconRef = useRef()\n    const theme = useTheme()\n\n\n    // return (\n\n    //   <Avatar src={emoji[decoratedText].replace(\"url(\", \"\").replace(\")\", \"\")}\n\n\n    //     style={{ transform: \"scale(1.2)\", display: \"inline\", borderRadius: 0 }} />\n\n    // )\n    return (\n      <>\n\n\n\n        <span\n\n          ref={iconRef}\n          className=\"emoji\"\n          style={{\n\n\n            backgroundRepeat: \"no-repeat\",\n\n            backgroundPosition: \"center center\",\n            backgroundSize: \"contain\",\n            display: \"inline-block\",\n\n            textAlign: \"right\",\n            marginLeft: theme.typography.fontSize * 0.12,\n            marginRight: theme.typography.fontSize * 0.12,\n            //   verticalAlign: \"middle\",\n            transform: isMobile ? \"scale(1.2)\" : \"scale(1.2)\",\n            backgroundImage: emoji[decoratedText],\n\n\n          }}\n        >\n          <span style={{\n            clipPath: \"circle(0% at 50% 50%)\",\n\n            //  clipPath: isFirefox ? null : \"circle(0% at 50% 50%)\",\n          }}>\n            {props.children}\n\n          </span>\n        </span>\n\n      </>\n\n    );\n\n\n  };\n\n\n  return {\n\n\n\n    emojiPlugin: {\n\n      onChange: function (editorState, { setEditorState }) {\n\n\n        externalES = editorState\n        externalSetEditorState = setEditorState\n        externalES = taggingEmoji()\n\n        return externalES\n      },\n      decorators: [\n        {\n          strategy: emojiStrategy,\n          component: Emoji\n        }\n      ],\n    },\n\n\n    EmojiButton: function (props) { return <EmojiButton {...props} /> },\n\n    EmojiIconButton: function (props) { return <EmojiIconButton {...props} /> },\n\n    EmojiPanel: function (props) { return <EmojiPanel emoji={emoji} insertEmoji={insertEmoji} {...props} /> },\n\n\n  }\n}\n\nfunction EmojiButton({ children, isEmojiPanelOn, setIsEmojiPanelOn, ...props }) {\n\n  const theme = useTheme()\n\n  return (\n    <>\n      <Button\n        {...props}\n\n        style={{\n\n          backgroundColor: isEmojiPanelOn ? theme.palette.primary.main : \"\",// theme.palette.background.default,\n\n\n          color: theme.palette.type === \"light\"\n            ? isEmojiPanelOn\n              ? theme.palette.primary.contrastText\n              : theme.palette.primary.main\n            : isEmojiPanelOn\n              ? theme.palette.primary.contrastText\n              : theme.palette.text.secondary\n\n\n        }}\n\n\n        onClick={function (e) {\n          setIsEmojiPanelOn(pre => !pre)\n        }}\n      >\n        <InsertEmoticon />\n        {/* {children} */}\n      </Button>\n\n    </>\n  )\n\n}\n\nfunction EmojiIconButton({ children, isEmojiPanelOn, setIsEmojiPanelOn, ...props }) {\n\n  const theme = useTheme()\n\n  return (\n    <>\n      <Paper style={{ borderRadius: \"1000px\", transform: \"scale(0.8)\", }} elevation={3}>\n        <IconButton size=\"small\"\n          {...props}\n\n          style={{\n\n\n            backgroundColor: isEmojiPanelOn ? theme.palette.primary.main : theme.palette.background.paper,// theme.palette.background.default,\n\n\n            color: theme.palette.type === \"light\"\n              ? isEmojiPanelOn\n                ? theme.palette.primary.contrastText\n                : theme.palette.primary.main\n              : isEmojiPanelOn\n                ? theme.palette.primary.contrastText\n                : theme.palette.text.secondary\n\n\n          }}\n\n\n          onClick={function (e) {\n            setIsEmojiPanelOn(pre => !pre)\n          }}\n        >\n          <InsertEmoticon />\n          {/* {children} */}\n        </IconButton>\n      </Paper>\n    </>\n  )\n\n}\n\n\n\nfunction EmojiPanel({ children, emoji, insertEmoji, isEmojiPanelOn, marginBottom, ...props }) {\n\n  const theme = useTheme()\n\n  return (\n\n    <Paper\n\n      // className={emojiPanelClass}\n      style={{\n        maxWidth: \"100%\",\n        overflow: \"auto\",\n        // marginBottom: \"10px\",\n        marginTop: isEmojiPanelOn ? \"10px\" : 0,\n        //  height: isEmojiPanelOn ? \"auto\" : 0,\n        maxHeight: isEmojiPanelOn ? \"30vh\" : 0,\n\n        transitionProperty: \"height,max-height, opacity\",\n        transitionDuration: \"0.2s\",\n        opacity: isEmojiPanelOn ? 1 : 0,\n        // marginBottom: isEmojiPanelOn ? theme.spacing(2) : 0\n        marginBottom: marginBottom || theme.spacing(2),\n      }}>\n\n\n\n      {Object.keys(emoji).map(function (icon, index) {\n\n\n        return <Button variant=\"text\" key={icon} onClick={\n          function (e) {\n            // alert(\"dsd\")\n            insertEmoji(icon)\n          }\n        }>\n\n          <Avatar src={emoji[icon].replace(\"url(\", \"\").replace(\")\", \"\")} style={{ transform: \"scale(1.2)\", borderRadius: 0 }} />\n        </Button>\n\n\n        return <Button variant=\"text\" key={icon}\n\n          size=\"small\"\n          style={{\n            color: \"rgba(0,0,0,0)\",\n            backgroundImage: emoji[icon],\n            backgroundRepeat: \"no-repeat\",\n\n            backgroundPosition: \"center center\",\n            backgroundSize: \"contain\",\n            transform: \"scale(0.85)\",\n\n          }}\n          onClick={\n            function (e) {\n              // alert(\"dsd\")\n              insertEmoji(icon)\n            }\n          }\n\n        >\n          {icon}\n        </Button>\n      })}\n\n\n\n\n\n    </Paper>\n  )\n}","import { useState, useRef, useEffect, useContext, useCallback, createContext, useMemo } from 'react';\r\nimport { Context } from \"./ContextProvider\"\r\n\r\n\r\nimport { EditorState, ContentState, ContentBlock, CharacterMetadata, SelectionState, convertToRaw, convertFromRaw, RichUtils, Modifier, convertFromHTML, AtomicBlockUtils } from 'draft-js';\r\nimport Editor from \"draft-js-plugins-editor\";\r\nimport Immutable from 'immutable';\r\n\r\nimport { makeStyles, styled, useTheme, withStyles } from '@material-ui/core/styles';\r\nimport { Typography, Button, ButtonGroup, Container, Paper, Avatar, Box, Chip, Grow } from \"@material-ui/core\";\r\nimport { Image, AlternateEmailSharp } from \"@material-ui/icons\";\r\n\r\nimport {\r\n  isMobile,\r\n  isFirefox,\r\n  isChrome,\r\n  browserName,\r\n  engineName,\r\n} from \"react-device-detect\";\r\n\r\n//import axios from \"axios\";\r\nimport {axios,avatarUrl} from \"./config\";\r\n\r\n\r\nexport const useStyles = makeStyles(props => {\r\n  const theme = useTheme()\r\n\r\n  return {\r\n\r\n    mentionHeadAvatar: props => {\r\n      return {\r\n        position: \"absolute\",\r\n        top: \"50%\",\r\n        left: \"50%\",\r\n        //  width: theme.typography.fontSize + \"px\",\r\n        //  height: theme.typography.fontSize + \"px\",\r\n        transform: \"translate(-50%, -50%) scale(1)\",\r\n      }\r\n    },\r\n\r\n\r\n    mentionHeadRoot: props => {\r\n      return {\r\n        borderRadius: 999,\r\n        borderTopRightRadius: 0,\r\n        borderBottomRightRadius: 0,\r\n\r\n        position: \"relative\",\r\n\r\n        //width: theme.typography.fontSize,\r\n        height: \"100%\",\r\n\r\n        backgroundColor: theme.palette.mentionBackColor,// \"pink\",\r\n        position: \"relative\",\r\n        // boxShadow: \"10px 1px 4px -2px rgba(100,100,100,0.75)\",\r\n      }\r\n    },\r\n\r\n\r\n    mentionBodyRoot: props => {\r\n      return {\r\n        borderRadius: 999,\r\n        borderTopLeftRadius: 0,\r\n        borderBottomLeftRadius: 0,\r\n\r\n        height: \"100%\",\r\n\r\n        backgroundColor: theme.palette.mentionBackColor,//\"blue\",\r\n        // boxShadow: \"0px 1px 4px -2px rgba(100,100,100,0.75)\",\r\n      }\r\n    },\r\n    mentionBodyRoot2: props => {\r\n      return {\r\n        borderRadius: 999,\r\n        height: \"100%\",\r\n        backgroundColor: theme.palette.mentionBackColor,//\"blue\",\r\n        boxShadow: theme.shadows[2] //\"0px 1px 2px 1px rgba(160,160,160,0.75)\",\r\n      }\r\n    },\r\n\r\n\r\n\r\n    mentionHeadLabel: props => {\r\n      return {\r\n\r\n        //    fontSize: theme.typography.fontSize,\r\n        paddingLeft: 0,\r\n        paddingRight: 0,\r\n        borderStyle: \"none\",\r\n        //  color: \"rgba(200,0,0,0)\",\r\n        //   ...(!isMobile) && { color: \"rgba(200,0,0,0)\" },\r\n        //   clipPath: \"circle(0% at 50% 50%)\",\r\n        // '&:hover': { padding:0},\r\n      }\r\n    },\r\n\r\n    mentionHeadLabel2: props => {\r\n      return {\r\n\r\n        //    fontSize: theme.typography.fontSize,\r\n        paddingLeft: 0,\r\n        paddingRight: 0,\r\n        borderStyle: \"none\",\r\n        color: \"rgba(200,0,0,0)\",\r\n        // '&:hover': { padding:0},\r\n      }\r\n    },\r\n\r\n\r\n    mentionBodyLabel: props => {\r\n      return {\r\n        //    fontSize: theme.typography.fontSize,\r\n        borderStyle: \"none\",\r\n        // '&:hover': { padding:0},\r\n      }\r\n    },\r\n\r\n\r\n\r\n\r\n  }\r\n});\r\n\r\nexport default function createMentionPlugin() {\r\n  //  const url = \"http://szwb1.herokuapp.com/api\";\r\n // const url = \"https://api.multiavatar.com\"\r\n\r\n  const url = avatarUrl\r\n\r\n  \r\n  let externalES = null;\r\n  let externalSetEditorState = null;\r\n  let friendsList = isMobile?[]:[\"刘德华\", \"郭富城\", \"阿狗\"];\r\n  //let friendsList = [];\r\n  const friendObj = {}\r\n\r\n  friendsList.forEach(friendName => {\r\n    friendObj[friendName] = null\r\n    axios.get(\r\n      //`${url}/avatar/downloadavatar/${friendName}`,\r\n      `${url}/${friendName}.svg`,\r\n      {\r\n        responseType: 'arraybuffer',\r\n        onDownloadProgress: function (progressEvent) { }\r\n      }).then((response) => {\r\n        const base64 = btoa(new Uint8Array(response.data).reduce((data, byte) => data + String.fromCharCode(byte), ''));\r\n        friendObj[friendName] = \"data:\" + response.headers[\"content-type\"] + \";base64,\" + base64\r\n      })\r\n\r\n\r\n  })\r\n\r\n  let tabIndex = 99123;\r\n\r\n  function Panel0({ inMentionPanel = false, ...props }) {\r\n\r\n\r\n    return (\r\n      <div\r\n\r\n        contentEditable=\"false\" suppressContentEditableWarning=\"true\"\r\n        style={{ backgroundColor: \"pink\", position: \"absolute\", zIndex: 100, width: \"max-content\" }}\r\n\r\n      >\r\n        {friendsList.map(friendName => {\r\n          return (\r\n            <div onMouseDown={function () { alert(\"xxddssddss\") }}>\r\n              {friendName}\r\n            </div>\r\n          )\r\n        })}\r\n\r\n      </div>\r\n\r\n    )\r\n\r\n  }\r\n\r\n\r\n\r\n  function Panel({ inMentionPanel = false, ...props }) {\r\n    const theme = useTheme()\r\n    const [opacity, setOpacity] = useState(0)\r\n\r\n    const { mentionHeadKey, mentionBodyKey, entityKey } = props\r\n    const { mentionHeadRoot, mentionBodyRoot, mentionBodyRoot2, mentionHeadAvatar, mentionHeadLabel, mentionHeadLabel2, mentionBodyLabel, } = useStyles();\r\n\r\n\r\n\r\n    useEffect(function () {\r\n      setOpacity(1)\r\n    }, [])\r\n\r\n    return (\r\n\r\n      <Paper\r\n        elevation={2}\r\n\r\n        contentEditable=\"false\" suppressContentEditableWarning=\"true\"\r\n        style={{\r\n\r\n          width: \"max-content\",\r\n          position: \"absolute\",\r\n          marginTop: theme.spacing(0),\r\n          //  top:0,\r\n          left: \"0px\",\r\n          zIndex: 122,\r\n          display: \"flex\",\r\n\r\n          flexDirection: \"column\",\r\n          opacity: opacity,\r\n          transform: `scale(${opacity})`,\r\n          transitionProperty: \"opacity,transform\",\r\n          transitionDuration: \"0.2s\",\r\n\r\n\r\n        }}>\r\n\r\n\r\n        {friendsList.map(function (friendName, index) {\r\n\r\n          return (\r\n\r\n            <Chip\r\n              key={index}\r\n              classes={{ root: mentionBodyRoot2, label: mentionBodyLabel }}\r\n              style={{\r\n                backgroundColor: (props.tabIndex % friendsList.length === index)\r\n                  ? theme.palette.mentionBackColor : inMentionPanel ? theme.palette.mentionBackColor : theme.palette.action.disabledBackground,\r\n                // ...(props.tabIndex % friendsList.length === index)&&{ backgroundColor:theme.palette.mentionBackColor}\r\n                cursor: \"pointer\",\r\n                width: \"fit-content\"\r\n              }}\r\n\r\n              avatar={<Avatar alt=\"Natacha\" src={friendObj[friendName]} />}\r\n\r\n              onMouseDown={() => {\r\n                insertMention(inMentionPanel ? \" @\" + friendName : friendName, mentionHeadKey, mentionBodyKey, entityKey)\r\n              }}\r\n\r\n              label={<Typography variant=\"body2\" >{friendName}</Typography>}\r\n            />\r\n          )\r\n\r\n        })}\r\n\r\n\r\n\r\n\r\n      </Paper>\r\n\r\n    )\r\n  }\r\n\r\n\r\n  function Mention(props) {\r\n\r\n    const { contentState, entityKey, blockKey, offsetKey, start, end, decoratedText, children } = props;\r\n    const { mentionHeadKey, mentionBodyKey, person, imgurl, mentionType } = contentState.getEntity(entityKey).getData()\r\n    const theme = useTheme()\r\n    const { mentionHeadRoot, mentionBodyRoot, mentionBodyRoot2, mentionHeadAvatar, mentionHeadLabel, mentionHeadLabel2, mentionBodyLabel, } = useStyles();\r\n\r\n    if ((mentionType === \"shortMentionOn\")) {\r\n      return (\r\n        <span style={{\r\n          position: \"relative\",\r\n          // display: \"inline-block\",\r\n\r\n        }}>\r\n\r\n          <Chip\r\n            style={{ display: \"inline-block\" }}\r\n            classes={{ root: mentionHeadRoot, avatar: mentionHeadAvatar, label: mentionHeadLabel }}\r\n            avatar={<Avatar alt=\"Natacha\" style={{ opacity: 0.5, }} />}\r\n            label={<Typography variant=\"body2\" style={{ clipPath: \"circle(0% at 50% 50%)\", }}>{children}</Typography>}\r\n          />\r\n          {!isMobile && <Panel tabIndex={tabIndex} mentionHeadKey={mentionHeadKey} mentionBodyKey={mentionBodyKey} entityKey={entityKey} />}\r\n        </span>\r\n      )\r\n    }\r\n    else if (mentionType === \"shortMentionOff\") {\r\n\r\n      return (\r\n        <span style={{\r\n          position: \"relative\",\r\n          borderTopLeftRadius: \"999px\",\r\n          borderBottomLeftRadius: \"999px\",\r\n        }}>\r\n          {children}\r\n        </span>\r\n      )\r\n    }\r\n\r\n\r\n    else if (mentionType === \"longMentionOnAt_HEAD\") {\r\n      return (\r\n        <span style={{\r\n          position: \"relative\",\r\n          //   display: \"inline-block\",\r\n        }}>\r\n\r\n          <Chip\r\n            classes={{ root: mentionHeadRoot, avatar: mentionHeadAvatar, label: mentionHeadLabel }}\r\n            avatar={<Avatar alt=\"Natacha\" style={{ opacity: 0.5, }} />}\r\n            label={<Typography variant=\"body2\" style={{ clipPath: \"circle(0% at 50% 50%)\", }}>{children}</Typography>}\r\n          />\r\n          {!isMobile && <Panel tabIndex={tabIndex} mentionHeadKey={mentionHeadKey} mentionBodyKey={mentionBodyKey} entityKey={entityKey} />}\r\n        </span>\r\n\r\n      )\r\n    }\r\n\r\n    else if (mentionType === \"longMentionOnAt_BODY\") {\r\n      return (\r\n\r\n        <Chip\r\n          classes={{ root: mentionBodyRoot, label: mentionBodyLabel }}\r\n          size=\"medium\"\r\n          label={<Typography variant=\"body2\" >{children}</Typography>}\r\n        />\r\n\r\n\r\n      )\r\n    }\r\n\r\n\r\n    ///////////////////////\r\n    ///////////////////////\r\n    else if (mentionType === \"longMentionOnOther_HEAD\") {\r\n\r\n\r\n      return (\r\n\r\n        // <Chip\r\n        //   classes={{ root: mentionHeadRoot, avatar: mentionHeadAvatar, label: mentionHeadLabel }}\r\n        //   avatar={<Avatar alt=\"Natacha\" style={{}} />}\r\n        //   label={<Typography variant=\"body2\" >{children}</Typography>}\r\n        // />\r\n        <Chip\r\n\r\n          classes={{ root: mentionHeadRoot, avatar: mentionHeadAvatar, label: mentionHeadLabel }}\r\n          avatar={<Avatar alt=\"Natacha\" style={{ opacity: 0.5, }} />}\r\n          label={<Typography variant=\"body2\" style={{ clipPath: \"circle(0% at 50% 50%)\", }}>{children}</Typography>}\r\n\r\n        />\r\n\r\n\r\n\r\n      )\r\n    }\r\n    else if (mentionType === \"longMentionOnOther_BODY\") {\r\n      return (\r\n\r\n        <Chip\r\n          classes={{ root: mentionBodyRoot, label: mentionBodyLabel }}\r\n          label={<Typography variant=\"body2\" >{children}</Typography>}\r\n        />\r\n\r\n\r\n      )\r\n    }\r\n    ////////////////////////////////////////////////\r\n    ////////////////////////////////////////////////\r\n    else if (mentionType === \"longMentionOff_HEAD\") {\r\n\r\n      return <></>\r\n\r\n    }\r\n\r\n    else if (mentionType === \"longMentionOff_BODY\") {\r\n\r\n\r\n\r\n      return <>\r\n\r\n\r\n\r\n        <Chip\r\n          classes={{ root: mentionBodyRoot2, label: mentionBodyLabel }}\r\n          avatar={<Avatar alt=\"Natacha\" src={friendObj[person]||`${url}/${person}.svg`}\r\n\r\n          />}\r\n          label={<Typography variant=\"body2\" >{children}</Typography>}\r\n        />\r\n\r\n      </>\r\n\r\n\r\n    }\r\n\r\n\r\n\r\n\r\n  }\r\n\r\n  function mentionStrategy(contentBlock, callback, contentState) {\r\n\r\n    contentBlock.findEntityRanges(\r\n      function (character) {\r\n        const entityKey = character.getEntity();\r\n        return entityKey !== null && contentState.getEntity(entityKey).getType().indexOf(\"Mention\") >= 0\r\n      },\r\n      callback\r\n    );\r\n  }\r\n\r\n\r\n  function insertMention(friendName, mentionHeadKey, mentionBodyKey, entityKey) {\r\n\r\n\r\n    const text = friendName + \" \"\r\n    const contentState = externalES.getCurrentContent();\r\n    const selection = externalES.getSelection();\r\n\r\n\r\n    const mentionBodyText = mentionBodyKey\r\n      ? contentState.getEntity(mentionBodyKey).getData().person.replace(\" @\", \"\")\r\n      : \"\"\r\n\r\n    const [anchorKey, anchorOffset, focusKey, focusOffset, isBackward, hasfocus] = selection.toArray()\r\n    const [anchorStartKey, anchorStartOffset, anchorFocusKey, anchorFocusOffset, isAnchorBackward, isAnchorFocused]\r\n      = [!isBackward ? anchorKey : focusKey, !isBackward ? anchorOffset : focusOffset, isBackward ? anchorKey : focusKey, isBackward ? anchorOffset : focusOffset,]\r\n\r\n\r\n    let newSelection = selection.merge({\r\n      anchorKey: anchorStartKey,\r\n      anchorOffset: anchorStartOffset,\r\n      focusKey: anchorStartKey,\r\n      focusOffset: anchorStartOffset + mentionBodyText.length,\r\n      isBackward: false,\r\n      hasFocus: true,\r\n\r\n    })\r\n\r\n\r\n    let newContent = Modifier.replaceText(\r\n      contentState,\r\n      newSelection,\r\n      text,\r\n    )\r\n\r\n    newSelection = externalES.getSelection().merge({\r\n\r\n      anchorKey: anchorStartKey,\r\n      anchorOffset: anchorStartOffset + text.length,\r\n      focusKey: anchorStartKey,\r\n      focusOffset: anchorStartOffset + text.length,\r\n      isBackward: false,\r\n      hasFocus: true,\r\n    })\r\n\r\n    externalES = EditorState.push(externalES, newContent, \"insert-characters\");\r\n    externalES = EditorState.acceptSelection(externalES, newSelection)\r\n\r\n\r\n    externalSetEditorState(externalES)\r\n\r\n\r\n  }\r\n\r\n\r\n\r\n  function taggingMention() {\r\n\r\n    const [anchorKey, anchorOffset, focusKey, focusOffset, isBackward, hasfocus] = externalES.getSelection().toArray()\r\n    const [anchorStartKey, anchorStartOffset, anchorFocusKey, anchorFocusOffset, isAnchorBackward, isAnchorFocused]\r\n      = [!isBackward ? anchorKey : focusKey, !isBackward ? anchorOffset : focusOffset, isBackward ? anchorKey : focusKey, isBackward ? anchorOffset : focusOffset,]\r\n    const regx = /\\s([@][\\w_\\[\\u4E00-\\u9FCA\\]]*)/g\r\n\r\n\r\n    const oldSelection = externalES.getSelection();\r\n    let newSelection = externalES.getSelection();\r\n    let newContent = externalES.getCurrentContent();\r\n\r\n    externalES.getCurrentContent().getBlocksAsArray().forEach(function (block) {\r\n\r\n      const [blockKey, , blockText, metaArr] = block.toArray()\r\n\r\n\r\n      metaArr.forEach(function (item, index) {\r\n        const itemEntityKey = item.getEntity()\r\n        if (itemEntityKey) {\r\n          const entityType = newContent.getEntity(itemEntityKey).getType()\r\n\r\n          if (entityType.indexOf(\"Mention\") >= 0) {\r\n\r\n            newSelection = newSelection.merge({\r\n              anchorKey: blockKey,\r\n              anchorOffset: index,\r\n              focusKey: blockKey,\r\n              focusOffset: index + 1,\r\n              isBackward: false,\r\n              hasFocus: false,\r\n            })\r\n            newContent = Modifier.applyEntity(newContent, newSelection, null)\r\n          }\r\n        }\r\n      })\r\n\r\n\r\n      let matchArr;\r\n      while ((matchArr = regx.exec(blockText)) !== null) {\r\n\r\n        const start = matchArr.index;\r\n        const end = matchArr.index + matchArr[0].length;\r\n        const contentLenth = end - start;\r\n        const contentFocusAt = anchorFocusOffset - start;\r\n\r\n        const shortMentionOn = (contentLenth === 2) && hasfocus && (blockKey === anchorFocusKey) && (contentFocusAt === 2)\r\n        const shortMentionOff = (contentLenth === 2) && ((!hasfocus) || (blockKey !== anchorFocusKey) || (contentFocusAt !== 2))\r\n\r\n        const longMentionOnAt = (contentLenth > 2) && hasfocus && (blockKey === anchorFocusKey) && (contentFocusAt === 2)\r\n        const longMentionOnOther = (contentLenth > 2) && hasfocus && (blockKey === anchorFocusKey) && (contentFocusAt !== 2) && (contentFocusAt > 0) && (contentFocusAt <= contentLenth)\r\n\r\n        const longMentionOff = (contentLenth > 2) && ((!hasfocus) || (blockKey !== anchorFocusKey) || (contentFocusAt <= 0) || (contentFocusAt > contentLenth))\r\n\r\n\r\n        if (shortMentionOn) {\r\n          newContent = newContent.createEntity(\"shortMentionOn\", \"MUTABLE\", { mentionType: \"shortMentionOn\" });\r\n          let entityKey = newContent.getLastCreatedEntityKey();\r\n          newSelection = newSelection.merge({\r\n            anchorKey: blockKey,\r\n            focusKey: blockKey,\r\n            anchorOffset: start,\r\n            focusOffset: end,\r\n            isBackward: false,\r\n            hasFocus: false,\r\n          })\r\n\r\n          newContent = Modifier.applyEntity(newContent, newSelection, entityKey)\r\n\r\n        }\r\n        else if (shortMentionOff) {\r\n          newContent = newContent.createEntity(\"shortMentionOff\", \"MUTABLE\", { mentionType: \"shortMentionOff\" });\r\n          let entityKey = newContent.getLastCreatedEntityKey();\r\n          newSelection = newSelection.merge({\r\n            anchorKey: blockKey,\r\n            focusKey: blockKey,\r\n            anchorOffset: start,\r\n            focusOffset: end,\r\n            isBackward: false,\r\n            hasFocus: false,\r\n          })\r\n\r\n          newContent = Modifier.applyEntity(newContent, newSelection, entityKey)\r\n\r\n        }\r\n        else if (longMentionOnAt) {\r\n\r\n          createTag(\"longMentionOnAt\")\r\n\r\n        }\r\n        else if (longMentionOnOther) {\r\n\r\n          createTag(\"longMentionOnOther\")\r\n\r\n        }\r\n        else if (longMentionOff) {\r\n          createTag(\"longMentionOff\")\r\n        }\r\n\r\n\r\n\r\n        function createTag(tagName) {\r\n\r\n          newContent = newContent.createEntity(`${tagName}_HEAD`, \"MUTABLE\", { mentionType: `${tagName}_HEAD` });\r\n          let mentionHeadKey = newContent.getLastCreatedEntityKey();\r\n          newSelection = newSelection.merge({\r\n            anchorKey: blockKey,\r\n            focusKey: blockKey,\r\n            anchorOffset: start,\r\n            focusOffset: start + 2,\r\n            isBackward: false,\r\n            hasFocus: false,\r\n          })\r\n\r\n          newContent = Modifier.applyEntity(newContent, newSelection, mentionHeadKey)\r\n\r\n          newContent = newContent.createEntity(`${tagName}_BODY`, \"MUTABLE\", { mentionType: `${tagName}_BODY` });\r\n          let mentionBodyKey = newContent.getLastCreatedEntityKey();\r\n          newSelection = newSelection.merge({\r\n            anchorKey: blockKey,\r\n            focusKey: blockKey,\r\n            anchorOffset: start + 2,\r\n            focusOffset: end,\r\n            isBackward: false,\r\n            hasFocus: false,\r\n          })\r\n\r\n          newContent = Modifier.applyEntity(newContent, newSelection, mentionBodyKey)\r\n\r\n\r\n          newContent = newContent.mergeEntityData(\r\n            mentionHeadKey,\r\n            {\r\n              mentionHeadKey, mentionBodyKey,\r\n              person: blockText.substring(start, end).replace(\" @\", \"\"),\r\n              //  imgurl: `url(${url}/avatar/downloadavatar/${blockText.substring(start, end).replace(\" @\", \"\")})`\r\n              imgurl: `${url}/${blockText.substring(start, end).replace(\" @\", \"\")}).svg`\r\n          \r\n            }\r\n          )\r\n\r\n          newContent = newContent.mergeEntityData(\r\n            mentionBodyKey,\r\n            {\r\n              mentionHeadKey, mentionBodyKey,\r\n              person: blockText.substring(start, end).replace(\" @\", \"\"),\r\n              //     imgurl: `url(${url}/avatar/downloadavatar/${blockText.substring(start, end).replace(\" @\", \"\")})`\r\n              imgurl: `${url}/${blockText.substring(start, end).replace(\" @\", \"\")}).svg`\r\n           \r\n            }\r\n          )\r\n        }\r\n\r\n\r\n\r\n      }\r\n    })\r\n\r\n\r\n    externalES = EditorState.push(externalES, newContent, \"apply-entity\");\r\n    externalES = EditorState.acceptSelection(externalES, oldSelection);\r\n    return externalES\r\n\r\n\r\n  }\r\n\r\n\r\n  function hasOnAtTag() {\r\n\r\n    if (friendsList.length <= 0) { return false }\r\n\r\n    let isAtOn = false;\r\n    const contentState = externalES.getCurrentContent();\r\n    contentState.getBlocksAsArray().forEach(function (block) {\r\n\r\n      const metaArr = block.getCharacterList();\r\n      metaArr.forEach(function (item, index) {\r\n\r\n        const tagKey = item.getEntity()\r\n        if (tagKey) {\r\n          const { mentionType, mentionHeadKey, mentionBodyKey } = contentState.getEntity(tagKey).getData()\r\n          if (mentionType) {\r\n\r\n            if (mentionType === \"shortMentionOn\") {\r\n              return isAtOn = [friendsList[tabIndex % friendsList.length], \"\", \"\", tagKey]\r\n            }\r\n            else if (mentionType.indexOf(\"longMentionOnAt\") >= 0) {\r\n              return isAtOn = [friendsList[tabIndex % friendsList.length], mentionHeadKey, mentionBodyKey, tagKey]\r\n            }\r\n          }\r\n        }\r\n      })\r\n\r\n      if (isAtOn) { return isAtOn }\r\n    })\r\n    return isAtOn\r\n  }\r\n\r\n  function MentionButton({ isMentionPanelOn, setIsMentionPanelOn, ...props }) {\r\n\r\n    const theme = useTheme()\r\n\r\n    return (\r\n      <>\r\n        <Button {...props}\r\n\r\n          style={{\r\n\r\n            backgroundColor: isMentionPanelOn ? theme.palette.primary.main : \"\",// theme.palette.background.default,\r\n\r\n\r\n            color: theme.palette.type === \"light\"\r\n              ? isMentionPanelOn\r\n                ? theme.palette.primary.contrastText\r\n                : theme.palette.primary.main\r\n              : isMentionPanelOn\r\n                ? theme.palette.primary.contrastText\r\n                : theme.palette.text.secondary\r\n\r\n\r\n          }}\r\n          onClick={function () {\r\n\r\n            setIsMentionPanelOn(pre => !pre)\r\n          }}\r\n\r\n        >\r\n          <AlternateEmailSharp />\r\n        </Button>\r\n\r\n      </>\r\n    )\r\n\r\n  }\r\n\r\n  function MentionPanel({ isMentionPanelOn, setIsMentionPanelOn, ...props }) {\r\n\r\n\r\n    return (\r\n      <Paper\r\n        style={{\r\n          position: \"relative\",\r\n          // backgroundColor:\"skyblue\",\r\n          // height:\"100px\",\r\n          // width:\"100px\",\r\n\r\n        }}\r\n\r\n      >\r\n        {isMentionPanelOn && <Panel inMentionPanel={true} />}\r\n\r\n      </Paper>\r\n    )\r\n  }\r\n\r\n\r\n  return {\r\n\r\n    mentionPlugin: {\r\n\r\n\r\n      handleBeforeInput(chars, editorState, evenTimeStamp, { setEditorState }) {\r\n\r\n        const [anchorKey, anchorOffset, focusKey, focusOffset, isBackward, hasfocus] = externalES.getSelection().toArray()\r\n        const [anchorStartKey, anchorStartOffset, anchorFocusKey, anchorFocusOffset, isAnchorBackward, isAnchorFocused]\r\n          = [!isBackward ? anchorKey : focusKey, !isBackward ? anchorOffset : focusOffset, isBackward ? anchorKey : focusKey, isBackward ? anchorOffset : focusOffset,]\r\n\r\n\r\n\r\n\r\n        if (hasOnAtTag() && isMobile && (!isFirefox)) {\r\n          externalES = editorState;\r\n          externalSetEditorState = setEditorState;\r\n\r\n          let newSelection = externalES.getSelection()\r\n          let newContent = externalES.getCurrentContent()\r\n\r\n          newSelection = newSelection.merge({\r\n            isBackward: false,\r\n            hasFocus: true,\r\n          })\r\n\r\n\r\n          newContent = Modifier.replaceText(\r\n            newContent,\r\n            newSelection,\r\n            chars,\r\n          )\r\n\r\n          newSelection = newSelection.merge({\r\n            anchorOffset: anchorStartOffset + chars.length * 2,\r\n            focusOffset: anchorFocusOffset + chars.length * 2,\r\n            isBackward: false,\r\n            hasFocus: true,\r\n          })\r\n\r\n\r\n          externalES = EditorState.push(externalES, newContent, \"insert-characters\");\r\n          externalES = EditorState.acceptSelection(externalES, newSelection)\r\n\r\n          setEditorState(externalES)\r\n\r\n          return \"handled\"\r\n        }\r\n\r\n      },\r\n\r\n      handleReturn(e, newState, { setEditorState }) {\r\n        //   alert(\"mention handle return\")\r\n        if (hasOnAtTag()) {\r\n          insertMention(...hasOnAtTag())\r\n          return \"handled\"\r\n        }\r\n        else {\r\n          setEditorState(RichUtils.insertSoftNewline(newState))\r\n          return \"handled\"\r\n\r\n          //////\r\n          const externalES = newState\r\n          let contentState = externalES.getCurrentContent();\r\n          let selection = externalES.getSelection()\r\n\r\n          const currentKey = selection.getEndKey()\r\n\r\n          let newContentBlockArr = contentState.getBlocksAsArray()\r\n\r\n          const currentBlock = contentState.getBlockForKey(currentKey)\r\n\r\n          const currentType = currentBlock.getType()\r\n\r\n          if ((currentType === \"colorBlock\") || (currentType === \"imageBlock\")) {\r\n\r\n            setEditorState(RichUtils.insertSoftNewline(newState))\r\n            return \"handled\"\r\n          }\r\n          else {\r\n            return 'not-handled';\r\n          }\r\n\r\n\r\n        }\r\n\r\n        return 'not-handled';\r\n      },\r\n\r\n\r\n\r\n      keyBindingFn(e, { getEditorState, setEditorState, ...obj }) {\r\n\r\n        if ((e.keyCode === 40) && hasOnAtTag()) {\r\n          tabIndex = tabIndex + 1;\r\n          return \"fire-arrow\";\r\n        }\r\n\r\n        else if ((e.keyCode === 38) && hasOnAtTag()) {\r\n          tabIndex = tabIndex - 1;\r\n          return \"fire-arrow\";\r\n        }\r\n\r\n        // else if ((e.keyCode === 13) && hasOnAtTag()) {\r\n        //   return \"fire-enter\";\r\n        // }\r\n\r\n\r\n      },\r\n\r\n      handleKeyCommand(command, editorState, evenTimeStamp, { setEditorState }) {\r\n\r\n        if (command === \"fire-arrow\") {\r\n          externalSetEditorState(externalES)\r\n          return \"handled\"\r\n        }\r\n\r\n        // if (command === \"fire-enter\") {\r\n        //   alert(\"xxdd\")\r\n        //   insertMention(...hasOnAtTag())\r\n        //   return \"handled\"\r\n        // }\r\n\r\n\r\n        return 'not-handled';\r\n      },\r\n\r\n\r\n      onChange: function (editorState, { setEditorState }) {\r\n        externalES = editorState\r\n        externalSetEditorState = setEditorState\r\n        externalES = taggingMention()\r\n        return externalES\r\n\r\n      },\r\n\r\n      decorators: [\r\n        {\r\n          strategy: mentionStrategy,\r\n          component: Mention\r\n        }\r\n      ],\r\n\r\n    },\r\n\r\n    MentionButton,\r\n\r\n    MentionPanel,\r\n  }\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\nconst formatStringToCamelCase = str => {\r\n  const splitted = str.split(\"-\");\r\n  if (splitted.length === 1) return splitted[0];\r\n  return (\r\n    splitted[0] +\r\n    splitted\r\n      .slice(1)\r\n      .map(word => word[0].toUpperCase() + word.slice(1))\r\n      .join(\"\")\r\n  );\r\n};\r\n\r\nconst getStyleObjectFromString = str => {\r\n  const style = {};\r\n  str.split(\";\").forEach(el => {\r\n    const [property, value] = el.split(\":\");\r\n    if (!property) return;\r\n\r\n    const formattedProperty = formatStringToCamelCase(property.trim());\r\n    style[formattedProperty] = value.trim();\r\n  });\r\n\r\n  return style;\r\n};","import React, { useState, useRef, useEffect } from 'react';\n\n\n\nimport { EditorState, ContentState, ContentBlock, CharacterMetadata, SelectionState, convertToRaw, convertFromRaw, RichUtils, Modifier, convertFromHTML, AtomicBlockUtils } from 'draft-js';\nimport Editor from \"draft-js-plugins-editor\";\nimport Immutable from 'immutable';\n\n\nimport { Typography, Button, ButtonGroup, Container, Link, Box } from \"@material-ui/core\";\nimport { CropOriginal, Image, Brightness4, Brightness5, FormatBold, FormatItalic, Link as LinkIcon } from \"@material-ui/icons\";\nimport { makeStyles, styled, useTheme } from '@material-ui/core/styles';\n\n\n\nexport default function createLlinkPlugin() {\n\n\n  let externalES = null;\n  let externalSetEditorState = null;\n\n  function LinkComponent(props) {\n\n    const theme = useTheme()\n    const { contentState, entityKey, blockKey, offsetKey, start, end, decoratedText } = props;\n    const { linkType, linkAddress, linkHost } = contentState.getEntity(entityKey).getData()\n\n    if (linkType === \"linkOn\") {\n      return (\n        // <span href={linkAddress} style={{ backgroundColor: \"#FAF\", fontSize: Math.max(fontSize2 * 0.7, 0.7) + \"rem\" }}>\n        //   {props.children}\n        // </span>\n        // <Box component=\"span\" color={theme.palette.primary.light}>{props.children}</Box>\n        <Link>{props.children}</Link>\n      )\n    }\n    else if (linkType === \"linkOff\") {\n\n      return (\n        // <Box component=\"span\" color={theme.palette.primary.light}>{props.children}</Box>\n        <Link>{props.children}</Link>\n      )\n\n      return (\n        <Box component=\"span\" color={theme.palette.primary.light}>\n          {/* <Box component=\"span\" color={theme.palette.primary.light} style={{ display: \"none\" }}>{props.children}</Box> */}\n          <Box component=\"span\" color={theme.palette.primary.light} > {props.children}</Box>\n          {/* {linkHost} */}\n        </Box>\n      )\n    }\n  }\n\n  function linkStrategy(contentBlock, callback, contentState) {\n\n    contentBlock.findEntityRanges(\n      function (character) {\n        const entityKey = character.getEntity();\n        return (\n          entityKey !== null && (\n            contentState.getEntity(entityKey).getType() === \"linkOn\" ||\n            contentState.getEntity(entityKey).getType() === \"linkOff\"\n          )\n        );\n      },\n      callback\n    );\n  }\n\n  function taggingLink() {\n\n    const [anchorKey, anchorOffset, focusKey, focusOffset, isBackward, hasfocus] = externalES.getSelection().toArray();\n    const [anchorStartKey, anchorStartOffset, anchorFocusKey, anchorFocusOffset, isAnchorBackward, isAnchorFocused]\n      = [!isBackward ? anchorKey : focusKey, !isBackward ? anchorOffset : focusOffset, isBackward ? anchorKey : focusKey, isBackward ? anchorOffset : focusOffset,];\n\n\n    const oldSelection = externalES.getSelection();\n    let newContent = externalES.getCurrentContent();\n    let newSelection = externalES.getSelection();\n\n\n\n    externalES.getCurrentContent().getBlocksAsArray().forEach(function (block) {\n      const blockKey = block.getKey();\n      const blockType = block.getType();\n      const blockText = block.getText();\n\n\n      const regx = /\\s([a-zA-Z]{1,10}:\\/\\/)(([a-zA-Z0-9-_]+\\.?)+(:\\d{0,6})?)(\\/[^\\s\\r\\n\\/]+){0,7}(\\/)?/g\n\n      const metaArr = block.getCharacterList();\n      metaArr.forEach(function (item, index) {\n\n        if (item.getEntity()) {\n          const entityType = newContent.getEntity(item.getEntity()).getType()\n\n          if ((entityType === \"linkOn\") || (entityType === \"linkOff\")) {\n            newSelection = externalES.getSelection().merge({\n              anchorKey: blockKey,\n              anchorOffset: index,\n              focusKey: blockKey,\n              focusOffset: index + 1,\n              isBackward: false,\n              hasFocus: false,\n            })\n            newContent = Modifier.applyEntity(newContent, newSelection, null)\n          }\n        }\n        if (item.getStyle()) {\n          const styleArr = item.getStyle().toArray()\n          if (styleArr.includes(\"linkStyle\")) {\n            newSelection = externalES.getSelection().merge({\n              anchorKey: blockKey,\n              anchorOffset: index,\n              focusKey: blockKey,\n              focusOffset: index + 1,\n              isBackward: false,\n              hasFocus: false,\n            })\n          //  newContent = Modifier.removeInlineStyle(newContent, newSelection, \"linkStyle\")\n          }\n        }\n      })\n\n      let matchArr;\n      while ((matchArr = regx.exec(blockText)) !== null) {\n\n        const start = matchArr.index;\n        const end = matchArr.index + matchArr[0].length\n        const contentLenth = end - start;\n        const contentFocusAt = anchorFocusOffset - start;\n        const linkAddress = blockText.substring(start, end);\n        const linkHost = \" \" + matchArr[2];\n\n      \n\n        const linkOn = hasfocus && (blockKey === anchorFocusKey) && (contentFocusAt > 0) && (contentFocusAt <= contentLenth)\n        const linkOff = ((!hasfocus) || (blockKey !== anchorFocusKey) || (contentFocusAt <= 0) || (contentFocusAt - contentLenth > 0))\n\n\n\n\n        if (linkOn) {\n          newContent = newContent.createEntity(\"linkOn\", \"MUTABLE\", { linkType: \"linkOn\", linkAddress, linkHost });\n          const entityKey = newContent.getLastCreatedEntityKey();\n          newSelection = externalES.getSelection().merge({\n            anchorKey: blockKey,\n            anchorOffset: start+1,   //[...blockText][start] === \" \" ? start + 1 : start,\n            focusKey: blockKey,\n            focusOffset: end,\n            isBackward: false,\n            hasFocus: false,\n          })\n          newContent = Modifier.applyEntity(newContent, newSelection, entityKey)\n        }\n        else if (linkOff) {\n          newContent = newContent.createEntity(\"linkOff\", \"MUTABLE\", { linkType: \"linkOff\", linkAddress, linkHost });\n          const entityKey = newContent.getLastCreatedEntityKey();\n          newSelection = externalES.getSelection().merge({\n            anchorKey: blockKey,\n            anchorOffset: start+1,   //[...blockText][start] === \" \" ? start + 1 : start,\n            focusKey: blockKey,\n            focusOffset: end,\n            isBackward: false,\n            hasFocus: false,\n          })\n          newContent = Modifier.applyEntity(newContent, newSelection, entityKey)\n          // newContent = Modifier.applyInlineStyle(newContent, newSelection, \"linkStyle\")\n\n\n\n\n        }\n\n\n\n\n\n      }\n    });\n\n    externalES = EditorState.push(externalES, newContent, \"insert-fragment\");\n    externalES = EditorState.acceptSelection(externalES, oldSelection);\n    return externalES;\n\n\n\n\n\n  };\n\n\n\n\n  return {\n\n    linkPlugin: {\n      onChange(editorState, { setEditorState }) {\n        externalES = editorState\n        externalSetEditorState = setEditorState\n        externalES = taggingLink();\n        return externalES\n      },\n\n      decorators: [\n        {\n          strategy: linkStrategy,\n          component: LinkComponent\n        }\n      ],\n    }\n\n  }\n\n\n}","import { useState, useRef, useEffect, useContext, useCallback, createContext, useMemo } from 'react';\nimport { Context } from \"./ContextProvider\"\n\n\nimport { EditorState, ContentState, ContentBlock, CharacterMetadata, SelectionState, convertToRaw, convertFromRaw, RichUtils, Modifier, convertFromHTML, AtomicBlockUtils } from 'draft-js';\nimport Editor from \"draft-js-plugins-editor\";\nimport Immutable from 'immutable';\n\nimport { makeStyles, styled, useTheme, withStyles } from '@material-ui/core/styles';\nimport { Typography, Button, ButtonGroup, Container, Paper, Avatar, Box, Chip } from \"@material-ui/core\";\nimport { Image, AlternateEmailSharp, DeleteOutlineOutlined, HorizontalSplit, HorizontalSplitOutlined, FormatAlignCenter, FormatAlignRight, PaletteOutlined ,Select  } from \"@material-ui/icons\";\n\n\nimport {\n  isMobile,\n  isFirefox,\n  isChrome,\n  browserName,\n  engineName,\n} from \"react-device-detect\";\n\nexport default function createDeleteBlogPlugin() {\n\n  let externalES = null;\n  let externalSetEditorState = null;\n\n\n  function deleteBlock(editor) {\n\n    let contentState = externalES.getCurrentContent();\n    let selection = externalES.getSelection()\n\n    const currentKey = selection.getEndKey()\n\n    let newContentBlockArr = contentState.getBlocksAsArray()\n\n    const currentBlock = contentState.getBlockForKey(currentKey)\n\n    const currentType = currentBlock.getType()\n\n    if ((currentType !== \"unstyled\") && (currentType !== \"centerBlock\") && (currentType !== \"rightBlock\") && (currentType !== \"colorBlock\")) { return }\n\n    if (newContentBlockArr.length <= 1) {\n      externalES = EditorState.createEmpty()\n      setTimeout(() => {\n        externalSetEditorState(externalES)\n        editor.current.focus()\n      }, 0);\n      return null\n    }\n\n\n\n    newContentBlockArr = newContentBlockArr.filter((item) => {\n      return item.key !== currentKey\n    })\n\n    contentState = ContentState.createFromBlockArray(newContentBlockArr)\n    externalES = EditorState.createWithContent(contentState)\n\n    // setTimeout(() => {\n    externalSetEditorState(externalES)\n    // }, 0);\n    return externalES\n\n  }\n\n  function addTopLine(editor, isTopLine = true) {\n    let contentState = externalES.getCurrentContent();\n    let selection = externalES.getSelection()\n    const selectionBefore = contentState.getSelectionBefore()\n    const selectionAfter = contentState.getSelectionAfter()\n    const currentKey = selection.getEndKey()\n    let newContentBlockArr = contentState.getBlocksAsArray()\n    const currentBlock = contentState.getBlockForKey(currentKey)\n    const currentType = currentBlock.getType()\n\n\n    const key = genKey()\n    newContentBlockArr =\n      isTopLine\n        ? [new ContentBlock({ key, type: \"unstyled\", text: '', }), ...newContentBlockArr]\n        : [...newContentBlockArr, new ContentBlock({ key, type: \"unstyled\", text: '', }),]\n\n    contentState = ContentState.createFromBlockArray(newContentBlockArr)\n\n\n    selection = selection.merge({\n      anchorKey: key,\n      focusKey: key,\n      anchorOffset: 0,\n      focusOffset: 0,\n      isBackward: false,\n      hasFocus: true,\n    })\n\n\n    externalES = EditorState.createWithContent(contentState)\n    //  externalES = EditorState.push(externalES, contentState, 'insert-fragment');\n    externalES = EditorState.acceptSelection(externalES, selection);\n    externalSetEditorState(externalES)\n    setTimeout(() => {\n      editor.current.focus()\n    }, 0);\n    return externalES\n\n\n  }\n\n  function centerBlock(editor, pos = \"centerBlock\") {\n\n    let contentState = externalES.getCurrentContent();\n    let selection = externalES.getSelection()\n\n    const currentKey = selection.getEndKey()\n\n    let newContentBlockArr = contentState.getBlocksAsArray()\n\n    const currentBlock = contentState.getBlockForKey(currentKey)\n\n    const currentType = currentBlock.getType()\n\n    if (currentType !== \"unstyled\" && currentType !== \"centerBlock\" && currentType !== \"rightBlock\") { return }\n\n    contentState = Modifier.setBlockType(contentState, selection, currentType === \"unstyled\" ? pos : currentType === pos ? \"unstyled\" : pos)\n\n        \n\n    externalES = EditorState.push(externalES, contentState, \"change-block-type\");\n    externalES = EditorState.acceptSelection(externalES, selection)\n\n    externalSetEditorState(externalES)\n    setTimeout(() => {\n      editor.current.focus()\n    }, 0);\n\n  }\n\n  function addBackColor(editor){\n\n    let contentState = externalES.getCurrentContent();\n    let selection = externalES.getSelection()\n\n    const currentKey = selection.getEndKey()\n\n    let newContentBlockArr = contentState.getBlocksAsArray()\n\n    const currentBlock = contentState.getBlockForKey(currentKey)\n\n    const currentType = currentBlock.getType()\n\n\n    contentState = Modifier.setBlockType(contentState, selection, \"colorBlock\" )\n\n    externalES = EditorState.push(externalES, contentState, \"change-block-type\");\n    externalES = EditorState.acceptSelection(externalES, selection)\n\n    externalSetEditorState(externalES)\n    setTimeout(() => {\n      editor.current.focus()\n    }, 0);\n\n\n  }\n\n\n\n  function DeleteBlogButton({ editor, ...props }) {\n\n    const theme = useTheme()\n    return (\n\n      <Button {...props}\n\n        style={{\n\n          color: theme.palette.type === \"light\"\n            ? theme.palette.primary.main\n            : theme.palette.text.secondary\n        }}\n        onClick={function () {\n          deleteBlock(editor)\n          // topImage(editor)\n        }}\n\n      >\n        <DeleteOutlineOutlined />\n      </Button>\n\n    )\n  }\n\n  function AddTopLineButton({ editor, ...props }) {\n\n    const theme = useTheme()\n    return <Button {...props}\n\n      style={{\n        color: theme.palette.type === \"light\"\n          ? theme.palette.primary.main\n          : theme.palette.text.secondary\n      }}\n      onClick={function () {\n        addTopLine(editor)\n      }}\n\n    >\n      <HorizontalSplitOutlined style={{ transform: \"rotate(180deg)\" }} />\n    </Button>\n  }\n\n  function AddBottomLineButton({ editor, ...props }) {\n\n    const theme = useTheme()\n    return <Button {...props}\n\n      style={{\n        color: theme.palette.type === \"light\"\n          ? theme.palette.primary.main\n          : theme.palette.text.secondary\n      }}\n      onClick={function () {\n        addTopLine(editor, false)\n      }}\n\n    >\n      <HorizontalSplitOutlined />\n    </Button>\n  }\n\n  function AlignCenterButton({ editor, isCenterOn, setIsCenterOn, ...props }) {\n\n\n    const theme = useTheme()\n    return <Button {...props}\n\n      style={{\n        backgroundColor: isCenterOn ? theme.palette.primary.main : \"\",// theme.palette.background.default,\n        color: theme.palette.type === \"light\"\n          ? isCenterOn\n            ? theme.palette.primary.contrastText\n            : theme.palette.primary.main\n          : isCenterOn\n            ? theme.palette.primary.contrastText\n            : theme.palette.text.secondary\n      }}\n      onClick={function () {\n        centerBlock(editor, \"centerBlock\")\n      }}\n\n    >\n      <FormatAlignCenter />\n    </Button>\n  }\n\n  function AlignRightButton({ editor, isRightOn, setIsRightOn, ...props }) {\n\n\n    const theme = useTheme()\n    return <Button {...props}\n\n      style={{\n        backgroundColor: isRightOn ? theme.palette.primary.main : \"\",// theme.palette.background.default,\n        color: theme.palette.type === \"light\"\n          ? isRightOn\n            ? theme.palette.primary.contrastText\n            : theme.palette.primary.main\n          : isRightOn\n            ? theme.palette.primary.contrastText\n            : theme.palette.text.secondary\n      }}\n      onClick={function () {\n        centerBlock(editor, \"rightBlock\")\n      }}\n\n    >\n      <FormatAlignRight />\n    </Button>\n  }\n\n  function AddBackColorButton({editor,...props}){\n\n    const theme = useTheme()\n    return <Button {...props}\n      style={{\n        color: theme.palette.type === \"light\"\n          ? theme.palette.primary.main\n          : theme.palette.text.secondary\n      }}\n      onClick={function () {\n        addBackColor(editor, false)\n      }}\n    >\n      <PaletteOutlined />\n    </Button>\n\n  }\n\n\n  function BackColorPanel({...props}){\n\n\n    return(\n      <>\nddd\n      </>\n    )\n  }\n\n\n\n\n\n\n  return {\n\n    DeleteBlogButton,\n    AddTopLineButton,\n    AddBottomLineButton,\n    AlignCenterButton,\n    AlignRightButton,\n    AddBackColorButton,\n    BackColorPanel,\n\n    deleteBlogPlugin: {\n      onChange: function (editorState, { setEditorState }) {\n        externalES = editorState\n        externalSetEditorState = setEditorState\n\n        return externalES\n\n      },\n    }\n\n  }\n\n\n}\n\n\n\n\nfunction genKey(length = 4) {\n\n  var result = '';\n  var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  var charactersLength = characters.length;\n  for (var i = 0; i < length; i++) {\n    result += characters.charAt(Math.floor(Math.random() * charactersLength));\n  }\n  return result;\n}","import { useState, useRef, useEffect, useContext, useCallback, createContext, useMemo } from 'react';\n\n\n\nimport { EditorState, ContentState, ContentBlock, CharacterMetadata, SelectionState, convertToRaw, convertFromRaw, RichUtils, Modifier, convertFromHTML, AtomicBlockUtils } from 'draft-js';\nimport Editor from \"draft-js-plugins-editor\";\nimport Immutable from 'immutable';\n\nimport { makeStyles, styled, useTheme, withStyles } from '@material-ui/core/styles';\nimport { Typography, Button, ButtonGroup, Container, Paper, Avatar, Box, Chip } from \"@material-ui/core\";\nimport { Image, AlternateEmailSharp, DeleteOutlineOutlined, HorizontalSplit, HorizontalSplitOutlined, FormatAlignCenter, FormatAlignRight, PaletteOutlined, Select } from \"@material-ui/icons\";\n\nimport {\n  isMobile,\n  isFirefox,\n  isChrome,\n  browserName,\n  engineName,\n} from \"react-device-detect\";\n\nexport default function createBackColorPlugin() {\n\n  let externalES = null;\n  let externalSetEditorState = null;\n  let isColorBlockOn = false;\n\n  function addBackColor(editor, imgUrl, textColor) {\n\n    let contentState = externalES.getCurrentContent();\n    let selection = externalES.getSelection()\n\n    const currentKey = selection.getEndKey()\n\n    let newContentBlockArr = contentState.getBlocksAsArray()\n\n    const currentBlock = contentState.getBlockForKey(currentKey)\n\n    const currentType = currentBlock.getType()\n\n    // if (currentType !== \"unstyled\" && currentType !== \"centerBlock\" && currentType !== \"rightBlock\") { return }\n\n\n    contentState = Modifier.setBlockType(contentState, selection, currentType === \"colorBlock\" ? \"colorBlock\" : \"colorBlock\")\n    contentState = Modifier.setBlockData(contentState, selection, {img:imgUrl,textColor})\n    externalES = EditorState.push(externalES, contentState, \"change-block-type\");\n    externalES = EditorState.acceptSelection(externalES, selection)\n\n    externalSetEditorState(externalES)\n    setTimeout(() => {\n      editor.current.focus()\n    }, 0);\n\n\n  }\n\n\n\n\n\n  function AddBackColorButton({ editor, isBackColorPanelOn, setIsBackColorPanelOn, ...props }) {\n\n    const theme = useTheme()\n    return <Button {...props}\n\n      style={{\n\n        backgroundColor: isBackColorPanelOn ? theme.palette.primary.main : \"\",// theme.palette.background.default,\n\n\n        color: theme.palette.type === \"light\"\n          ? isBackColorPanelOn\n            ? theme.palette.primary.contrastText\n            : theme.palette.primary.main\n          : isBackColorPanelOn\n            ? theme.palette.primary.contrastText\n            : theme.palette.text.secondary\n\n\n      }}\n\n\n\n\n      onClick={function () {\n        // addBackColor(editor, false)\n\n        setIsBackColorPanelOn(pre => !pre)\n      }}\n    >\n      <PaletteOutlined />\n    </Button>\n\n  }\n\n\n  function BackColorPanel({ editor, isBackColorPanelOn, backImageArr, setBackImageArr, backImageIndex, setBackImageIndex, ...props }) {\n\n    const theme = useTheme()\n  \n\n\n    return (\n      <Box\n        style={{\n          maxWidth: \"100%\",\n          overflow: \"auto\",\n          // marginBottom: \"10px\",\n          marginTop: isBackColorPanelOn ? \"10px\" : 0,\n          //  height: isEmojiPanelOn ? \"auto\" : 0,\n          maxHeight: isBackColorPanelOn ? \"35vh\" : 0,\n\n          transitionProperty: \"height,max-height, opacity\",\n          transitionDuration: \"0.2s\",\n          opacity: isBackColorPanelOn ? 1 : 0,\n          // marginBottom: isEmojiPanelOn ? theme.spacing(2) : 0\n          marginBottom: theme.spacing(2),\n\n          display: \"flex\",\n          justifyContent: \"space-between\",\n          flexWrap:\"wrap\",\n        }}>\n\n\n        {theme.backgourndImageArr.map((img, index) => {\n          return (\n            <Button\n              key={index}\n              style={{\n                backgroundImage: img.backgroundImage,\n                backgroundSize: \"contain\",\n                width: \"80px\",\n                height: \"45px\",\n              }}\n              onClick={function () {\n              //  alert( img.backgroundImage)\n                addBackColor(editor,  img.backgroundImage, img.color||\"white\")\n              }}\n            />\n          )\n\n        })}\n\n        {/* <Button style={{\n          backgroundImage: \"url(https://mernchen.herokuapp.com/api/picture/download/60b7028076fa440017fb5779)\",\n          backgroundSize: \"contain\",\n          width: \"80px\",\n          height: \"45px\",\n        }}>{' '}</Button>\n\n        <Button style={{\n          backgroundImage: \"url(https://mernchen.herokuapp.com/api/picture/download/60b6f77fae1acf0017a96c4b)\",\n          backgroundSize: \"contain\",\n          width: \"80px\",\n          height: \"45px\",\n        }}>{' '}</Button>\n\n        <Button style={{\n          backgroundImage: \"url(https://mernchen.herokuapp.com/api/picture/download/60b701a9dc07780017dcfd38)\",\n          backgroundSize: \"contain\",\n          width: \"80px\",\n          height: \"45px\",\n        }}>{' '}</Button> */}\n\n\n      </Box>\n    )\n  }\n\n\n\n\n\n\n  return {\n\n\n    AddBackColorButton,\n    BackColorPanel,\n\n    backColorPlugin: {\n\n      blockStyleFn:function (block) {\n\n      },\n\n\n\n      onChange: function (editorState, { setEditorState }) {\n        externalES = editorState\n        externalSetEditorState = setEditorState\n        return externalES\n\n      },\n\n      //  keyBindingFn(e, { getEditorState, setEditorState, ...obj }) {\n\n\n\n      // if ((e.keyCode === 13)&&(isColorBlockOn)) {\n      //   return \"fire-enterX\";\n\n      // }\n\n\n      // },\n\n\n      // handleReturn(e,editorState,...props){\n      //   console.log(props)\n      // },\n\n\n      // handleKeyCommand(command, editorState, evenTimeStamp, { setEditorState }) {\n\n\n      //  if (command === \"fire-enterX\") {\n\n\n\n\n      //   externalES = RichUtils.insertSoftNewline(externalES)\n      //   setEditorState(externalES)\n      //    return \"handled\"\n      //  }\n\n\n      //  return 'not-handled';\n      // },\n\n\n    }\n\n  }\n\n\n}\n\n\n\n\nfunction genKey(length = 4) {\n\n  var result = '';\n  var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  var charactersLength = characters.length;\n  for (var i = 0; i < length; i++) {\n    result += characters.charAt(Math.floor(Math.random() * charactersLength));\n  }\n  return result;\n}","import { useState, useRef, useEffect, useContext, useCallback, createContext, useMemo } from 'react';\r\nimport { Context } from \"./ContextProvider\"\r\n\r\n\r\nimport { EditorState, ContentState, ContentBlock, CharacterMetadata, SelectionState, convertToRaw, convertFromRaw, RichUtils, Modifier, convertFromHTML, AtomicBlockUtils } from 'draft-js';\r\nimport Editor from \"draft-js-plugins-editor\";\r\nimport Immutable from 'immutable';\r\n\r\nimport chainable from 'draft-js-plugins-chainable';\r\n\r\n//import axios from 'axios';\r\nimport url, { axios } from './config';\r\n\r\nimport createImagePlugin from './ImagePlugin';\r\nimport createBoldPlugin from './BoldPlugin';\r\nimport createEmojiPlugin from './EmojiPlugin';\r\nimport createMentionPlugin from './MentionPlugin';\r\nimport createLinkPlugin from './LinkPlugin';\r\nimport createDeleteBlogPlugin from './DeleteBlogPlugin';\r\nimport createBackColorPlugin from './BackColorPlugin';\r\n\r\nimport { stateToHTML } from 'draft-js-export-html';\r\nimport ReactHtmlParser, { processNodes, convertNodeToElement, htmlparser2, } from 'react-html-parser';\r\nimport { makeStyles, styled, useTheme } from '@material-ui/core/styles';\r\n\r\nimport { Typography, Button, ButtonGroup, Container, Paper, Box, Avatar, Grid } from \"@material-ui/core\";\r\nimport { Image, Brightness4, Brightness5, FormatBold, FormatItalic, FormatUnderlined, InsertEmoticon, PaletteOutlined } from \"@material-ui/icons\";\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\r\n\r\nimport {\r\n  isMobile,\r\n  isFirefox,\r\n  isChrome,\r\n  browserName,\r\n  engineName,\r\n} from \"react-device-detect\";\r\n\r\n\r\n//import yellow from '@material-ui/core/colors/yellow';\r\n\r\n\r\n\r\nconst { boldPlugin, BoldButton, ItalicButton, UnderlineButton, LargeButton, SmallButton, } = createBoldPlugin()\r\nconst { emojiPlugin, EmojiButton, EmojiPanel } = createEmojiPlugin()\r\nconst { imagePlugin, ImageButton, TopImageButton, ImageBlog, hasImageBlock } = createImagePlugin()\r\nconst { mentionPlugin, MentionButton, MentionPanel, } = createMentionPlugin()\r\nconst { linkPlugin } = createLinkPlugin()\r\nconst { deleteBlogPlugin, DeleteBlogButton, AddTopLineButton, AddBottomLineButton, AlignCenterButton, AlignRightButton, } = createDeleteBlogPlugin()\r\nconst { backColorPlugin, AddBackColorButton, BackColorPanel } = createBackColorPlugin()\r\n\r\n\r\n\r\n\r\nexport const useStyles = makeStyles(theme => {\r\n\r\n  // console.log(theme.backgourndImageArr)\r\n  const obj = {}\r\n\r\n  theme.backgourndImageArr.forEach((element, index) => {\r\n    obj[\"css\" + index] = element\r\n  });\r\n\r\n\r\n  console.log(obj)\r\n  //const obj = { css1: { ...theme.backgourndImageArr[0] }, css2: { ...theme.backgourndImageArr[0] } }\r\n\r\n\r\n  return {\r\n    ...obj,\r\n\r\n\r\n    editorPaperCss: ({ isLight, breakpointsAttribute, isEditorFocusOn }) => {\r\n      // console.log(isLight)\r\n      return {\r\n        // backgroundColor:\"pink\",\r\n        borderWidth: \"1px\", borderStyle: \"none\",// borderRadius: \"25px\",\r\n        borderColor: isEditorFocusOn ? theme.palette.primary.main : theme.palette.text.secondary,\r\n        //overflow:\"hidden\",\r\n        //  paddingLeft: theme.spacing(1),\r\n        //  paddingRight: theme.spacing(1),\r\n        // wordBreak: \"break-all\",\r\n\r\n        wordBreak: \"break-all\",\r\n        whiteSpace: \"pre-wrap\",\r\n        lineBreak: \"anywhere\",\r\n        //  width:\"100%\"\r\n        // minHeight: \"20vh\",\r\n        //theme.typography.fontSize * 10 + \"px\",\r\n\r\n        //whiteSpace: \"pre-line\",\r\n        //...breakpointsAttribute([\"width\", \"100%\", \"100%\", \"75%\", \"75%\", \"75%\"])\r\n      }\r\n    },\r\n\r\n    unstyledBlockCss: () => {\r\n      return {\r\n\r\n        paddingLeft: theme.spacing(1),\r\n        paddingRight: theme.spacing(1),\r\n      }\r\n    },\r\n    imageBlockCss: () => {\r\n      return {\r\n        margin: 0,\r\n        padding: 0,\r\n        //   position: \"relative\",\r\n        width: \"100%\",\r\n        height: 0,\r\n        paddingBottom: \"56.25%\",\r\n      }\r\n    },\r\n    centerBlockCss: () => {\r\n      return {\r\n        // display: \"flex\",\r\n        // justifyContent: \"center\",\r\n        paddingLeft: theme.spacing(1),\r\n        paddingRight: theme.spacing(1),\r\n        textAlign: \"center\",\r\n      }\r\n\r\n    },\r\n    rightBlockCss: () => {\r\n      return {\r\n        paddingLeft: theme.spacing(1),\r\n        paddingRight: theme.spacing(1),\r\n        textAlign: \"end\",\r\n\r\n      }\r\n    },\r\n\r\n\r\n\r\n\r\n    colorBlockCss: () => {\r\n      // console.log(backImageArr, backImageIndex)\r\n      // if (!backImageArr) { return {} }\r\n      return {\r\n        position: \"relative\",\r\n        display: \"flex\",\r\n        backgroundColor: \"wheat\",\r\n        // width:\"100%\",\r\n        height: 0,\r\n        paddingBottom: \"56.25%\",\r\n        alignItems: \"center\",\r\n        justifyContent: \"center\",\r\n\r\n        overflow: \"auto\",\r\n        // overflow: \"hidden\",\r\n\r\n        // backgroundImage: \"url(https://mernchen.herokuapp.com/api/picture/download/60a204e70270cc001728285f)\",\r\n        // backgroundImage: \"url(https://mernchen.herokuapp.com/api/picture/download/60a2062e95f2250017420aa4)\",\r\n        //  backgroundImage: \"url(https://mernchen.herokuapp.com/api/picture/download/60b701a9dc07780017dcfd38)\",\r\n        //    backgroundImage: backImageArr[backImageIndex],\r\n\r\n        //  backgroundImage: \"url(https://mernchen.herokuapp.com/api/picture/download/60b6f77fae1acf0017a96c4b)\",\r\n        //  backgroundImage: \"url(https://picsum.photos/800/450)\",\r\n        backgroundSize: \"contain\",\r\n        //color:\"white\",\r\n        // aspectRatio: \"16 / 9\",\r\n\r\n        \"& > div\": {\r\n          textAlign: \"center\",\r\n          position: \"absolute\",\r\n          top: \"50%\",\r\n          transform: \"translateY(-50%)\",\r\n          // color: \"pink\",\r\n\r\n        }\r\n\r\n\r\n\r\n\r\n      }\r\n\r\n\r\n    },\r\n\r\n    className1: props => {\r\n\r\n      return {\r\n        background: 'linear-gradient(45deg, #FE6B8B 30%, #FF8E53 90%)',\r\n        // fontSize:200,\r\n        '&:hover': { background: 'linear-gradient(45deg, #FE6B8B 30%, #FF8E53 90%)', },\r\n      }\r\n    },\r\n\r\n\r\n\r\n  }\r\n})\r\n\r\n\r\nconst initialState = {\r\n  entityMap: {\r\n    // \"0\": {\r\n    //     type: \"image\",\r\n    //     mutability: \"IMMUTABLE\",\r\n    //     data: {\r\n    //         src:\r\n    //             \"https://www.draft-js-plugins.com/images/canada-landscape-small.jpg\"\r\n    //     }\r\n    // }\r\n  },\r\n  blocks: [\r\n    // {\r\n    //   key: \"1111\",\r\n    //   text: \"ewijveoij http://weibo.com/aas vvv @mmm fdsfd  \\n \\n \\n \\n \\n dsd\",//`  @aaa @的就是dds http://asd.com `,//  \\uD83D\\uDE47\\u200D\\u2640\\uFE0F   `,   //  \\uD83D\\uDE33`,\r\n    //   type: \"unstyled\",\r\n    //   // type:\"unstyled\",\r\n    //   depth: 0,\r\n    //   inlineStyleRanges: [\r\n    //     //    {\r\n    //     //         offset: 4,\r\n    //     //         length: 10,\r\n    //     //         style: \"HIGHLIGHT\"\r\n    //     //    },\r\n    //   ],\r\n    //   entityRanges: [],\r\n    //   data: {}\r\n    // },\r\n\r\n\r\n\r\n    // {\r\n    //   key: \"2222\",\r\n    //   text: `  @aaa @的就是dds http://asd.com `,//  \\uD83D\\uDE47\\u200D\\u2640\\uFE0F   `,   //  \\uD83D\\uDE33`,\r\n    //   type: \"unstyled\",\r\n    //   depth: 0,\r\n\r\n    //   // data: {\r\n    //   //   imgUrl: \"https://source.unsplash.com/random/800x800\",//\"blob:http://localhost:3000/3d815879-af57-4950-a82c-a6301402fa99\",\r\n    //   //   imgId: \"\",\r\n    //   //   imgArr: [\"https://source.unsplash.com/random/1300x400\", \"https://mernchen.herokuapp.com/api/picture/download/5f197ef0452cc60017f9f488\", \"https://source.unsplash.com/random/800x751\", \"https://source.unsplash.com/random/100x252\"]\r\n    //   // }\r\n    // },\r\n\r\n\r\n  ]\r\n};\r\n\r\nexport default function DraftEditor() {\r\n\r\n  const {\r\n\r\n    token,\r\n    isLight, setIsLight, breakpointsAttribute,\r\n    editorContent,\r\n    setEditorContent,\r\n    lgSizeObj, smSizeObj, deviceSize,\r\n    picArr, setPicArr,\r\n    postArr, setPostArr,\r\n    postPicArr, setPostPicArr,\r\n    // backImageArr, setBackImageArr,\r\n    // backImageIndex, setBackImageIndex,\r\n  } = useContext(Context)\r\n  const theme = useTheme()\r\n\r\n  // const [picArr,setPicArr] = useState([])\r\n\r\n  const [isBoldOn, setIsBoldOn] = useState(false)\r\n  const [isItalicOn, setIsItalicOn] = useState(false)\r\n  const [isUnderlineOn, setIsUnderlineOn] = useState(false)\r\n  const [isLargeOn, setIsLargeOn] = useState(false)\r\n  const [isSmallOn, setIsSmallOn] = useState(false)\r\n\r\n\r\n  const [isEmojiPanelOn, setIsEmojiPanelOn] = useState(false)\r\n  const [isMentionPanelOn, setIsMentionPanelOn] = useState(false)\r\n  const [isBackColorPanelOn, setIsBackColorPanelOn] = useState(false)\r\n\r\n  const [isCenterOn, setIsCenterOn] = useState(false)\r\n  const [isRightOn, setIsRightOn] = useState(false)\r\n\r\n\r\n  const [isEditorFocusOn, setIsEditorFocusOn] = useState(false)\r\n\r\n  //const [picArr, setPicArr] = useState([])\r\n\r\n  const editor = useRef()\r\n  const { editorPaperCss, className1, unstyledBlockCss, imageBlockCss, centerBlockCss, rightBlockCss, colorBlockCss, ...restCss } = useStyles({ isLight, isEditorFocusOn, breakpointsAttribute })\r\n\r\n  //console.log(backImageCssArr)\r\n  //const [editorState, setEditorState] = useState(EditorState.createEmpty())\r\n  //const [editorState, setEditorState] = useState(EditorState.createWithContent(ContentState.createFromText('some')))\r\n  const [editorState, setEditorState] = useState(EditorState.createWithContent(convertFromRaw(initialState)))\r\n\r\n\r\n  const [enablePost, setEnablePost] = useState(true)\r\n\r\n\r\n\r\n\r\n  useEffect(function () {\r\n    setTimeout(() => {\r\n      editor.current.focus()\r\n      EditorState.moveFocusToEnd(editorState)\r\n    }, 0);\r\n  }, [])\r\n\r\n\r\n  function toPreHtml(editorContent, postID = \"local\") {\r\n\r\n\r\n    const preHtml = stateToHTML(\r\n      editorContent.getCurrentContent(),\r\n      {\r\n        defaultBlockTag: \"div\",\r\n\r\n        inlineStyles: {\r\n          LARGE: { style: { fontSize: lgSizeObj[deviceSize] }, },\r\n          //   LARGE: { style: { fontSize:\"3.5rem\" }},\r\n          SMALL: { style: { fontSize: smSizeObj[deviceSize] }, },\r\n          //   linkStyle: { style: { fontSize: 0 } }\r\n          //  LARGE: { attributes: { class: \"largeText\" } },\r\n\r\n        },\r\n\r\n\r\n        blockStyleFn: function (block) {\r\n          const type = block.getType()\r\n          // console.log(type)\r\n\r\n          if (type === \"unstyled\") {\r\n            return {\r\n              attributes: {\r\n                //className: unstyledBlockCss,\r\n\r\n              },\r\n              style: {\r\n                paddingLeft: \"4px\",\r\n                paddingRight: \"4px\",\r\n              }\r\n            }\r\n          }\r\n          if (type === \"centerBlock\") {\r\n            return {\r\n              attributes: {\r\n                //      className: centerBlockCss, // may loose when state update \r\n\r\n              },\r\n              style: {\r\n\r\n                paddingLeft: \"4px\",\r\n                paddingRight: \"4px\",\r\n                textAlign: \"center\",\r\n              }\r\n            }\r\n          }\r\n          if (type === \"rightBlock\") {\r\n            return {\r\n              attributes: {\r\n                //   className: rightBlockCss,// may loose when state update \r\n              },\r\n              style: {\r\n                paddingLeft: \"4px\",\r\n                paddingRight: \"4px\",\r\n                textAlign: \"end\",\r\n              }\r\n\r\n            }\r\n          }\r\n          if (type === \"imageBlock\") {\r\n\r\n          }\r\n          if (type === \"colorBlock\") {\r\n\r\n            return {\r\n              attributes: {\r\n\r\n                colorblock: \"true\",\r\n                backimage: block.getData().toJS().img,\r\n                textcolor: block.getData().toJS().textColor,\r\n              },\r\n              // style: {\r\n              //   backgroundImage: block.getData().toJS().img,//\"url(https://mernchen.herokuapp.com/api/picture/download/60a204e70270cc001728285f)\",\r\n              //   color:block.getData().toJS().textColor,\r\n              // },\r\n            }\r\n          }\r\n        },\r\n\r\n        blockRenderers: {\r\n          imageBlock: function (block) {\r\n            const text = block.getText()\r\n            const data = block.getData().toObject()\r\n            const type = block.getType()\r\n\r\n            //  return `<img src=${data.imgUrl} style=max-width:300px;display:block;margin-left:auto;margin-right:auto;/>`\r\n            //  return `<imgtag id=${data.imgId} style=max-width:100%;display:block;margin-left:auto;margin-right:auto;/>`\r\n            return `<imgtag id=\"${postID}\">` + escape(block.getText()) + '</imgtag>'\r\n            // return `<div>ffd</div>`\r\n            // return '<imgtag />'\r\n          },\r\n          // colorBlock: function (block) {\r\n          //   return `<colorBlock>` + (block.getText()) + `</colorBlock>`\r\n          // },\r\n        },\r\n\r\n        entityStyleFn: function (entity) {\r\n          const { type, data, mutablity } = entity.toObject()\r\n          if (type === \"shortMentionOff\") {\r\n            return {\r\n              element: \"shortMentionoff\",\r\n            }\r\n          }\r\n          if (type === \"longMentionOff_HEAD\") {\r\n\r\n            return {\r\n\r\n              element: \"longmentionoff_head\",\r\n              attributes: {\r\n                imgurl: data.imgurl,\r\n                person: data.person,\r\n              },\r\n              style: {}\r\n            }\r\n          }\r\n          if (type === \"longMentionOff_BODY\") {\r\n\r\n            return {\r\n\r\n              element: \"longmentionoff_body\",\r\n              attributes: {\r\n                imgurl: data.imgurl,\r\n                person: data.person,\r\n              },\r\n\r\n            }\r\n\r\n          }\r\n          if (type === \"EMOJI\") {\r\n            console.log(data.url)\r\n\r\n            return {\r\n              element: \"emoji\",\r\n              attributes: {\r\n                imgurl: data.url,\r\n                symbol: data.symbol\r\n              }\r\n            }\r\n          }\r\n          // if (type === \"linkOn\") {\r\n          //   const {linkType,linkAddress,linkHost} = data\r\n          // }\r\n          if (type === \"linkOff\") {\r\n            // alert(\"xxx\")\r\n            const { linkType, linkAddress, linkHost } = data\r\n            return {\r\n              element: \"linkoff\",\r\n              attributes: {\r\n                ...data\r\n              }\r\n            }\r\n          }\r\n\r\n        },\r\n\r\n      }\r\n    )\r\n    return preHtml\r\n  }\r\n\r\n\r\n  return (\r\n\r\n    <Container disableGutters={false}>\r\n\r\n      {/* <Avatar />lorem jkdlks */}\r\n      {/* <Avatar src={\"https://i.pravatar.cc/300\"} /> */}\r\n      {/* <Typography gutterBottom variant=\"body2\" color=\"textSecondary\" noWrap align=\"right\">lorem jdlks djlsfjlkj lkjfljeoiw lkj fdsoij dfslk  jlkfdj jkdjf  fjdkj  kjdlsjd  jeiwohj hdflshjl ljoisdo</Typography> */}\r\n\r\n\r\n      <Box style={{\r\n        marginBottom: \"5px\",\r\n\r\n        display: \"flex\", alignItems: \"center\", justifyContent: \"flex-start\", flexWrap: isMobile ? \"wrap\" : \"wrap\",\r\n\r\n        gap: theme.spacing(1),\r\n        //   width: \"100%\",\r\n      }}>\r\n        <Paper\r\n          //    elevation\r\n          style={{\r\n\r\n            ...(isMobile && !isFirefox) && { marginRight: theme.spacing(1) },\r\n            display: \"flex\", alignItems: \"center\", justifyContent: \"flex-start\", flexWrap: \"wrap\",\r\n            gap: theme.spacing(1),\r\n            width: \"fit-content\",\r\n          }}>\r\n          <ButtonGroup variant=\"text\" style={{}}>\r\n\r\n            <BoldButton editor={editor} isBoldOn={isBoldOn} setIsBoldOn={setIsBoldOn} />\r\n            <ItalicButton editor={editor} isItalicOn={isItalicOn} setIsItalicOn={setIsItalicOn} />\r\n            <UnderlineButton editor={editor} isUnderlineOn={isUnderlineOn} setIsUnderlineOn={setIsUnderlineOn} />\r\n\r\n            <LargeButton editor={editor} isLargeOn={isLargeOn} setIsLargeOn={setIsLargeOn} />\r\n            <SmallButton editor={editor} isSmallOn={isSmallOn} setIsSmallOn={setIsSmallOn} />\r\n\r\n            {/* <CenterButton editor={editor} isCenterOn={isCenterOn} setIsCenterOn={setIsCenterOn} /> */}\r\n\r\n          </ButtonGroup>\r\n        </Paper>\r\n        <Paper\r\n          style={{\r\n\r\n            display: \"flex\", alignItems: \"center\", justifyContent: \"flex-start\", flexWrap: \"wrap\",\r\n            gap: theme.spacing(1),\r\n            width: \"fit-content\",\r\n          }}>\r\n          <ButtonGroup variant=\"text\" style={{}}>\r\n\r\n            {!isMobile && <EmojiButton color=\"primary\" fontSize=\"small\" isEmojiPanelOn={isEmojiPanelOn} setIsEmojiPanelOn={setIsEmojiPanelOn} />}\r\n\r\n            <MentionButton color=\"primary\" fontSize=\"small\" isMentionPanelOn={isMentionPanelOn} setIsMentionPanelOn={setIsMentionPanelOn} />\r\n\r\n            <ImageButton color=\"primary\" fontSize=\"small\" picArr={picArr} setPicArr={setPicArr} editor={editor} />\r\n            <AddBackColorButton editor={editor} color=\"primary\" fontSize=\"small\" isBackColorPanelOn={isBackColorPanelOn} setIsBackColorPanelOn={setIsBackColorPanelOn} />\r\n\r\n            <Button\r\n              onClick={function () { setIsLight(pre => !pre); editor.current.focus() }}\r\n              style={{ color: theme.palette.type === \"dark\" ? theme.palette.text.secondary : theme.palette.primary.main }}\r\n            >\r\n              {isLight ? <Brightness5 /> : <Brightness4 />}\r\n            </Button>\r\n\r\n\r\n            {/* <TopImageButton color=\"primary\" fontSize=\"small\"  editor={editor} />  */}\r\n          </ButtonGroup>\r\n        </Paper>\r\n        <Paper\r\n          style={{\r\n\r\n            display: \"flex\", alignItems: \"center\", justifyContent: \"flex-start\", flexWrap: \"wrap\",\r\n            gap: theme.spacing(1),\r\n            width: \"fit-content\",\r\n          }}>\r\n          <ButtonGroup variant=\"text\" style={{}}>\r\n            <AddTopLineButton editor={editor} />\r\n            <DeleteBlogButton editor={editor} />\r\n            <AddBottomLineButton editor={editor} />\r\n            <AlignCenterButton editor={editor} isCenterOn={isCenterOn} setIsCenterOn={setIsCenterOn} />\r\n            <AlignRightButton editor={editor} isRightOn={isRightOn} setIsRightOn={setIsRightOn} />\r\n\r\n          </ButtonGroup>\r\n        </Paper>\r\n\r\n      </Box>\r\n\r\n\r\n      <Paper\r\n\r\n        elevation={isEditorFocusOn ? 5 : 1}\r\n        //  className={editorPaperClass}\r\n        classes={{ root: editorPaperCss }}\r\n        style={{\r\n          ...!isMobile && { minHeight: \"3rem\" },\r\n          // backgroundColor: \"pink\"\r\n          // backgroundImage\r\n          // minHeight: \"20vh\",\r\n          // backgroundImage:\"url(https://source.unsplash.com/random/800x800)\",\r\n          // opacity:0.3\r\n         \r\n          // overflow:\"hidden\",\r\n        }}\r\n        onClick={function () {\r\n\r\n          let editorState_ = EditorState.moveSelectionToEnd(editorState);\r\n\r\n          setEditorState(EditorState.forceSelection(editorState_, editorState.getSelection()));\r\n          setIsEditorFocusOn(true)\r\n        }}\r\n      >\r\n\r\n        <Editor\r\n          ref={function (element) { editor.current = element; }}\r\n          editorState={editorState}\r\n\r\n\r\n          onChange={function (newState, { ...props }) {\r\n\r\n\r\n            const { BOLD, ITALIC, UNDERLINE, LARGE, SMALL } = newState.getCurrentInlineStyle().toObject()\r\n            const selection = newState.getSelection()\r\n            const contentState = newState.getCurrentContent()\r\n            const currentKey = selection.getFocusKey()\r\n            const currentBlock = contentState.getBlockForKey(currentKey)\r\n            const currentType = currentBlock.getType()\r\n\r\n            setIsCenterOn(currentType === \"centerBlock\")\r\n            setIsRightOn(currentType === \"rightBlock\")\r\n            //  setIsBackColorPanelOn(currentType === \"colorBlock\")\r\n\r\n            setIsEditorFocusOn(selection.hasFocus)\r\n\r\n            setIsBoldOn(Boolean(BOLD))\r\n            setIsItalicOn(Boolean(ITALIC))\r\n            setIsUnderlineOn(Boolean(UNDERLINE))\r\n            setIsLargeOn(Boolean(LARGE))\r\n            setIsSmallOn(Boolean(SMALL))\r\n\r\n            setEditorContent(newState)\r\n            setEditorState(newState)\r\n\r\n          }}\r\n\r\n          plugins={//chainable(\r\n            [\r\n              //    focusPlugin,\r\n              boldPlugin,\r\n              imagePlugin,\r\n              emojiPlugin,\r\n              mentionPlugin,\r\n              linkPlugin,\r\n              deleteBlogPlugin,\r\n              backColorPlugin,\r\n            ]\r\n            // )\r\n          }\r\n\r\n\r\n          // placeholder=\"hihihi\"\r\n          preserveSelectionOnBlur={true}\r\n\r\n          customStyleMap={\r\n            Immutable.Map({\r\n              // stylename1_: {\r\n              //   color: \"rgba(200,0,0,1)\",\r\n\r\n            })\r\n          }\r\n\r\n          customStyleFn={function (style, block) {\r\n\r\n            const styleNames = style.toObject();\r\n\r\n            if (styleNames.LARGE && styleNames.SMALL) {\r\n\r\n            }\r\n            else if (Boolean(styleNames.LARGE)) {\r\n              return {\r\n                //color: \"red\",  // display:\"flex\",   // justifyContent:\"center\",\r\n                fontSize: lgSizeObj[deviceSize],\r\n              }\r\n            }\r\n            else if (Boolean(styleNames.SMALL)) {\r\n              return {\r\n                //color: \"blue\", \r\n                fontSize: smSizeObj[deviceSize]\r\n              }\r\n            }\r\n            else if (Boolean(styleNames.CENTER)) {\r\n\r\n              return {\r\n                display: \"flex\",\r\n                justifyContent: \"center\",\r\n              }\r\n            }\r\n            else {\r\n\r\n            }\r\n          }}\r\n\r\n          blockRenderMap={\r\n            Immutable.Map({\r\n              // 'unstyled': { \r\n              //   element: 'h3',\r\n              //   wrapper: <Typography variant='body2'/>,\r\n              //  }\r\n\r\n              // \"colorBlock\": {\r\n              //   style: \"backgournd-color:red\"\r\n              // }\r\n            })\r\n          }\r\n\r\n\r\n\r\n          blockStyleFn={function (block) {\r\n            const type = block.getType()\r\n            const text = block.getText()\r\n\r\n            //    const {colorBlockCss0} = useStyles(data.img)\r\n\r\n            // console.log(colorBlockCss)\r\n\r\n            if (type === \"unstyled\") {\r\n              return unstyledBlockCss\r\n            }\r\n            if ((type === \"atomic\") && (text === \"imageBlockText\")) {\r\n              return imageBlockCss\r\n            }\r\n            if (type === \"centerBlock\") {\r\n              return centerBlockCss\r\n            }\r\n            if (type === \"rightBlock\") {\r\n              return rightBlockCss\r\n            }\r\n            if (type === \"colorBlock\") {\r\n              console.log(restCss)\r\n              const imgUrl = block.getData().toJS().img\r\n              const index = theme.backgourndImageArr.findIndex(item => {\r\n                return item.backgroundImage === imgUrl\r\n              })\r\n\r\n              return colorBlockCss + \" \" + restCss[\"css\" + index]\r\n            }\r\n          }}\r\n\r\n          blockRendererFn={function (block) {\r\n\r\n            const text = block.getText()\r\n            const data = block.getData().toObject()\r\n            const type = block.getType()\r\n            //   const entityId = editorState.getCurrentContent().getEntityAt(0);\r\n            if (((type === \"atomic\") && (text === \"imageBlockText\")) || (type === \"imageBlock\")) {\r\n              //   console.log(JSON.stringify(data))\r\n              return {\r\n                component: function AAA(props) { return <ImageBlog {...props} picArr={picArr} setPicArr={setPicArr} editor={editor} /> },\r\n                editable: false\r\n              }\r\n            }\r\n\r\n            else {\r\n              return null\r\n            }\r\n\r\n          }}\r\n          handleKeyCommand={function (command, editorState, evenTimeStamp, { getEditorState }) {\r\n\r\n            if (command === \"bold\") {\r\n              setIsBoldOn(pre => !pre)\r\n\r\n              setEditorState(RichUtils.handleKeyCommand(editorState, command))\r\n            }\r\n            else if (command === \"italic\") {\r\n              setIsItalicOn(pre => !pre)\r\n\r\n              setEditorState(RichUtils.handleKeyCommand(editorState, command))\r\n            }\r\n            else if (command === \"underline\") {\r\n              setIsUnderlineOn(pre => !pre)\r\n\r\n              setEditorState(RichUtils.handleKeyCommand(editorState, command))\r\n            }\r\n          }}\r\n\r\n          stripPastedStyles={true}\r\n          handlePastedText={function (text, html, editorState, props) {\r\n            return true\r\n\r\n          }}\r\n        />\r\n\r\n      </Paper>\r\n\r\n      <Button variant=\"contained\" color=\"primary\" disabled={!enablePost}\r\n\r\n        style={{ display: \"block\", width: \"100%\", marginTop: theme.spacing(1) }}\r\n        onClick={function (e) {\r\n\r\n          editor.current.focus()\r\n          setEnablePost(false)\r\n\r\n          const postID = String(Math.floor(Math.random() * 1000000)) + \"_\" + picArr.length\r\n\r\n\r\n          axios.post(`${url}/article`, {\r\n            ownerName: token.userName,\r\n            content: toPreHtml(editorContent, postID),\r\n            postID,\r\n\r\n          }).then((response) => {\r\n\r\n\r\n            console.log(response.data)\r\n            if (picArr.length === 0) {\r\n              setEnablePost(true)\r\n\r\n              setEditorState(EditorState.createWithContent(convertFromRaw(initialState)))\r\n            }\r\n          })\r\n\r\n\r\n          if (picArr.length > 0) {\r\n\r\n            const data = new FormData();\r\n            const obj = { ownerName: \"aaa\", picName: [] };\r\n            picArr.forEach((pic, index) => {\r\n              const picID = postID + \"_\" + index\r\n              data.append('file', pic)\r\n              obj.picName.push(picID)\r\n              pic.picID = picID\r\n              console.log(picID)\r\n            })\r\n\r\n\r\n            data.append('obj', JSON.stringify(obj));\r\n\r\n            axios.post(`${url}/picture/uploadpicture`, data, {\r\n              headers: { 'content-type': 'multipart/form-data' },\r\n            }).then(response => {\r\n              setEnablePost(true)\r\n              setPicArr([])\r\n              setEditorState(EditorState.createWithContent(convertFromRaw(initialState)))\r\n            })\r\n\r\n          }\r\n\r\n\r\n\r\n          setPostArr(pre => { return [{ ownerName: token.userName, postID, postingTime: Date.now(), content: toPreHtml(editorContent, \"local\") }, ...pre,] })\r\n          setPostPicArr(pre => { return [picArr, ...pre,] })\r\n\r\n        }}\r\n      >Post</Button>\r\n\r\n      <BackColorPanel\r\n        editor={editor}\r\n        isBackColorPanelOn={isBackColorPanelOn}\r\n\r\n      />\r\n\r\n      {!isMobile && <EmojiPanel isEmojiPanelOn={isEmojiPanelOn} />}\r\n\r\n      <MentionPanel isMentionPanelOn={isMentionPanelOn} />\r\n\r\n      {/* <div style={{ whiteSpace: \"pre-wrap\", display: \"flex\", fontSize: 15 }}>\r\n        <div>{JSON.stringify(editorState.getCurrentContent(), null, 2)}</div>\r\n        <hr />\r\n        <div>{JSON.stringify(convertToRaw(editorState.getCurrentContent()), null, 2)}</div>\r\n      </div> */}\r\n\r\n      {/* {toPreHtml(editorContent)} */}\r\n    </Container>\r\n  )\r\n\r\n}\r\n\r\n","import { useState, useRef, useEffect, useContext, useCallback, createContext, useMemo, Component } from 'react';\r\nimport { Context } from \"./ContextProvider\"\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\n\r\nimport { EditorState, ContentState, ContentBlock, CharacterMetadata, SelectionState, convertToRaw, convertFromRaw, RichUtils, Modifier, convertFromHTML, AtomicBlockUtils } from 'draft-js';\r\nimport Editor from \"draft-js-plugins-editor\";\r\nimport Immutable from 'immutable';\r\n\r\nimport chainable from 'draft-js-plugins-chainable';\r\n\r\nimport { compareAsc, format, formatDistanceToNow, } from 'date-fns';\r\n//import axios from 'axios';\r\nimport url, { axios } from './config';\r\n\r\nimport createImagePlugin from './ImagePlugin';\r\nimport createBoldPlugin from './BoldPlugin';\r\nimport createEmojiPlugin from './EmojiPlugin';\r\nimport createMentionPlugin from './MentionPlugin';\r\nimport createLinkPlugin from './LinkPlugin';\r\nimport createDeleteBlogPlugin from './DeleteBlogPlugin';\r\nimport createBackColorPlugin from './BackColorPlugin';\r\n\r\nimport { stateToHTML } from 'draft-js-export-html';\r\nimport ReactHtmlParser, { processNodes, convertNodeToElement, htmlparser2, } from 'react-html-parser';\r\nimport { makeStyles, styled, useTheme } from '@material-ui/core/styles';\r\n\r\nimport { Typography, Button, ButtonGroup, Container, Paper, Box, Avatar, Grid, IconButton, Icon, Chip, Divider, CircularProgress, Collapse } from \"@material-ui/core\";\r\n\r\nimport { Image, Brightness4, Brightness5, FormatBold, FormatItalic, FormatUnderlined, InsertEmoticon, PaletteOutlined, Send, Reply, DeleteOutline, Cancel, ExpandMore } from \"@material-ui/icons\";\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\r\n\r\nimport {\r\n  isMobile,\r\n  isFirefox,\r\n  isChrome,\r\n  browserName,\r\n  engineName,\r\n} from \"react-device-detect\";\r\n\r\nimport multiavatar from '@multiavatar/multiavatar'\r\n//import yellow from '@material-ui/core/colors/yellow';\r\n\r\n//const multiavatar = require('@multiavatar/multiavatar')\r\nlet svgCode = multiavatar('yuan')\r\n\r\n\r\nconst { boldPlugin, BoldButton, ItalicButton, UnderlineButton, LargeButton, SmallButton, } = createBoldPlugin()\r\nconst { emojiPlugin, EmojiButton, EmojiPanel, EmojiIconButton } = createEmojiPlugin()\r\nconst { imagePlugin, ImageButton, TopImageButton, ImageBlog, hasImageBlock } = createImagePlugin()\r\nconst { mentionPlugin, MentionButton, MentionPanel, } = createMentionPlugin()\r\nconst { linkPlugin } = createLinkPlugin()\r\nconst { deleteBlogPlugin, DeleteBlogButton, AddTopLineButton, AddBottomLineButton, AlignCenterButton, AlignRightButton, } = createDeleteBlogPlugin()\r\nconst { backColorPlugin, AddBackColorButton, BackColorPanel } = createBackColorPlugin()\r\n\r\n\r\n\r\n\r\nexport const useStyles = makeStyles(theme => {\r\n\r\n  // console.log(theme.backgourndImageArr)\r\n  const obj = {}\r\n\r\n  theme.backgourndImageArr.forEach((element, index) => {\r\n    obj[\"css\" + index] = element\r\n  });\r\n\r\n\r\n  console.log(obj)\r\n  //const obj = { css1: { ...theme.backgourndImageArr[0] }, css2: { ...theme.backgourndImageArr[0] } }\r\n\r\n\r\n  return {\r\n    ...obj,\r\n    labelShrinkCss: () => {\r\n      return { transform: \"translate(0, 1.5px) scale(0.5)\" }\r\n    },\r\n    textFieldCss: () => {\r\n      return { fontSize: \"1.5rem\" }\r\n    },\r\n\r\n\r\n    editorPaperCss: ({ isLight, breakpointsAttribute, isEditorFocusOn }) => {\r\n      // console.log(isLight)\r\n      return {\r\n        // backgroundColor:\"pink\",\r\n        borderWidth: \"1px\", borderStyle: \"none\",// borderRadius: \"25px\",\r\n        borderColor: isEditorFocusOn ? theme.palette.primary.main : theme.palette.text.secondary,\r\n        //overflow:\"hidden\",\r\n        //  paddingLeft: theme.spacing(1),\r\n        //  paddingRight: theme.spacing(1),\r\n        // wordBreak: \"break-all\",\r\n\r\n        wordBreak: \"break-all\",\r\n        whiteSpace: \"pre-wrap\",\r\n        lineBreak: \"anywhere\",\r\n        //  width:\"100%\"\r\n        // minHeight: \"20vh\",\r\n        //theme.typography.fontSize * 10 + \"px\",\r\n\r\n        //whiteSpace: \"pre-line\",\r\n        //...breakpointsAttribute([\"width\", \"100%\", \"100%\", \"75%\", \"75%\", \"75%\"])\r\n      }\r\n    },\r\n\r\n    unstyledBlockCss: () => {\r\n      return {\r\n\r\n        paddingLeft: \"4px\",//theme.spacing(1),\r\n        paddingRight: \"4px\",//theme.spacing(1),\r\n      }\r\n    },\r\n\r\n\r\n\r\n\r\n\r\n    className1: props => {\r\n\r\n      return {\r\n        background: 'linear-gradient(45deg, #FE6B8B 30%, #FF8E53 90%)',\r\n        // fontSize:200,\r\n        '&:hover': { background: 'linear-gradient(45deg, #FE6B8B 30%, #FF8E53 90%)', },\r\n      }\r\n    },\r\n\r\n\r\n\r\n  }\r\n})\r\n\r\n\r\nconst initialState = {\r\n  entityMap: {\r\n\r\n  },\r\n  blocks: [\r\n\r\n\r\n  ]\r\n};\r\n\r\n\r\nfunction toPreHtml(editorContent, postID = \"local\") {\r\n\r\n\r\n  const preHtml = stateToHTML(\r\n    editorContent.getCurrentContent(),\r\n    {\r\n      defaultBlockTag: \"div\",\r\n\r\n      inlineStyles: {\r\n        //  LARGE: { style: { fontSize: lgSizeObj[deviceSize] }, },\r\n        //  SMALL: { style: { fontSize: smSizeObj[deviceSize] }, },\r\n\r\n        //  LARGE: { style: { fontSize:\"3.5rem\" }},\r\n        //  linkStyle: { style: { fontSize: 0 } }\r\n        //  LARGE: { attributes: { class: \"largeText\" } },\r\n      },\r\n\r\n\r\n      blockStyleFn: function (block) {\r\n        const type = block.getType()\r\n        // console.log(type)\r\n\r\n        if (type === \"unstyled\") {\r\n          return {\r\n            attributes: {\r\n              //className: unstyledBlockCss,\r\n\r\n            },\r\n            style: {\r\n              //  paddingLeft: \"4px\",\r\n              //  paddingRight: \"4px\",\r\n              fontSize: \"1.2rem\",\r\n            }\r\n          }\r\n        }\r\n\r\n\r\n\r\n      },\r\n\r\n      blockRenderers: {\r\n\r\n      },\r\n\r\n      entityStyleFn: function (entity) {\r\n        const { type, data, mutablity } = entity.toObject()\r\n        if (type === \"shortMentionOff\") {\r\n          return {\r\n            element: \"shortMentionoff\",\r\n          }\r\n        }\r\n        if (type === \"longMentionOff_HEAD\") {\r\n\r\n          return {\r\n\r\n            element: \"longmentionoff_head\",\r\n            attributes: {\r\n              imgurl: data.imgurl,\r\n              person: data.person,\r\n            },\r\n            style: {}\r\n          }\r\n        }\r\n        if (type === \"longMentionOff_BODY\") {\r\n\r\n          return {\r\n\r\n            element: \"longmentionoff_body\",\r\n            attributes: {\r\n              imgurl: data.imgurl,\r\n              person: data.person,\r\n            },\r\n\r\n          }\r\n\r\n        }\r\n        if (type === \"EMOJI\") {\r\n          console.log(data.url)\r\n\r\n          return {\r\n            element: \"emoji\",\r\n            attributes: {\r\n              imgurl: data.url,\r\n              symbol: data.symbol\r\n            }\r\n          }\r\n        }\r\n        // if (type === \"linkOn\") {\r\n        //   const {linkType,linkAddress,linkHost} = data\r\n        // }\r\n        if (type === \"linkOff\") {\r\n          // alert(\"xxx\")\r\n          const { linkType, linkAddress, linkHost } = data\r\n          return {\r\n            element: \"linkoff\",\r\n            attributes: {\r\n              ...data\r\n            }\r\n          }\r\n        }\r\n\r\n      },\r\n\r\n    }\r\n  )\r\n  return preHtml\r\n}\r\n\r\n\r\nexport default function CommentContent({ postID, index, toHtml, setCommentCount, commentCount, avatarPic, showComment }) {\r\n\r\n  const {\r\n\r\n    token,\r\n    isLight, setIsLight, breakpointsAttribute,\r\n    editorContent,\r\n    setEditorContent,\r\n    lgSizeObj, smSizeObj, deviceSize,\r\n\r\n\r\n    // backImageArr, setBackImageArr,\r\n    // backImageIndex, setBackImageIndex,\r\n  } = useContext(Context)\r\n  const theme = useTheme()\r\n\r\n  // const [picArr,setPicArr] = useState([])\r\n\r\n\r\n\r\n  const [isEmojiPanelOn, setIsEmojiPanelOn] = useState(false)\r\n  const [isMentionPanelOn, setIsMentionPanelOn] = useState(false)\r\n\r\n\r\n\r\n  const [isEditorFocusOn, setIsEditorFocusOn] = useState(false)\r\n\r\n  //const [picArr, setPicArr] = useState([])\r\n\r\n  const editor = useRef()\r\n  const { editorPaperCss, className1, unstyledBlockCss, imageBlockCss, centerBlockCss, rightBlockCss, colorBlockCss, ...restCss } = useStyles({ isLight, isEditorFocusOn, breakpointsAttribute })\r\n\r\n  //console.log(backImageCssArr)\r\n  //const [editorState, setEditorState] = useState(EditorState.createEmpty())\r\n  //const [editorState, setEditorState] = useState(EditorState.createWithContent(ContentState.createFromText('some')))\r\n  const [editorState, setEditorState] = useState(EditorState.createWithContent(convertFromRaw(initialState)))\r\n\r\n\r\n  const [enablePost, setEnablePost] = useState(true)\r\n\r\n\r\n  const [commentArr, setCommentArr] = useState([])\r\n  const commentObjList = useRef([])\r\n\r\n\r\n\r\n  const [replyNum, setReplyNum] = useState(999)\r\n\r\n  // const [subCommentCount, setSubCommentCount] = useState(0)\r\n\r\n\r\n\r\n  useEffect(function () {\r\n\r\n    axios.get(`${url}/comment/loadfive/${postID}/${Date.now()}`).then(response => {\r\n\r\n      setCommentArr(response.data)\r\n\r\n    })\r\n\r\n  }, [])\r\n\r\n  useEffect(function () {\r\n    !isMobile && showComment && setTimeout(() => {\r\n      editor.current.focus()\r\n      EditorState.moveFocusToEnd(editorState)\r\n    }, 500);\r\n\r\n  }, [showComment])\r\n\r\n\r\n\r\n\r\n  function createCommentEditorHeader(isSubCommentEditor = false, commentID) {\r\n\r\n    return <Box style={{\r\n      //     marginBottom: \"5px\",\r\n\r\n      display: \"flex\", alignItems: \"center\", justifyContent: \"flex-start\", flexWrap: isMobile ? \"wrap\" : \"wrap\",\r\n\r\n\r\n      gap: theme.spacing(0),\r\n      ...isSubCommentEditor && { marginLeft: \"1.6rem\" },\r\n\r\n\r\n      //   width: \"100%\",\r\n    }}>\r\n\r\n\r\n      <Chip\r\n\r\n        // onClick={function () {\r\n\r\n        //   alert(commentID)\r\n        // }}\r\n        // classes={{ root: mentionBodyRoot2, label: mentionBodyLabel }}\r\n        key={index}\r\n        avatar={\r\n          <Avatar alt={null}\r\n            //   src={\"https://api.multiavatar.com/\" + token.userName + \".svg\"}   //src={friendObj[person]}\r\n\r\n            src={avatarPic ? URL.createObjectURL(avatarPic) : `${url}/avatar/${token.userName}.svg`}\r\n          //   src={(svgCode)}\r\n          />\r\n        }\r\n        label={\r\n          <Typography\r\n            style={{ marginTop: \"3px\", lineHeight: \"1.0\", fontWeight: \"bold\", fontSize: \"0.9rem\" }}>\r\n            {token.userName}\r\n          </Typography>\r\n        }\r\n      />\r\n      {!isMobile && <EmojiIconButton color=\"primary\" fontSize=\"small\" isEmojiPanelOn={isEmojiPanelOn} setIsEmojiPanelOn={setIsEmojiPanelOn} />}\r\n      <Paper style={{ borderRadius: \"1000px\", transform: \"scale(0.8)\", padding: \"0px\" }} elevation={3}>\r\n        <IconButton size=\"small\"\r\n          //    disabled={true}\r\n          style={{\r\n\r\n          }}\r\n\r\n          onClick={function () {\r\n            const content = toPreHtml(editorContent)\r\n\r\n            if (!commentID) {\r\n              const commentID = String(Math.floor(Math.random() * 1000000))\r\n              axios.post(`${url}/comment`, {\r\n                ownerName: token.userName,\r\n                content: content,\r\n                postID: postID,\r\n                postingTime: Date.now(),\r\n                commentID,\r\n\r\n              }).then(response => {\r\n                setCommentArr(pre => {\r\n                  return [{\r\n                    ownerName: token.userName,\r\n                    content: content,\r\n                    postID: postID,\r\n                    postingTime: Date.now(),\r\n                    commentID,\r\n                  }, ...pre]\r\n                })\r\n                setEditorState(EditorState.createWithContent(convertFromRaw(initialState)))\r\n                setCommentCount(pre => Number(pre) + 1)\r\n\r\n              })\r\n            }\r\n            else {\r\n              const subCommentID = String(Math.floor(Math.random() * 1000000))\r\n              axios.post(`${url}/subcomment`, {\r\n                ownerName: token.userName,\r\n                content: content,\r\n                postID: postID,\r\n                postingTime: Date.now(),\r\n                commentID,\r\n                subCommentID,\r\n\r\n              }).then(response => {\r\n                //  alert(JSON.stringify(response.data))\r\n\r\n                console.log(commentObjList.current)\r\n\r\n                const subCommentHead = commentObjList.current.find(comment => {\r\n\r\n                  return comment.commentID === commentID\r\n\r\n                })\r\n\r\n                setCommentArr(pre => {\r\n                  // return pre.filter(item => {\r\n                  //   return item.commentID !== comment.commentID\r\n                  // })\r\n                  pre.forEach(item => {\r\n                    if (item.commentID === commentID) {\r\n                      if (item.subCommentCount) { item.subCommentCount++ }\r\n                      else { item.subCommentCount = 1 }\r\n                    }\r\n                  })\r\n                  return pre\r\n                })\r\n\r\n\r\n                subCommentHead.updateSubCommentArr(response.data)\r\n                setEditorState(EditorState.createWithContent(convertFromRaw(initialState)))\r\n\r\n\r\n              })\r\n\r\n\r\n            }\r\n          }}\r\n        ><Send style={{ transform: \"scale(0.9)\", color: theme.palette.type === \"light\" ? theme.palette.primary.main : theme.palette.text.secondary }} /></IconButton></Paper>\r\n    </Box >\r\n\r\n\r\n  }\r\n\r\n  function createCommentEditor(isSubCommentEditor = false, commentID) {\r\n    return <>\r\n\r\n      {/* {replyNum === 999 && createCommentEditorHeader()} */}\r\n\r\n\r\n      {createCommentEditorHeader(isSubCommentEditor, commentID)}\r\n      {/* {replyNum !== 999 && <div style={{ margin: theme.spacing(1) }} />} */}\r\n\r\n\r\n\r\n\r\n      <Paper\r\n\r\n        elevation={isEditorFocusOn ? 3 : 2}\r\n        //  className={editorPaperClass}\r\n        //  classes={{ root: editorPaperCss }}\r\n        style={{\r\n\r\n          marginLeft: isSubCommentEditor ? \"3.6rem\" : \"2rem\",\r\n          marginRight: \"4px\",\r\n          fontSize: \"1.2rem\",\r\n          borderWidth: \"2px\",\r\n          borderColor: \"rgb(63, 81, 181)\",\r\n          borderStyle: \"solid\",\r\n\r\n          // backgroundImage\r\n          // minHeight: \"20vh\",\r\n          // backgroundImage:\"url(https://source.unsplash.com/random/800x800)\",\r\n          // opacity:0.3\r\n        }}\r\n        onClick={function () {\r\n\r\n          let editorState_ = EditorState.moveSelectionToEnd(editorState);\r\n\r\n          setEditorState(EditorState.forceSelection(editorState_, editorState.getSelection()));\r\n          setIsEditorFocusOn(true)\r\n        }}\r\n      >\r\n\r\n        <Editor\r\n          ref={function (element) { editor.current = element; }}\r\n          editorState={editorState}\r\n\r\n\r\n          onChange={function (newState, { ...props }) {\r\n\r\n\r\n\r\n            const selection = newState.getSelection()\r\n\r\n\r\n\r\n\r\n            setIsEditorFocusOn(selection.hasFocus)\r\n\r\n\r\n            setEditorContent(newState)\r\n            setEditorState(newState)\r\n\r\n          }}\r\n\r\n          plugins={//chainable(\r\n            [\r\n              emojiPlugin,\r\n              mentionPlugin,\r\n              linkPlugin,\r\n\r\n            ]\r\n            // )\r\n          }\r\n\r\n\r\n          // placeholder=\"hihihi\"\r\n          preserveSelectionOnBlur={true}\r\n\r\n          customStyleMap={\r\n            Immutable.Map({\r\n              // stylename1_: {\r\n              //   color: \"rgba(200,0,0,1)\",\r\n\r\n            })\r\n          }\r\n\r\n          customStyleFn={function (style, block) {\r\n\r\n            const styleNames = style.toObject();\r\n\r\n          }}\r\n\r\n          blockRenderMap={\r\n            Immutable.Map({\r\n              // 'unstyled': { \r\n              //   element: 'h3',\r\n              //   wrapper: <Typography variant='body2'/>,\r\n              //  }\r\n\r\n              // \"colorBlock\": {\r\n              //   style: \"backgournd-color:red\"\r\n              // }\r\n            })\r\n          }\r\n\r\n\r\n\r\n          blockStyleFn={function (block) {\r\n            const type = block.getType()\r\n            const text = block.getText()\r\n\r\n            //    const {colorBlockCss0} = useStyles(data.img)\r\n\r\n            // console.log(colorBlockCss)\r\n\r\n            if (type === \"unstyled\") {\r\n              return unstyledBlockCss\r\n            }\r\n\r\n          }}\r\n\r\n          blockRendererFn={function (block) {\r\n\r\n            const text = block.getText()\r\n            const data = block.getData().toObject()\r\n            const type = block.getType()\r\n            //   const entityId = editorState.getCurrentContent().getEntityAt(0);\r\n\r\n            return null\r\n\r\n\r\n          }}\r\n          handleKeyCommand={function (command, editorState, evenTimeStamp, { getEditorState }) {\r\n\r\n\r\n          }}\r\n        />\r\n\r\n      </Paper>\r\n      {!isMobile && <EmojiPanel isEmojiPanelOn={isEmojiPanelOn} marginBottom=\"0\" />}\r\n      {!isSubCommentEditor && commentArr.length > 0 && <Divider style={{ marginTop: theme.spacing(1) }} />}\r\n    </>\r\n  }\r\n\r\n  // const commentEditor = useRef(createCommentEditor(false, null))\r\n\r\n  // if ((commentArr.length === 0)&&(showComment)) {\r\n  //   return (\r\n  //     <>\r\n  //       {createCommentEditor(false, null)}\r\n\r\n  //       <Divider light={false} style={{ marginTop: \"8px\" }} />\r\n\r\n  //     </>\r\n  //   )\r\n  // }\r\n\r\n  \r\n\r\n\r\n\r\n  return (\r\n    // <Container disableGutters={true} maxWidth=\"lg\" style={{\r\n    //   backgroundColor: theme.palette.action.disabledBackground, paddingBottom: theme.spacing(0),\r\n    //   //height:\"auto\",\r\n    //   display: \"flex\", flexDirection: \"column\", justifyContent: \"space-between\",\r\n    //   // transition: \"height 10s\",\r\n\r\n\r\n    // }}>\r\n\r\n\r\n    <Collapse in={showComment} style={{backgroundColor: theme.palette.action.disabledBackground,}}>\r\n\r\n\r\n\r\n      {(replyNum === 999) && createCommentEditor(false, null)}\r\n      {commentArr.map((comment, listIndex) => {\r\n\r\n        return (\r\n          <span key={comment.commentID}>\r\n\r\n\r\n\r\n            <Chip\r\n\r\n              style={{ verticalAlign: \"top\" }}\r\n\r\n              onClick={function () {\r\n                const subCommentHead = commentObjList.current.find(item => {\r\n                  return comment.commentID === item.commentID\r\n                })\r\n\r\n                replyNum === listIndex\r\n                  ? subCommentHead.clearSubComments()\r\n                  : subCommentHead.loadSubComments()\r\n\r\n\r\n\r\n                setReplyNum(pre => pre === listIndex ? 999 : listIndex)\r\n\r\n\r\n\r\n                setTimeout(() => {\r\n                  !isMobile && editor.current.focus();\r\n                  !isMobile && EditorState.moveFocusToEnd(editorState);\r\n\r\n                }, 0)\r\n\r\n              }}\r\n\r\n              deleteIcon={\r\n\r\n                <>{replyNum === listIndex\r\n                  ? <Cancel style={{ fontSize: \"1.2rem\", color: theme.palette.text.secondary, }} />\r\n                  : <Reply style={{ fontSize: \"1.2rem\", color: theme.palette.text.secondary, }} />\r\n                }\r\n                  <span style={{ fontWeight: \"bold\", fontSize: \"1rem\", color: theme.palette.text.secondary, verticalAlign: \"middle\" }}>\r\n                    {comment.subCommentCount}\r\n                  </span>\r\n                </>\r\n              }\r\n              onDelete={function () {\r\n                const subCommentHead = commentObjList.current.find(item => {\r\n                  return comment.commentID === item.commentID\r\n                })\r\n\r\n                replyNum === listIndex\r\n                  ? subCommentHead.clearSubComments()\r\n                  : subCommentHead.loadSubComments()\r\n                setReplyNum(pre => pre === listIndex ? 999 : listIndex)\r\n\r\n                setTimeout(() => {\r\n\r\n                  !isMobile && editor.current.focus();\r\n                  !isMobile && EditorState.moveFocusToEnd(editorState);\r\n\r\n                }, 1000)\r\n\r\n\r\n              }}\r\n\r\n              // classes={{ root: mentionBodyRoot2, label: mentionBodyLabel }}\r\n              key={index}\r\n\r\n              avatar={\r\n                < Avatar alt={null}\r\n                  //   style={{ width: \"1.5rem\", height: \"1.5rem\", }}\r\n                  //   src={\"https://api.multiavatar.com/\" + comment.ownerName + \".svg\"}   //src={friendObj[person]}\r\n                  src={avatarPic && token.userName === comment.ownerName ? URL.createObjectURL(avatarPic) : `${url}/avatar/${comment.ownerName}.svg`}\r\n                />\r\n              }\r\n              label={\r\n                <Typography\r\n                  style={{ fontWeight: \"bold\", fontSize: \"0.9rem\" }}>\r\n                  {comment.ownerName}\r\n                  &nbsp;<span style={{ color: theme.palette.text.secondary, fontSize: \"0.7rem\", fontWeight: \"normal\" }}>\r\n                    {formatDistanceToNow(Number(comment.postingTime)).replace(\"less than \", \"\").replace(\"about \", \"\")}\r\n                  </span>\r\n                </Typography>\r\n              }\r\n\r\n            />\r\n\r\n\r\n\r\n            {token.userName == comment.ownerName && <IconButton size=\"small\"\r\n              style={{ float: \"right\", }}\r\n              onClick={function () {\r\n\r\n                setCommentArr(pre => {\r\n                  return pre.filter(item => {\r\n                    return item.commentID !== comment.commentID\r\n                  })\r\n                })\r\n\r\n                axios.get(`${url}/comment/deletecomment/${comment.commentID}`).then(response => {\r\n\r\n                  setCommentCount(pre => Number(pre) - 1)\r\n                })\r\n              }}\r\n            >\r\n              <DeleteOutline style={{ fontSize: \"1.5rem\" }} />\r\n            </IconButton>}\r\n\r\n            <Paper style={{ marginLeft: \"2rem\", paddingLeft: \"4px\", paddingRight: \"4px\", marginRight: \"4px\", fontSize: \"1.2rem\",\r\n             //backgroundColor: theme.palette.background.default \r\n             }}>\r\n              {toHtml(comment.content, null, null, true)}\r\n            </Paper>\r\n\r\n            {(replyNum === listIndex) && createCommentEditor(true, comment.commentID)}\r\n\r\n\r\n            <SubComments setReplyNum={setReplyNum} replyNum={replyNum} listIndex={listIndex}\r\n              commentArr={commentArr} toHtml={toHtml} comment={comment} theme={theme} index={index} editor={editor}\r\n              commentObjList={commentObjList}\r\n              setCommentArr={setCommentArr}\r\n              token={token}\r\n              avatarPic={avatarPic}\r\n            />\r\n\r\n\r\n            {(listIndex !== commentArr.length - 1) && <Divider light={false} style={{ marginTop: \"8px\" }} />}\r\n\r\n\r\n\r\n\r\n          </span>\r\n        )\r\n\r\n      })}\r\n\r\n\r\n      {commentArr.length < commentCount\r\n        ? <Button\r\n\r\n          onClick={function () {\r\n\r\n\r\n            const postingTime = Math.min(...commentArr.map(item => item.postingTime))\r\n            const postID = commentArr.find(item => item.postingTime === postingTime).postID\r\n            axios.get(`${url}/comment/loadfive/${postID}/${postingTime}`).then(response => {\r\n              setCommentArr(pre => { return [...pre, ...response.data] })\r\n\r\n\r\n            })\r\n          }}\r\n\r\n          style={{\r\n            marginTop: \"8px\",\r\n            borderTopLeftRadius: 0,\r\n            borderTopRightRadius: 0,\r\n            padding: 0, boxShadow: theme.shadows[0],\r\n            color: theme.palette.type === \"dark\"\r\n              ? theme.palette.text.secondary\r\n              : theme.palette.primary.main,\r\n            fontWeight: \"bold\",\r\n          }}\r\n          size=\"small\" disableElevation fullWidth={true}\r\n        >\r\n          {/* <CircularProgress size=\"1rem\" style={{\r\n            color: theme.palette.type === \"dark\"\r\n              ? theme.palette.text.secondary\r\n              : theme.palette.primary.main\r\n          }} /> */}\r\n          <ExpandMore />&nbsp;{commentArr.length}/{commentCount}\r\n        </Button>\r\n        : <div style={{ marginTop: \"16px\" }}></div>\r\n      }\r\n\r\n    </Collapse>\r\n    // </Container>\r\n  )\r\n\r\n}\r\n\r\n\r\nclass SubComments extends Component {\r\n\r\n  constructor(props, context) {\r\n    super(props, context)\r\n\r\n    this.commentID = this.props.comment.commentID\r\n    this.state = {\r\n      subCommentArr: [],\r\n      showingCount: 5,\r\n      open: false,\r\n    }\r\n    this.subCommentCount = this.props.comment.subCommentCount\r\n\r\n\r\n\r\n  }\r\n\r\n  //shouldComponentUpdate(nextProps, nextState) { }\r\n  //componentDidUpdate(prevProps) { }\r\n  componentDidMount() {\r\n    this.props.commentObjList.current.push(this)\r\n  }\r\n\r\n\r\n\r\n\r\n  updateSubCommentArr = (obj) => {\r\n\r\n    this.setState(pre => {\r\n      const arr = pre.subCommentArr;\r\n      // if (arr.findIndex(aaa => { return aaa.subCommentID === obj.subCommentID }) >= 0) {\r\n      //   return pre\r\n      // }\r\n      return {\r\n        subCommentArr: [obj, ...arr,],\r\n        showingCount: Math.min(pre.showingCount + 1, pre.subCommentArr.length + 1)\r\n      }\r\n\r\n    })\r\n\r\n  }\r\n\r\n  loadSubComments = () => {\r\n\r\n    axios.get(`${url}/subcomment/${this.props.comment.commentID}`).then(response => {\r\n      this.setState(pre => {\r\n        pre.subCommentArr = true ? response.data : pre.subCommentArr\r\n        pre.showingCount = 5\r\n        return pre\r\n      })\r\n\r\n      setTimeout(() => {\r\n        this.setState(pre => {\r\n          pre.open = true\r\n          return pre\r\n        })\r\n\r\n      }, 200);\r\n    })\r\n  }\r\n\r\n  clearSubComments = () => {\r\n    this.setState(pre => {\r\n\r\n      pre.open = false\r\n      return pre\r\n\r\n    })\r\n\r\n    setTimeout(() => {\r\n      this.setState(pre => {\r\n\r\n        pre.subCommentArr = []\r\n        pre.showingCount = 5\r\n        return pre\r\n\r\n\r\n      })\r\n    }, 200);\r\n\r\n  }\r\n\r\n\r\n\r\n\r\n  render() {\r\n    return (\r\n      <Collapse in={Boolean(this.state.subCommentArr.length) && this.state.open}>\r\n\r\n        {this.state.subCommentArr.map((subComment, subListIndex) => {\r\n\r\n          if ((subListIndex) > this.state.showingCount) {\r\n            return <></>\r\n          }\r\n          else if (subListIndex === (this.state.showingCount)) {\r\n            return (\r\n\r\n              <div style={{ marginLeft: \"3.6rem\", marginRight: \"4px\", marginTop: \"4px\", display: \"flex\", justifyContent: \"center\", height: \"1.5rem\" }}>\r\n                <Button fullWidth={true} size=\"small\"\r\n                  disableElevation={true}\r\n                  style={{\r\n                    // color: this.props.themepalette.type === \"dark\"\r\n                    //   ? this.props.theme.palette.text.secondary\r\n                    //   : this.props.theme.palette.primary.main,\r\n                    color: this.props.theme.palette.text.secondary,\r\n                    fontWeight: \"bold\",\r\n\r\n                  }}\r\n\r\n                  onClick={() => {\r\n                    this.setState(pre => {\r\n\r\n                      return {\r\n                        ...pre,\r\n                        showingCount: Math.min(pre.showingCount + 5, pre.subCommentArr.length)\r\n\r\n                      }\r\n\r\n                      //   return pre.showingCount = Math.min(pre.showingCount + 5, pre.subCommentArr.length)\r\n\r\n                    })\r\n\r\n                  }}\r\n\r\n                ><ExpandMore />{this.state.showingCount}/{this.state.subCommentArr.length}</Button>\r\n              </div>\r\n            )\r\n          }\r\n\r\n          else {\r\n            return <span key={subComment.subCommentID}>\r\n\r\n              <Chip\r\n                style={{\r\n                  marginLeft: \"1.6rem\",\r\n                  //  verticalAlign:\"top\",\r\n                }}\r\n                //  onClick={() => {\r\n                // token.userName === postArr[index].ownerName && setOpen(pre => !pre)\r\n                // setReplyNum(listIndex)\r\n                // setTimeout(() => {\r\n                //   editor.current.focus();\r\n                //   EditorState.moveFocusToEnd(editorState);\r\n\r\n                // }, 0)\r\n                //alert(JSON.stringify(comment))\r\n                //    }}\r\n\r\n                // classes={{ root: mentionBodyRoot2, label: mentionBodyLabel }}\r\n\r\n                avatar={\r\n                  < Avatar alt={null}\r\n                    //   style={{ width: \"1.5rem\", height: \"1.5rem\", }}\r\n                    // src={\"https://api.multiavatar.com/\" + subComment.ownerName + \".svg\"}\r\n                    src={this.props.avatarPic && this.props.token.userName === subComment.ownerName ? URL.createObjectURL(this.props.avatarPic) : `${url}/avatar/${subComment.ownerName}.svg`}\r\n                  //src={friendObj[person]}\r\n\r\n                  />\r\n                }\r\n                label={\r\n                  <Typography\r\n                    style={{ fontWeight: \"bold\", fontSize: \"0.9rem\" }}>\r\n                    {subComment.ownerName}\r\n                    &nbsp;<span style={{ color: this.props.theme.palette.text.secondary, verticalAlign: \"middle\", fontSize: \"0.7rem\", fontWeight: \"normal\" }}>\r\n                      {formatDistanceToNow(Number(subComment.postingTime)).replace(\"less than \", \"\").replace(\"about \", \"\")}\r\n                    </span>\r\n                  </Typography>\r\n                }\r\n\r\n              />\r\n\r\n              {this.props.token.userName === subComment.ownerName &&\r\n                <IconButton size=\"small\"\r\n                  style={{ float: \"right\", marginTop: \"4px\" }}\r\n                  onClick={() => {\r\n\r\n\r\n                    axios.get(`${url}/subcomment/deletesubcomment/${subComment.subCommentID}`).then(reponse => {\r\n                      this.setState(pre => {\r\n                        return {\r\n                          subCommentArr: pre.subCommentArr.filter(item => { return item.subCommentID !== subComment.subCommentID }),\r\n\r\n\r\n                          showingCount: Math.max(pre.showingCount - 1, 0)\r\n                        }\r\n\r\n                      })\r\n\r\n\r\n                      //  alert(this.commentID)\r\n\r\n                      this.props.setCommentArr(pre => {\r\n                        // return pre.filter(item => {\r\n                        //   return item.commentID !== comment.commentID\r\n                        // })\r\n                        pre.forEach(item => {\r\n                          if (item.commentID === this.commentID) {\r\n                            if (item.subCommentCount) { item.subCommentCount-- }\r\n                            else { item.subCommentCount = 1 }\r\n                          }\r\n                        })\r\n                        return [...pre]\r\n                      })\r\n\r\n\r\n\r\n                    })\r\n                  }}\r\n                >\r\n                  <DeleteOutline style={{ fontSize: \"1.5rem\" }} />\r\n                </IconButton>\r\n              }\r\n\r\n              <Paper style={{ marginLeft: \"3.6rem\", paddingLeft: \"4px\", paddingRight: \"4px\", marginRight: \"4px\", fontSize: \"1.2rem\", backgroundColor: this.props.theme.palette.background.default }}>\r\n                {this.props.toHtml(subComment.content, null, null, true)}\r\n              </Paper>\r\n\r\n\r\n\r\n\r\n\r\n\r\n            </span>\r\n          }\r\n        })\r\n        }\r\n\r\n\r\n\r\n\r\n      </Collapse>\r\n    )\r\n\r\n\r\n  }\r\n}\r\n\r\n\r\n","import { useState, useRef, useEffect, useContext, useCallback, createContext, useMemo } from 'react';\r\nimport { Context } from \"./ContextProvider\"\r\n\r\n\r\nimport { EditorState, ContentState, ContentBlock, CharacterMetadata, SelectionState, convertToRaw, convertFromRaw, RichUtils, Modifier, convertFromHTML, AtomicBlockUtils } from 'draft-js';\r\nimport Editor from \"draft-js-plugins-editor\";\r\nimport Immutable from 'immutable';\r\nimport Masonry from 'react-masonry-css';\r\nimport { makeStyles, styled, useTheme } from '@material-ui/core/styles';\r\n\r\nimport { stateToHTML } from 'draft-js-export-html';\r\nimport ReactHtmlParser, { processNodes, convertNodeToElement, htmlparser2, } from 'react-html-parser';\r\n\r\n\r\nimport DetectableOverflow from 'react-detectable-overflow';\r\n\r\n\r\n\r\nimport { Typography, Button, ButtonGroup, Container, Paper, Box, Avatar, Grid, Chip, Link, IconButton, CircularProgress, Collapse } from \"@material-ui/core\";\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogContentText from '@material-ui/core/DialogContentText';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\n\r\nimport { Image, Brightness4, Brightness5, FormatBold, FormatItalic, FormatUnderlined, InsertEmoticon, NavigateBeforeSharp, ExpandMore, ExpandLess, DeleteOutline, Send, TextsmsOutlined, MessageOutlined, ChatBubbleOutline, FullscreenOutlined, CloseOutlined } from \"@material-ui/icons\";\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\r\n\r\nimport { useStyles as draftStyles } from './DraftEditor';\r\nimport { useStyles as mentionStyles } from './MentionPlugin';\r\n\r\nimport url, { axios } from './config';\r\n\r\n\r\nimport { compareAsc, format, formatDistanceToNow, } from 'date-fns';\r\n\r\nimport {\r\n  isMobile,\r\n  isFirefox,\r\n  isChrome,\r\n\r\n  engineName,\r\n\r\n} from \"react-device-detect\";\r\n\r\nimport Lightbox from 'react-image-lightbox';\r\nimport 'react-image-lightbox/style.css'; // This only needs to be imported once in your app\r\n\r\n\r\nimport { useInView } from 'react-intersection-observer';\r\nimport CommentContent from \"./CommentContent\";\r\n\r\nimport Grow from '@material-ui/core/Grow';\r\n\r\nconst useStyles = makeStyles(theme => {\r\n\r\n  return {\r\n    textFieldCss: () => {\r\n      return {\r\n        fontSize: \"1.5rem\",\r\n        \"&.MuiInputLabel-shrink\": {\r\n          transform: \"translate(0, 1.5px) scale(0.5)\",\r\n        }\r\n\r\n\r\n      }\r\n    },\r\n\r\n    labelShrinkCss: () => {\r\n      return { transform: \"translate(0, 1.5px) scale(0.5)\" }\r\n    },\r\n  }\r\n\r\n})\r\n\r\n\r\nexport default function Content({ style }) {\r\n\r\n  const {\r\n    token, setToken,\r\n    breakpointsAttribute,\r\n    editorContent, setEditorContent, lgSizeObj, smSizeObj, deviceSize, picArr, setPicArr,\r\n    postArr, setPostArr,\r\n    postPicArr, setPostPicArr,\r\n    getSinglePost, deleteSinglePost,\r\n    changeOwnerName,\r\n  } = useContext(Context);\r\n\r\n  const [avatarPic, setAvatarPic] = useState()\r\n\r\n  const [isFull, setIsFull] = useState(false)\r\n  const theme = useTheme()\r\n  const { editorPaperCss, className1, unstyledBlockCss, imageBlockCss, centerBlockCss, rightBlockCss } = draftStyles({})\r\n  const { mentionHeadRoot, mentionBodyRoot, mentionBodyRoot2, mentionHeadAvatar, mentionHeadLabel, mentionHeadLabel2, mentionBodyLabel, } = mentionStyles();\r\n  const { textFieldCss, labelShrinkCss } = useStyles()\r\n\r\n  const [fullVisible, setFullVisible] = useState(true)\r\n  const toHtml = useCallback(\r\n    function (preHtml, imgArr, inView, isComment) {\r\n      //  alert(\"bbbb\")\r\n      const html = ReactHtmlParser(preHtml, {\r\n\r\n\r\n\r\n        transform: function transformFn(node, index) {\r\n\r\n          if (node.name === \"svg\") {\r\n\r\n            const child = node.children[0];\r\n            const { width, height, viewbox, preserveaspectratio } = node.attribs;\r\n            //     alert(node.children.length)\r\n            return (\r\n              <svg\r\n                key={index}\r\n                width={width}\r\n                height={height}\r\n                viewBox={viewbox}\r\n                preserveAspectRatio={preserveaspectratio}\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n              >\r\n                {node.children.map((child, index) => {\r\n                  return convertNodeToElement(child, index, transformFn)\r\n                })}    \r\n              </svg>\r\n            )\r\n          }\r\n          if (node.name === \"imgtag\") {\r\n            return (inView && <ImgTag key={index} picArr={imgArr} picName={node.attribs.id} fullVisible={fullVisible} setFullVisible={setFullVisible} />)\r\n          }\r\n          if (node.name === \"emoji\") {\r\n\r\n\r\n            const emojiUrl = `url(${url}/picture/downloademoji/${node.attribs.imgurl.substring(node.attribs.imgurl.lastIndexOf(\"/\") + 1, node.attribs.imgurl.length)})`\r\n\r\n            //    node.attribs.imgurl.lastIndexOf(\"/\")\r\n\r\n\r\n            //   console.log(node.attribs.symbol, node.attribs.imgurl)\r\n            return (\r\n              <Typography variant={isComment ? \"inherit\" : \"body2\"}\r\n                key={index}\r\n                style={{\r\n                  backgroundRepeat: \"no-repeat\",\r\n                  backgroundPosition: \"center center\",\r\n                  backgroundSize: \"contain\",\r\n                  display: \"inline-block\",\r\n                  textAlign: \"right\",\r\n                  color: \"rgba(0,0,0,0)\",\r\n                  backgroundImage: emojiUrl,// node.attribs.imgurl,\r\n                  transform: isMobile ? isComment ? \"scale(1.2)\" : \"scale(1.2)\" : isComment ? \"scale(1.2)\" : \"scale(1.2)\",\r\n                  marginLeft: theme.typography.fontSize * 0.12,\r\n                  marginRight: theme.typography.fontSize * 0.12,\r\n                }}\r\n              >{node.attribs.symbol}</Typography>\r\n            )\r\n          }\r\n          if (node.name === \"longmentionoff_head\") {\r\n            return (<span key={index}></span>)\r\n          }\r\n          if (node.name === \"longmentionoff_body\") {\r\n\r\n            const arr = [];\r\n            node.children.forEach(element => {\r\n              arr.push(convertNodeToElement(element))\r\n            })\r\n\r\n           // console.log(node)\r\n\r\n            const avatarUrl = `${url}/avatar${node.attribs.imgurl.substring(node.attribs.imgurl.lastIndexOf(\"/\"), node.attribs.imgurl.length)}`.replace(\").\", \".\")\r\n\r\n\r\n            const personName = node.attribs.imgurl.substring(node.attribs.imgurl.lastIndexOf(\"/\") + 1, node.attribs.imgurl.length - 5)\r\n\r\n            //   alert(avatarUrl)\r\n\r\n            return (\r\n              <Chip classes={{ root: mentionBodyRoot2, label: mentionBodyLabel }}\r\n                key={index}\r\n                avatar={< Avatar alt={null} src={avatarPic && token.userName === personName ? URL.createObjectURL(avatarPic) : avatarUrl}       //src={node.attribs.imgurl.replace(\"url(\", \"\").replace(\")\", \"\")}   //src={friendObj[person]}\r\n                />}\r\n                label={\r\n                  <Typography variant=\"body2\">\r\n                    {arr.map((element, index) => {\r\n         \r\n                    //  console.log(element)\r\n                      return <span key={index}>{element}</span>\r\n                    })}\r\n                  </Typography>\r\n                }\r\n              // label={< Typography variant=\"body2\" >{node.attribs.person}</Typography >}\r\n              />\r\n            )\r\n          }\r\n\r\n          if (Object.keys(node.attribs || {}).includes(\"colorblock\")) {\r\n            //  console.log(JSON.stringify(node.attribs))\r\n            const arr = [];\r\n            const arr2 = [];\r\n            const backimage = node.attribs.backimage\r\n            const textcolor = node.attribs.textcolor\r\n            node.children.forEach(item => {\r\n\r\n              arr.push(item.type === \"tag\" ? item : item.data)\r\n              arr2.push(convertNodeToElement(item))\r\n            })\r\n            return (\r\n              <BackColorTag arr={arr} transformFn={transformFn} index={index} arr2={arr2} backimage={backimage} textcolor={textcolor} inView={inView} key={Math.random()} />\r\n            )\r\n          }\r\n\r\n\r\n\r\n\r\n\r\n\r\n          if (node.name === \"linkoff\") {\r\n\r\n            const arr = [];\r\n            node.children.forEach(element => {\r\n              arr.push(convertNodeToElement(element))\r\n            })\r\n            return <span key={index}><LinkTag toHtml={toHtml} node={node} imgArr={imgArr} index={index} /></span>\r\n          }\r\n\r\n        },\r\n      })\r\n\r\n      return html\r\n    }, [mentionBodyRoot2, mentionHeadAvatar, mentionHeadLabel, mentionHeadLabel2, mentionBodyLabel])\r\n\r\n\r\n\r\n  const breakpointColumnsObj = {\r\n    [theme.breakpoints.values.xs]: 1,\r\n    [theme.breakpoints.values.sm]: 1,\r\n    [theme.breakpoints.values.md]: 2,\r\n    [theme.breakpoints.values.lg]: 3,\r\n    [theme.breakpoints.values.xl]: 4,\r\n    2000:4,\r\n    3000:5,\r\n    4000:6,\r\n    5000:7,\r\n    6000:8,\r\n    7000:9,\r\n    9999999:10,\r\n  };\r\n \r\n\r\n  const { ref, inView, entry } = useInView({\r\n    /* Optional options */\r\n    threshold: 0.8,\r\n    triggerOnce: false,\r\n    initialInView: true,\r\n    rootMargin: \"0px 0px 0px 0px\"\r\n  });\r\n\r\n  useEffect(function () {\r\n    // setTimeout(() => {\r\n    if ((inView) && (!isFull)) {\r\n      getSinglePost().then(postArr => {\r\n        //  alert(postCount)\r\n        if (postArr.length === 0) {\r\n          setIsFull(true)\r\n        }\r\n      })\r\n    }\r\n    //  }, 300);\r\n\r\n\r\n  }, [isFull, postArr, inView])\r\n\r\n  const [open, setOpen] = useState(false);\r\n\r\n  const [newName, setNewName] = useState(\"\")\r\n\r\n  const handleClickOpen = () => {\r\n    setOpen(true);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setOpen(false);\r\n  };\r\n\r\n  const inputRef = useRef()\r\n  //file.localUrl = URL.createObjectURL(e.currentTarget.files[0])\r\n\r\n  const [showOk, setShowOk] = useState(true)\r\n\r\n  return (\r\n    <>\r\n\r\n      <Container disableGutters={false} fixed={false} maxWidth={ window.innerWidth>=3000?false:\"lg\"} >\r\n\r\n\r\n        <Dialog open={open} onClose={handleClose} aria-labelledby=\"form-dialog-title\">\r\n          <DialogTitle id=\"form-dialog-title\">\r\n\r\n            <input type=\"file\" style={{ display: \"none\" }} ref={inputRef}\r\n              onClick={function (e) {\r\n                e.currentTarget.value = null;\r\n              }}\r\n\r\n              accept=\"image/*\"\r\n              onChange={function (e) {\r\n                if (e.currentTarget.files[0].name.trim().match(/\\.(gif|jpe?g|tiff|png|webp|bmp|svg)$/i)) {\r\n                  setAvatarPic(e.currentTarget.files[0])\r\n                }\r\n              }}\r\n            />\r\n            <Chip\r\n              style={{ backgroundColor: \"transparent\" }}\r\n              avatar={< Avatar style={{ transform: \"scale(2)\" }} alt={null}\r\n                src={avatarPic ? URL.createObjectURL(avatarPic) : `${url}/avatar/${token.userName}.svg`}                   //src={\"https://api.multiavatar.com/\" + token.userName + \".svg\"}   //src={friendObj[person]}\r\n              />}\r\n              label={\r\n                <Typography variant=\"h5\" >\r\n                  &nbsp;&nbsp;&nbsp;{token.userName}\r\n                </Typography>\r\n              }\r\n              onClick={function () {\r\n                setAvatarPic(null); inputRef.current.click()\r\n\r\n\r\n\r\n\r\n\r\n              }}\r\n\r\n            // deleteIcon={<DeleteOutline>change</DeleteOutline>}\r\n            // onDelete={function(){\r\n\r\n            // }}\r\n            />\r\n\r\n\r\n\r\n          </DialogTitle>\r\n          <DialogContent>\r\n            {/* <DialogContentText style={{ fontSize: \"1.5rem\" }}>\r\n              输入新名字/Input new name\r\n          </DialogContentText> */}\r\n            <TextField\r\n              InputLabelProps={{\r\n                classes: {\r\n                  root: textFieldCss,\r\n                  animated: textFieldCss,\r\n                  //     shrink: labelShrinkCss,\r\n                }\r\n\r\n              }}\r\n\r\n              InputProps={{\r\n                classes: {\r\n                  input: textFieldCss,\r\n\r\n                },\r\n              }}\r\n              value={newName}\r\n              onChange={function (e) {\r\n                setNewName(e.target.value)\r\n              }}\r\n              //   autoFocus\r\n\r\n              margin=\"dense\"\r\n              id=\"name\"\r\n              label=\"新名字/new name\"\r\n            //type=\"email\"\r\n            //  fullWidth\r\n            />\r\n          </DialogContent>\r\n          {showOk && <DialogActions>\r\n            <Button onClick={function () {\r\n\r\n              setNewName(\"\")\r\n              setOpen(false)\r\n              setAvatarPic(null)\r\n            }}\r\n              style={{\r\n                fontSize: \"1.5rem\",\r\n                color: theme.palette.type === \"dark\"\r\n\r\n                  ? theme.palette.text.secondary\r\n                  : theme.palette.primary.main\r\n\r\n              }}>\r\n              Cancel\r\n          </Button>\r\n            <Button onClick={function () {\r\n              //   localStorage.set\r\n              setShowOk(false)\r\n              const oldName = token.userName;\r\n\r\n\r\n              if (avatarPic) {\r\n\r\n                const data = new FormData();\r\n                data.append('file', avatarPic);\r\n                data.append('obj',\r\n                  JSON.stringify({\r\n                    filename: avatarPic.name.trim(),\r\n                    ownerName: oldName,\r\n                    uploadTime: Date.now(),\r\n                    //   picName:[0]\r\n\r\n                  })\r\n                );\r\n                return axios.post(`${url}/avatar`, data, {\r\n                  headers: { 'content-type': 'multipart/form-data' },\r\n                }).then(response => {\r\n                  // alert(response.data);\r\n\r\n                  if (newName) {\r\n\r\n                    changeOwnerName(newName).then(result => {\r\n                      if (!result) {\r\n                        alert(\"name is taken\")\r\n                      }\r\n                      else {\r\n                        setPostArr(pre => {\r\n                          return [...pre.map(function (item) {\r\n                            if (item.ownerName === oldName) { item.ownerName = newName; return item }\r\n                            else { return item }\r\n                          })]\r\n                        })\r\n                        setNewName(\"\")\r\n                        setOpen(false)\r\n                        //    setAvatarPic(null)\r\n                      }\r\n                    })\r\n                  }\r\n                  else {\r\n                    setOpen(false)\r\n                    //     setAvatarPic(null)\r\n                  }\r\n                })\r\n              }\r\n              else {\r\n                if (newName) {\r\n\r\n                  changeOwnerName(newName).then(result => {\r\n                    if (!result) {\r\n                      alert(\"name is taken\")\r\n                    }\r\n                    else {\r\n                      setPostArr(pre => {\r\n                        return [...pre.map(function (item) {\r\n                          if (item.ownerName === oldName) { item.ownerName = newName; return item }\r\n                          else { return item }\r\n                        })]\r\n                      })\r\n                      setNewName(\"\")\r\n                      setOpen(false)\r\n                    }\r\n                  })\r\n                }\r\n\r\n\r\n\r\n              }\r\n\r\n\r\n\r\n\r\n\r\n            }}\r\n              style={{\r\n                fontSize: \"1.5rem\",\r\n                color: theme.palette.type === \"dark\"\r\n\r\n                  ? theme.palette.text.secondary\r\n                  : theme.palette.primary.main\r\n\r\n              }}>\r\n              OK\r\n          </Button>\r\n          </DialogActions>}\r\n        </Dialog>\r\n\r\n\r\n        <Masonry\r\n          breakpointCols={breakpointColumnsObj}\r\n          className=\"my-masonry-grid\"\r\n          columnClassName=\"my-masonry-grid_column\"\r\n        >\r\n\r\n          {postArr.map(function (item, index) {\r\n\r\n\r\n            return (\r\n\r\n\r\n\r\n              <PaperContent\r\n\r\n                key={item.postID}\r\n                postArr={postArr} postPicArr={postPicArr} index={index} editorPaperCss={editorPaperCss} toHtml={toHtml} token={token}\r\n\r\n\r\n                mentionBodyRoot2={mentionBodyRoot2} mentionBodyLabel={mentionBodyLabel} deleteSinglePost={deleteSinglePost}\r\n                breakpointsAttribute={breakpointsAttribute}\r\n                setOpen={setOpen}\r\n\r\n                mentionHeadAvatar={mentionHeadAvatar}\r\n                avatarPic={avatarPic}\r\n                setShowOk={setShowOk}\r\n                fullVisible={fullVisible}\r\n\r\n              />\r\n\r\n            )\r\n\r\n          })}\r\n\r\n\r\n        </Masonry>\r\n\r\n        <Paper\r\n          ref={ref}\r\n          style={{\r\n            padding: theme.spacing(1), margin: \"auto\", backgroundColor: theme.palette.background.default, width: \"100%\",\r\n            opacity: Boolean(!isFull) && inView ? 1 : 0,\r\n            display: \"flex\", justifyContent: \"center\", alignItems: \"center\"\r\n          }}>\r\n          <CircularProgress size=\"1.5rem\" />\r\n        </Paper>\r\n\r\n      </Container>\r\n\r\n\r\n    </>\r\n  )\r\n\r\n}\r\n\r\nfunction PaperContent({ postArr, postPicArr, index, editorPaperCss, toHtml, token, mentionBodyRoot2, mentionHeadAvatar, mentionBodyLabel, breakpointsAttribute,\r\n  deleteSinglePost, setOpen, avatarPic, setShowOk,\r\n  fullVisible,\r\n\r\n}) {\r\n  const theme = useTheme()\r\n  const { ref, inView, entry } = useInView({\r\n    /* Optional options */\r\n    threshold: 0,\r\n    triggerOnce: true,\r\n    initialInView: false,\r\n  });\r\n\r\n  const [height, setHeight] = useState(\"auto\")\r\n  const [display, setDisplay] = useState(\"none\")\r\n  const panelRef = useRef()\r\n  // const [toShow, setToShow] = useState(true)\r\n\r\n  const [showComment, setShowComment] = useState(false)\r\n\r\n  const [commentCount, setCommentCount] = useState(postArr[index].commentCount)\r\n\r\n  const [shrinkBar, setShrinkBar] = useState(false)\r\n\r\n  //const [show,setShow] = useState(true)\r\n\r\n\r\n  const [fullScreen, setFullScreen] = useState(false)\r\n\r\n  useEffect(function () {\r\n    // console.log(panelRef.current)\r\n    //   console.log(window.getComputedStyle(panelRef.current)[\"height\"])\r\n\r\n    if (Number(window.getComputedStyle(panelRef.current)[\"height\"].replace(\"px\", \"\")) > 360) {\r\n      setShrinkBar(true)\r\n      setHeight(\"360px\")\r\n      setDisplay(\"block\")\r\n    }\r\n\r\n  }, [])\r\n\r\n\r\n\r\n\r\n\r\n  return (\r\n\r\n\r\n\r\n    // <Grow key={index + \"_\"} in={show} timeout={300} >\r\n\r\n\r\n    <Paper classes={{ root: editorPaperCss }} elevation={3} ref={ref} key={index}\r\n      style={{\r\n\r\n        padding: \"0px\", whiteSpace: \"normal\",\r\n\r\n      }} >\r\n\r\n\r\n\r\n\r\n\r\n      {!isMobile && <Dialog\r\n        open={fullScreen}\r\n        onClose={function () { setFullScreen(false); }}\r\n        scroll={\"paper\"}\r\n        aria-labelledby=\"scroll-dialog-title\"\r\n        aria-describedby=\"scroll-dialog-description\"\r\n        style={{ display: fullVisible ? \"block\" : \"none\" }}\r\n      >\r\n        <DialogTitle id=\"scroll-dialog-title\"\r\n\r\n          style={{ padding: \"8px 16px\" }}\r\n\r\n        >\r\n          <Chip\r\n\r\n\r\n            //style={{ backgroundColor: \"transparent\" }}\r\n\r\n            onClick={function () {\r\n              token.userName === postArr[index].ownerName && setOpen(pre => !pre)\r\n\r\n              token.userName === postArr[index].ownerName && setShowOk(true)\r\n            }}\r\n\r\n            // classes={{ root: mentionBodyRoot2, label: mentionBodyLabel }}\r\n            key={index}\r\n\r\n\r\n\r\n            avatar={\r\n              < Avatar alt={null}\r\n                //    style={{ width: \"1.8rem\", height: \"1.8rem\", }}\r\n                src={avatarPic && token.userName === postArr[index].ownerName ? URL.createObjectURL(avatarPic) : `${url}/avatar/${postArr[index].ownerName}.svg`}\r\n\r\n              />\r\n            }\r\n            label={\r\n              <Typography\r\n                style={{ marginTop: \"3px\", lineHeight: \"1.0\", fontWeight: \"bold\", ...token.userName === postArr[index].ownerName && { color: theme.palette.primary.main, } }}>\r\n                {postArr[index].ownerName}<br />\r\n                <span style={{ color: theme.palette.text.secondary, verticalAlign: \"middle\", fontSize: \"0.7rem\", fontWeight: \"normal\" }}>{formatDistanceToNow(postArr[index].postingTime)}</span>\r\n              </Typography>\r\n            }\r\n\r\n          />\r\n\r\n\r\n\r\n          <IconButton size=\"small\" style={{ justifySelf: \"right\" }}\r\n            onClick={function () {\r\n\r\n              setShowComment(pre => !pre)\r\n              axios.get(`${url}/comment/count/${postArr[index].postID}`).then(response => {\r\n                setCommentCount(response.data)\r\n              })\r\n            }}\r\n          >\r\n\r\n            <TextsmsOutlined style={{ fontSize: \"1.5rem\" }} />\r\n            &nbsp;<span style={{ fontWeight: \"bold\", fontSize: \"1rem\", color: theme.palette.text.secondary, verticalAlign: \"middle\", }}>{commentCount}</span>\r\n          </IconButton>\r\n\r\n          <IconButton size=\"small\" style={{ float: \"right\" }}\r\n            onClick={function () {\r\n              setFullScreen(false)\r\n            }}\r\n          >\r\n\r\n            <CloseOutlined fontSize=\"medium\" />\r\n          </IconButton>\r\n\r\n\r\n\r\n        </DialogTitle>\r\n\r\n\r\n        <DialogContent dividers={true} style={{ padding: 0 }}>\r\n          <DialogContentText\r\n            style={{ padding: \"16px\" }}\r\n            id=\"scroll-dialog-description\"\r\n            //     ref={descriptionElementRef}\r\n            tabIndex={-1}\r\n          >\r\n            {toHtml(postArr[index].content, postPicArr[index], inView)}\r\n\r\n          </DialogContentText>\r\n\r\n          <CommentContent\r\n            key={postArr[index].postID}\r\n            postID={postArr[index].postID} index={index}\r\n            toHtml={toHtml} setCommentCount={setCommentCount}\r\n            commentCount={commentCount}\r\n            avatarPic={avatarPic}\r\n            showComment={showComment}\r\n            setShowComment={setShowComment}\r\n            fullScreen={fullScreen}\r\n          />\r\n\r\n\r\n\r\n        </DialogContent>\r\n\r\n      </Dialog>}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n      <div ref={panelRef} style={{ position: \"relative\", overflow: display === \"none\" ? \"visible\" : \"hidden\", height: height, }} >\r\n\r\n\r\n        <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\", paddingTop: \"2px\", paddingBottom: \"0px\" }}>\r\n\r\n\r\n          <div>\r\n\r\n            <Chip\r\n\r\n\r\n              //style={{ backgroundColor: \"transparent\" }}\r\n\r\n              onClick={function () {\r\n                token.userName === postArr[index].ownerName && setOpen(pre => !pre)\r\n\r\n                token.userName === postArr[index].ownerName && setShowOk(true)\r\n              }}\r\n\r\n              // classes={{ root: mentionBodyRoot2, label: mentionBodyLabel }}\r\n              key={index}\r\n\r\n\r\n\r\n              avatar={\r\n                < Avatar alt={null}\r\n                  //       style={{ width: \"1.8rem\", height: \"1.8rem\", }}\r\n                  src={avatarPic && token.userName === postArr[index].ownerName ? URL.createObjectURL(avatarPic) : `${url}/avatar/${postArr[index].ownerName}.svg`}\r\n\r\n                />\r\n              }\r\n              label={\r\n                <Typography\r\n\r\n\r\n                  style={{ marginTop: \"3px\", lineHeight: \"1.0\", fontWeight: \"bold\", ...token.userName === postArr[index].ownerName && { color: theme.palette.primary.main, } }}>\r\n                  {postArr[index].ownerName}<br />\r\n                  <span style={{ color: theme.palette.text.secondary, verticalAlign: \"middle\", fontSize: \"0.7rem\", fontWeight: \"normal\" }}>{formatDistanceToNow(postArr[index].postingTime)}</span>\r\n\r\n                </Typography>\r\n              }\r\n\r\n            />\r\n\r\n\r\n            {!isMobile && <IconButton size=\"small\" style={{ justifySelf: \"right\" }}\r\n              onClick={function () {\r\n                setFullScreen(true)\r\n              }}\r\n            >\r\n\r\n              <FullscreenOutlined fontSize=\"medium\" />\r\n            </IconButton>\r\n            }\r\n\r\n            <IconButton size=\"small\" style={{ justifySelf: \"right\" }}\r\n              onClick={function () {\r\n\r\n                setShowComment(pre => !pre)\r\n                axios.get(`${url}/comment/count/${postArr[index].postID}`).then(response => {\r\n                  setCommentCount(response.data)\r\n                })\r\n              }}\r\n            >\r\n\r\n              <TextsmsOutlined style={{ fontSize: \"1.5rem\" }} />\r\n              &nbsp;<span style={{ fontWeight: \"bold\", fontSize: \"1rem\", color: theme.palette.text.secondary, verticalAlign: \"middle\", }}>{commentCount}</span>\r\n            </IconButton>\r\n\r\n\r\n\r\n\r\n          </div>\r\n\r\n          {token.userName == postArr[index].ownerName && <IconButton size=\"small\"\r\n            onClick={function () {\r\n              deleteSinglePost(postArr[index].postID).then(message => { })\r\n            }}\r\n          >\r\n            <DeleteOutline style={{ fontSize: \"1.5rem\" }} />\r\n          </IconButton>}\r\n\r\n\r\n        </div>\r\n\r\n\r\n\r\n\r\n        {toHtml(postArr[index].content, postPicArr[index], inView)}\r\n\r\n\r\n        {shrinkBar && <Button\r\n\r\n          style={{\r\n            //      marginTop: \"0px\",\r\n            borderTopLeftRadius: 0,\r\n            borderTopRightRadius: 0,\r\n\r\n            borderBottomLeftRadius: showComment ? 0 : \"4px\",\r\n            borderBottomRightRadius: showComment ? 0 : \"4px\",\r\n\r\n            padding: 0,\r\n            position: display === \"none\" ? \"relative\" : \"absolute\",\r\n            bottom: 0,\r\n            opacity: 0.8,\r\n\r\n            backgroundColor: theme.palette.background.default,\r\n            boxShadow: display === \"none\" ? theme.shadows[0] : theme.shadows[5],\r\n\r\n            color: theme.palette.type === \"dark\"\r\n              ? theme.palette.text.secondary\r\n              : theme.palette.primary.main,\r\n            ...display === \"none\" && { display: \"flex\" },\r\n            //verticalAlign:\"top\",\r\n\r\n          }}\r\n          onClick={function () {\r\n            setHeight(pre => { return pre === \"auto\" ? \"360px\" : \"auto\" })\r\n            setDisplay(pre => { return pre === \"none\" ? \"auto\" : \"none\" })\r\n\r\n          }}\r\n\r\n          size=\"small\"\r\n\r\n          //  color=\"primary\"\r\n          fullWidth={true}\r\n        >\r\n\r\n\r\n          {display === \"none\" ? <ExpandLess /> : <ExpandMore />}\r\n\r\n        </Button>}\r\n      </div>\r\n      {/* <Collapse in={showComment}><CommentContent\r\n        key={postArr[index].postID}\r\n        postID={postArr[index].postID} index={index}\r\n        toHtml={toHtml} setCommentCount={setCommentCount}\r\n        commentCount={commentCount}\r\n        avatarPic={avatarPic}\r\n        showComment={showComment}\r\n        fullScreen={fullScreen}\r\n      /></Collapse> */}\r\n\r\n\r\n      {/* {showComment && <CommentContent\r\n        key={postArr[index].postID}\r\n        postID={postArr[index].postID} index={index}\r\n        toHtml={toHtml} setCommentCount={setCommentCount}\r\n        commentCount={commentCount}\r\n        avatarPic={avatarPic}\r\n        showComment={showComment}\r\n        fullScreen={fullScreen}\r\n      />} */}\r\n\r\n\r\n      <CommentContent\r\n        key={postArr[index].postID}\r\n        postID={postArr[index].postID} index={index}\r\n        toHtml={toHtml} setCommentCount={setCommentCount}\r\n        commentCount={commentCount}\r\n        avatarPic={avatarPic}\r\n        showComment={showComment}\r\n        fullScreen={fullScreen}\r\n      />\r\n\r\n    </Paper >\r\n\r\n\r\n\r\n\r\n    // </Grow>\r\n\r\n\r\n  )\r\n}\r\n\r\n\r\n\r\nfunction ImgTag({ picArr, picName, setFullVisible, ...props }) {\r\n\r\n  //  const { editorContent, setEditorContent, lgSizeObj, smSizeObj, deviceSize, picArr, setPicArr } = useContext(Context1);\r\n  const theme = useTheme()\r\n  const picNum = picName === \"local\" ? picArr.length : Number(picName.split(\"_\")[1])\r\n  const imgArr = picArr || []\r\n\r\n\r\n\r\n  const [photoIndex, setPhotoIndex] = useState(0)\r\n  const [isOpen, setIsOpen] = useState(false)\r\n\r\n  // useEffect(function(){\r\n  //   setFullVisible(!isOpen)\r\n  // },[isOpen])\r\n\r\n\r\n  const commonStyle0 = {\r\n    position: \"relative\",\r\n    width: \"100%\",\r\n    height: 0,\r\n    paddingBottom: \"56.25%\",\r\n    backgroundPositionX: \"center\",\r\n    backgroundPositionY: \"center\",\r\n    backgroundColor: theme.palette.divider,   //\"skyblue\",\r\n    overflow: \"hidden\",\r\n    opacity: 1,\r\n\r\n\r\n\r\n\r\n  }\r\n\r\n\r\n  const commonStyle = {\r\n    position: \"absolute\",\r\n    backgroundColor: \"wheat\",\r\n    backgroundRepeat: \"no-repeat\",\r\n    overflow: \"hidden\",\r\n    backgroundPositionX: \"center\",\r\n    backgroundPositionY: \"center\",\r\n    backgroundSize: \"cover\",\r\n    opacity: 1,\r\n\r\n  }\r\n\r\n\r\n  const images =\r\n\r\n\r\n    picName === \"local\"\r\n      ? imgArr.map((item) => { return item.localUrl })       //[imgArr[0].localUrl]\r\n      : [...Array(picNum)].map((item, index) => { return `${url}/picture/downloadpicture/${picName}_${index}` })  //[`${url}/picture/downloadpicture/${picName}_0`]\r\n\r\n\r\n  const lightBox = <Lightbox\r\n    mainSrc={images[photoIndex]}\r\n    nextSrc={images[(photoIndex + 1) % images.length]}\r\n    prevSrc={images[(photoIndex + images.length - 1) % images.length]}\r\n    onCloseRequest={() => { setIsOpen(false); setFullVisible(true) }}\r\n    onMovePrevRequest={() =>\r\n      setPhotoIndex(\r\n        pre => (pre + images.length - 1) % images.length,\r\n      )\r\n    }\r\n    onMoveNextRequest={() =>\r\n      setPhotoIndex(\r\n        pre => (pre + images.length + 1) % images.length,\r\n      )\r\n    }\r\n  />\r\n\r\n\r\n  if (picNum === 1) {\r\n\r\n    return (\r\n\r\n      <div style={{\r\n\r\n        ...commonStyle0,\r\n        backgroundRepeat: \"no-repeat\",\r\n        backgroundSize: \"cover\",\r\n        backgroundImage: picName === \"local\" ? \"url(\" + imgArr[0].localUrl + \")\" : `url(${url}/picture/downloadpicture/${picName}_0)`,\r\n\r\n      }} onClick={function () {\r\n        setFullVisible(false)\r\n        setIsOpen(true)\r\n      }} >\r\n        {isOpen && lightBox}\r\n      </div>\r\n    )\r\n  }\r\n  else if (picNum === 2) {\r\n\r\n    return (\r\n\r\n      <div style={{ ...commonStyle0 }}>\r\n\r\n        <div style={{\r\n          ...commonStyle,\r\n          width: \"50%\",\r\n          height: \"100%\",\r\n          top: \"0%\",\r\n          left: \"0%\",\r\n          backgroundImage: picName === \"local\" ? \"url(\" + imgArr[0].localUrl + \")\" : `url(${url}/picture/downloadpicture/${picName}_0)`,\r\n          transform: \"translateX(-1px) translateY(0px)\",\r\n          backgroundColor: \"wheat\",\r\n        }}\r\n          onClick={function () { setPhotoIndex(0); setIsOpen(true); setFullVisible(false); }} />\r\n        <div style={{\r\n          ...commonStyle,\r\n          width: \"50%\",\r\n          height: \"100%\",\r\n          top: \"0%\",\r\n          left: \"50%\",\r\n          backgroundImage: picName === \"local\" ? \"url(\" + imgArr[1].localUrl + \")\" : `url(${url}/picture/downloadpicture/${picName}_1)`,\r\n          transform: \"translateX(1px) translateY(0px)\",\r\n        }}\r\n          onClick={function () { setPhotoIndex(1); setIsOpen(true); setFullVisible(false); }} />\r\n\r\n        {isOpen && lightBox}\r\n\r\n      </div>\r\n\r\n    )\r\n  }\r\n  else if (picNum === 3) {\r\n\r\n\r\n    return (\r\n\r\n      <div style={{ ...commonStyle0 }}>\r\n\r\n\r\n        <div style={{\r\n          ...commonStyle,\r\n\r\n          width: \"50%\",\r\n          height: \"100%\",\r\n          left: \"0%\",\r\n          top: \"0%\",\r\n          backgroundImage: picName === \"local\" ? \"url(\" + imgArr[0].localUrl + \")\" : `url(${url}/picture/downloadpicture/${picName}_0)`,\r\n          transform: \"translateX(-1px) translateY(0px)\",\r\n\r\n        }}\r\n          onClick={function () { setPhotoIndex(0); setIsOpen(true); setFullVisible(false); }} />\r\n\r\n        <div style={{\r\n          ...commonStyle,\r\n          width: \"50%\",\r\n          height: \"50%\",\r\n          left: \"50%\",\r\n          top: \"0%\",\r\n          backgroundImage: picName === \"local\" ? \"url(\" + imgArr[1].localUrl + \")\" : `url(${url}/picture/downloadpicture/${picName}_1)`,\r\n          transform: \"translateX(1px) translateY(-1px)\",\r\n\r\n\r\n        }}\r\n          onClick={function () { setPhotoIndex(1); setIsOpen(true); setFullVisible(false); }} />\r\n        <div style={{\r\n          ...commonStyle,\r\n\r\n\r\n          width: \"50%\",\r\n          height: \"50%\",\r\n          left: \"50%\",\r\n          top: \"50%\",\r\n          backgroundImage: picName === \"local\" ? \"url(\" + imgArr[2].localUrl + \")\" : `url(${url}/picture/downloadpicture/${picName}_2)`,\r\n          transform: \"translateX(1px) translateY(1px)\",\r\n\r\n        }} onClick={\r\n          function () { setPhotoIndex(2); setIsOpen(true); setFullVisible(false); }} />\r\n        {isOpen && lightBox}\r\n\r\n      </div>\r\n\r\n    )\r\n  }\r\n\r\n  else {\r\n\r\n    return (\r\n\r\n\r\n      <div style={{ ...commonStyle0 }}>\r\n\r\n        <div style={{\r\n          ...commonStyle,\r\n\r\n          width: \"50%\",\r\n          height: \"50%\",\r\n          top: \"0%\",\r\n          left: \"0%\",\r\n          backgroundImage: picName === \"local\" ? \"url(\" + imgArr[0].localUrl + \")\" : `url(${url}/picture/downloadpicture/${picName}_0)`,\r\n          transform: \"translateX(-1px) translateY(-1px)\",\r\n\r\n        }} onClick={function () {\r\n          //  setPicArr(pre => [pre[1], pre[2], pre[3]])\r\n          setPhotoIndex(0)\r\n          setIsOpen(true)\r\n          setFullVisible(false)\r\n        }} />\r\n\r\n        <div style={{\r\n          ...commonStyle,\r\n\r\n          width: \"50%\",\r\n          height: \"50%\",\r\n          top: \"0%\",\r\n          left: \"50%\",\r\n          backgroundImage: picName === \"local\" ? \"url(\" + imgArr[1].localUrl + \")\" : `url(${url}/picture/downloadpicture/${picName}_1)`,\r\n          transform: \"translateX(1px) translateY(-1px)\",\r\n\r\n        }} onClick={function () {\r\n          //   setPicArr(pre => [pre[0], pre[2], pre[3]])\r\n          setPhotoIndex(1)\r\n          setIsOpen(true)\r\n          setFullVisible(false)\r\n        }} />\r\n\r\n        <div style={{\r\n          ...commonStyle,\r\n          width: \"50%\",\r\n          height: \"50%\",\r\n          top: \"50%\",\r\n          left: \"0%\",\r\n          //    backgroundImage: \"url(\" + imgArr[2].localUrl + \")\",\r\n          backgroundImage: picName === \"local\" ? \"url(\" + imgArr[2].localUrl + \")\" : `url(${url}/picture/downloadpicture/${picName}_2)`,\r\n          transform: \"translateX(-1px) translateY(1px)\",\r\n        }}\r\n          onClick={function () {\r\n            //  setPicArr(pre => [pre[0], pre[1], pre[3]])\r\n            setPhotoIndex(2)\r\n            setIsOpen(true)\r\n            setFullVisible(false)\r\n          }}\r\n        />\r\n\r\n        <div style={{\r\n          ...commonStyle,\r\n          width: \"50%\",\r\n          height: \"50%\",\r\n          top: \"50%\",\r\n          left: \"50%\",\r\n          backgroundImage: picName === \"local\" ? \"url(\" + imgArr[3].localUrl + \")\" : `url(${url}/picture/downloadpicture/${picName}_3)`,\r\n          transform: \"translateX(1px) translateY(1px)\",\r\n        }} onClick={\r\n          function () {\r\n            //   setPicArr(pre => [pre[1], pre[2], pre[3]])\r\n            setPhotoIndex(3)\r\n            setIsOpen(true)\r\n            setFullVisible(false)\r\n          }} />\r\n        {isOpen && lightBox}\r\n\r\n      </div>\r\n    )\r\n  }\r\n\r\n}\r\n\r\nfunction LinkTag({ toHtml, node, index, imgArr, ...props }) {\r\n\r\n  const theme = useTheme()\r\n  const host = node.attribs.linkhost;\r\n  const address = node.attribs.linkaddress;\r\n\r\n\r\n\r\n  const [content, setContent] = useState(host.substr(1))\r\n\r\n  const arr = [];\r\n  node.children.forEach((element, index) => {\r\n    arr.push(convertNodeToElement(element))\r\n  })\r\n\r\n  return (\r\n    <span\r\n      target=\"_blank\"\r\n      //  key={index}\r\n      style={{\r\n        color: theme.palette.primary.main,\r\n        cursor: \"pointer\"\r\n      }}\r\n      onClick={function (e) {\r\n        e.stopPropagation()\r\n        setContent(\r\n          <Link href={address} target=\"_blank\" rel=\"noopener\">\r\n            {arr.map((element, index) => {\r\n              //    if (reactElementToJSXString(element) === \"<br>\") { return <></> }\r\n              return element\r\n            })}\r\n          </Link>\r\n        )\r\n\r\n      }}\r\n    >\r\n      <span key={index}>{content}</span>\r\n    </span>\r\n\r\n\r\n\r\n\r\n  )\r\n}\r\n\r\nfunction BackColorTag({ backimage, textcolor, transformFn, node, index, arr, arr2, inView, ...props }) {\r\n\r\n  const [isOverFlow, setIsOverFlow] = useState(false)\r\n\r\n  const backImageUrl = backimage.indexOf(\"downloadbackpicture\") >= 0\r\n    ? `url(${url}/picture/downloadbackpicture/${backimage.substring(backimage.lastIndexOf(\"/\") + 1, backimage.length - 1)})`\r\n    : backimage\r\n  //alert(backImageUrl)\r\n\r\n  //console.log(backImage)\r\n  return (\r\n    <DetectableOverflow\r\n\r\n      onChange={function (overFlow) {\r\n        setIsOverFlow(overFlow)\r\n      }}\r\n\r\n      key={index}\r\n      style={{\r\n        // backgroundImage: \"url(https://mernchen.herokuapp.com/api/picture/download/60a204e70270cc001728285f)\",\r\n        // backgroundImage: \"url(https://mernchen.herokuapp.com/api/picture/download/60a2062e95f2250017420aa4)\",\r\n        // backgroundImage: \"url(https://mernchen.herokuapp.com/api/picture/download/60b701a9dc07780017dcfd38)\",\r\n        ...inView && { backgroundImage: backImageUrl },\r\n        color: textcolor,\r\n        //  backgroundImage: \"url(https://mernchen.herokuapp.com/api/picture/download/60b6f77fae1acf0017a96c4b)\",\r\n\r\n\r\n        //  backgroundImage: \"url(https://picsum.photos/800/450)\",\r\n        backgroundSize: \"cover\",\r\n        position: \"relative\",\r\n\r\n        backgroundColor: \"wheat\",\r\n        //  width: \"100%\",\r\n        height: 0,\r\n\r\n        paddingBottom: \"56.25%\",\r\n        display: \"flex\",\r\n        alignItems: isOverFlow ? \"flex-start\" : \"center\",\r\n        justifyContent: \"center\",\r\n        overflow: \"auto\",\r\n\r\n      }}\r\n    >\r\n\r\n      <div style={{\r\n        textAlign: \"center\",\r\n        position: isOverFlow ? \"block\" : \"absolute\",\r\n        ...!isOverFlow && { top: \"50%\" },\r\n        ...!isOverFlow && { transform: \"translateY(-50%)\" },\r\n        // color: \"white\",\r\n\r\n        padding: \"8px\",\r\n        whiteSpace: \"pre-wrap\"\r\n      }}>\r\n\r\n        {arr.map((item, index) => {\r\n\r\n          if (item.name === \"span\") {\r\n            item.children = item.children.filter(item => {\r\n              return item.name !== \"br\"\r\n            })\r\n            return convertNodeToElement(item)\r\n          }\r\n\r\n\r\n          if (item.type !== \"tag\") { return <span key={index}>{item}</span> }\r\n          else if (item.name === \"span\") {\r\n            return arr2[index]\r\n          }\r\n          else {\r\n            return <span key={index} >{transformFn(item, index)}</span>\r\n          }\r\n\r\n\r\n        })}\r\n\r\n      </div>\r\n    </DetectableOverflow>\r\n  )\r\n\r\n\r\n}","import logo from './logo.svg';\r\nimport './App.css';\r\n\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport DraftEditor from \"./DraftEditor\";\r\nimport { Typography, Button, ButtonGroup, Container, Paper, Box, Avatar, Grid } from \"@material-ui/core\";\r\nimport Content from \"./Content\";\r\n\r\nimport url, { axios } from \"./config\";\r\nimport DetectableOverflow from 'react-detectable-overflow';\r\nimport { useEffect, useState, useContext, useRef } from 'react';\r\n\r\n\r\nimport { Context } from \"./ContextProvider\"\r\n\r\nimport ReactHtmlParser, { processNodes, convertNodeToElement, htmlparser2, } from 'react-html-parser';\r\n\r\n//import multiavatar from '@multiavatar/multiavatar'\r\n//import yellow from '@material-ui/core/colors/yellow';\r\n\r\n\r\nfunction App() {\r\n\r\n  //return  <div dangerouslySetInnerHTML={{__html: svgCode}} />\r\n  //eturn ReactHtmlParser(svgCode)\r\n  // return (\r\n  //   <img src={`http://localhost/aaa.svg`} />\r\n  // )\r\n  //alert(`url(https://picsum.photos/${window.screen.width}/${window.screen.height})`)\r\n  return (\r\n\r\n    <>\r\n\r\n      <div style={{\r\n        backgroundImage: `url(https://picsum.photos/${window.screen.width}/${window.screen.height})`,\r\n\r\n        objectFit: \"cover\",\r\n        //\r\n        position: \"fixed\",\r\n        top: 0,\r\n        left: 0,\r\n        width: \"100%\",\r\n        height: \"100%\",\r\n        zIndex: -100,   \r\n        opacity: 0.85, \r\n        overflow: \"hidden\"\r\n      }} />\r\n      <CssBaseline />  {/* defualt theme fontsize in body2 will not work without <Cssbaseline /> */}\r\n\r\n      <Grid container\r\n        direction=\"row\"\r\n        justifyContent=\"space-around\"\r\n        alignItems=\"flex-start\"\r\n        spacing={0}\r\n\r\n      >\r\n        <Grid item xs={12} sm={12} md={10} lg={6} xl={6} >\r\n\r\n          <DraftEditor />\r\n        </Grid>\r\n\r\n      </Grid>\r\n\r\n\r\n\r\n\r\n\r\n      <Content />\r\n\r\n\r\n      {/* <div style={{ margin: \"auto\", backgroundColor: \"pink\", width: \"200px\", height: \"30px\" }} ref={ref}>{inView + \"\"}</div> */}\r\n\r\n    </>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\n\nimport ContextProvider from \"./ContextProvider\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <ContextProvider>\n      <App />\n    </ContextProvider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n\nreportWebVitals();\n"],"sourceRoot":""}